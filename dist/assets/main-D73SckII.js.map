{"version":3,"file":"main-D73SckII.js","sources":["../../src/scripts/error-handler.js","../../src/scripts/connection-monitor.js","../../src/scripts/config.js","../../src/scripts/data/api.js","../../src/scripts/utils/index.js","../../src/scripts/components/header.js","../../src/scripts/components/sidebar.js","../../src/scripts/components/footer.js","../../src/scripts/components/loader.js","../../node_modules/idb/build/index.js","../../src/scripts/idb.js","../../src/scripts/components/card.js","../../src/scripts/pages/home/home-presenter.js","../../src/scripts/pages/home/home-page.js","../../src/scripts/pages/about/about-page.js","../../src/scripts/pages/auth/login/login-page.js","../../src/scripts/pages/auth/register/register-page.js","../../src/scripts/pages/story-detail/story-detail-presenter.js","../../src/scripts/pages/story-detail/story-detail-page.js","../../src/scripts/pages/add/add-presenter.js","../../src/scripts/pages/add/add-page.js","../../src/scripts/pages/not-found-page.js","../../src/scripts/routes/url-parser.js","../../src/scripts/utils/auth.js","../../src/scripts/pages/saved/saved-page.js","../../src/scripts/routes/routes.js","../../src/scripts/pages/app.js","../../src/scripts/index.js"],"sourcesContent":["(function () {\n  // Global error handler\n  window.onerror = function (message, source, lineno, colno, error) {\n    console.error('Global error caught:', {\n      message,\n      source,\n      lineno,\n      colno,\n      error,\n    });\n\n    // Handle common undefined errors gracefully\n    if (message && message.includes('Cannot read properties of undefined')) {\n      if (!window.hasShownErrorMessage) {\n        window.hasShownErrorMessage = true;\n        setTimeout(() => {\n          window.hasShownErrorMessage = false;\n        }, 5000);\n\n        if (!window.location.hash.includes('error')) {\n          window.showToast?.(\n            'Terjadi kesalahan saat menampilkan konten. Kami akan mencoba memperbaikinya secara otomatis.',\n            'warning'\n          );\n        }\n      }\n      return true;\n    }\n\n    // Show generic error toast for other errors (improvisasi)\n    if (message && !window.location.hash.includes('error')) {\n      window.showToast?.(\n        'Terjadi kesalahan tak terduga. Silakan coba lagi atau muat ulang halaman.',\n        'error'\n      );\n    }\n    return false;\n  };\n\n  // Toast notification utility\n  window.showToast = function (message, type = 'info', duration = 5000) {\n    const toastContainer =\n      document.getElementById('toast-container') ||\n      (() => {\n        // Auto-create toast container if not present (improvisasi)\n        const container = document.createElement('div');\n        container.id = 'toast-container';\n        container.className = 'toast-container';\n        container.setAttribute('aria-live', 'polite');\n        document.body.appendChild(container);\n        return container;\n      })();\n\n    const toast = document.createElement('div');\n    toast.className = `toast toast-${type}`;\n    toast.setAttribute('role', 'alert');\n    toast.setAttribute('tabindex', '0');\n\n    const icon = document.createElement('i');\n    icon.className = `fas ${\n      type === 'success'\n        ? 'fa-check-circle'\n        : type === 'error'\n          ? 'fa-exclamation-circle'\n          : type === 'warning'\n            ? 'fa-exclamation-triangle'\n            : 'fa-info-circle'\n    }`;\n    icon.setAttribute('aria-hidden', 'true');\n\n    const textSpan = document.createElement('span');\n    textSpan.textContent = message;\n\n    // Add close button for accessibility (improvisasi)\n    const closeBtn = document.createElement('button');\n    closeBtn.className = 'toast-close-btn';\n    closeBtn.setAttribute('aria-label', 'Tutup notifikasi');\n    closeBtn.innerHTML = '<i class=\"fas fa-times\"></i>';\n    closeBtn.onclick = () => {\n      toast.classList.remove('show');\n      setTimeout(() => {\n        if (toastContainer.contains(toast)) {\n          toastContainer.removeChild(toast);\n        }\n      }, 300);\n    };\n\n    toast.appendChild(icon);\n    toast.appendChild(textSpan);\n    toast.appendChild(closeBtn);\n    toastContainer.appendChild(toast);\n\n    // Animate in\n    requestAnimationFrame(() => {\n      setTimeout(() => {\n        toast.classList.add('show');\n        toast.focus();\n      }, 10);\n    });\n\n    // Auto-dismiss after duration\n    setTimeout(() => {\n      toast.classList.remove('show');\n      setTimeout(() => {\n        if (toastContainer.contains(toast)) {\n          toastContainer.removeChild(toast);\n        }\n      }, 300);\n    }, duration);\n  };\n})();\n","(function () {\n  const connectionStatus = document.getElementById('connection-status');\n  const connectionMessage = document.getElementById('connection-message');\n\n  if (!connectionStatus || !connectionMessage) return;\n\n  let hideTimeout = null;\n\n  function showStatus(type, message, duration = 3000) {\n    connectionStatus.classList.remove('hidden', 'online', 'offline');\n    connectionStatus.classList.add(type);\n    connectionMessage.textContent = message;\n\n    // Accessibility: announce status change\n    connectionStatus.setAttribute(\n      'aria-live',\n      type === 'online' ? 'polite' : 'assertive'\n    );\n    connectionStatus.setAttribute('role', 'status');\n\n    if (type === 'online') {\n      clearTimeout(hideTimeout);\n      hideTimeout = setTimeout(() => {\n        connectionStatus.classList.add('hidden');\n      }, duration);\n    } else {\n      clearTimeout(hideTimeout);\n      connectionStatus.classList.remove('hidden');\n    }\n  }\n\n  function updateConnectionStatus() {\n    if (navigator.onLine) {\n      showStatus('online', 'Koneksi telah pulih');\n      window.showToast?.('Anda kembali online!', 'success', 3000);\n    } else {\n      showStatus('offline', 'Anda sedang offline', 0);\n      window.showToast?.(\n        'Anda sedang offline. Beberapa fitur mungkin tidak tersedia.',\n        'warning',\n        4000\n      );\n    }\n  }\n\n  // Initial check\n  updateConnectionStatus();\n\n  window.addEventListener('online', updateConnectionStatus);\n  window.addEventListener('offline', updateConnectionStatus);\n})();\n","const CONFIG = {\n  BASE_URL: 'https://story-api.dicoding.dev/v1',\n  DEFAULT_LANGUAGE: 'id-ID',\n  CACHE_NAME: 'DicodingStory-V7', // Update version if cache structure changes\n  DATABASE_NAME: 'dicoding-story-db',\n  DATABASE_VERSION: 1,\n  OBJECT_STORE_NAME: 'stories',\n  FAVORITES_STORE: 'favorites',\n  DEFAULT_MAP_CENTER: [-6.1754, 106.8272], // Jakarta\n  DEFAULT_MAP_ZOOM: 13,\n  PAGE_SIZE: 10,\n  API_TIMEOUT: 30000,\n  API_RETRY_ATTEMPTS: 2,\n  API_RETRY_DELAY: 1000,\n  MAX_PHOTO_SIZE: 5 * 1024 * 1024, // 5MB\n  MAP_TILE_LAYERS: {\n    osm: {\n      url: 'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\n      attribution:\n        '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\n      name: 'OpenStreetMap',\n    },\n    satellite: {\n      url: 'https://api.maptiler.com/maps/hybrid/{z}/{x}/{y}.jpg?key=WlHVW3GmIbcYKHpoc75N',\n      attribution:\n        '<a href=\"https://www.maptiler.com/copyright/\" target=\"_blank\">&copy; MapTiler</a> <a href=\"https://www.openstreetmap.org/copyright\" target=\"_blank\">&copy; OpenStreetMap contributors</a>',\n      name: 'Satellite',\n    },\n    dark: {\n      url: 'https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png',\n      attribution:\n        '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors &copy; <a href=\"https://carto.com/attributions\">CARTO</a>',\n      name: 'Dark Mode',\n    },\n  },\n  VAPID_PUBLIC_KEY:\n    'BCCs2eonMI-6H2ctvFaWg-UYdDv387Vno_bzUzALpB442r2lCnsHmtrx8biyPi_E-1fSGABK_Qs_GlvPoJJqxbk',\n  SERVICE_WORKER_PATH: './sw.js',\n  OFFLINE_PAGE: './offline.html',\n  ACCESS_TOKEN_KEY: 'accessToken',\n  // Improvisasi: Tambahkan pengaturan baru untuk pengembangan dan fitur masa depan\n  ENABLE_LOGGING: process.env.NODE_ENV !== 'production',\n  SUPPORT_CONTACT: 'support@dicodingstory.app',\n  APP_VERSION: '1.0.0',\n  FEEDBACK_URL:\n    'https://github.com/naufalarsyaputrapradana/Dicoding-Story-App/issues',\n};\n\nexport default CONFIG;\n","import CONFIG from '../config';\n\nclass DicodingStoryApi {\n  // Helper: fetch with timeout and retry\n  static async _fetchWithTimeout(url, options = {}, retryAttempt = 0) {\n    const controller = new AbortController();\n    const { signal } = controller;\n    const mergedOptions = {\n      ...options,\n      signal,\n      mode: 'cors',\n      credentials: 'same-origin',\n    };\n\n    const timeout = setTimeout(() => controller.abort(), CONFIG.API_TIMEOUT);\n\n    try {\n      // Handle upload with progress\n      if (\n        options.body instanceof FormData &&\n        options.onProgress &&\n        options.method === 'POST'\n      ) {\n        return await this._uploadWithProgress(url, options);\n      }\n\n      const response = await fetch(url, mergedOptions);\n\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({}));\n        let errorMessage =\n          errorData.message || `HTTP error! status: ${response.status}`;\n\n        // User-friendly error messages\n        if (response.status === 400) {\n          errorMessage =\n            errorData.message ||\n            'Bad Request: The server could not process your request.';\n          const error = new Error(errorMessage);\n          error.status = response.status;\n          error.data = errorData;\n          throw error;\n        } else if (response.status === 401) {\n          errorMessage = 'Sesi Anda telah berakhir. Silakan login kembali.';\n          setTimeout(() => (window.location.hash = '#/login'), 2000);\n        } else if (response.status === 403) {\n          errorMessage = 'Anda tidak memiliki izin untuk melakukan aksi ini.';\n        } else if (response.status === 404) {\n          errorMessage = 'Resource yang diminta tidak ditemukan.';\n        } else if (response.status === 413) {\n          errorMessage = 'File yang diunggah terlalu besar.';\n        } else if (response.status >= 500) {\n          errorMessage = 'Terjadi kesalahan server. Silakan coba lagi nanti.';\n        }\n\n        throw new Error(errorMessage);\n      }\n\n      return await response.json();\n    } catch (error) {\n      if (error.name === 'AbortError') {\n        if (retryAttempt < CONFIG.API_RETRY_ATTEMPTS) {\n          await new Promise((resolve) =>\n            setTimeout(resolve, CONFIG.API_RETRY_DELAY)\n          );\n          return this._fetchWithTimeout(url, options, retryAttempt + 1);\n        }\n        throw new Error(\n          'Request timed out. Silakan periksa koneksi internet Anda dan coba lagi.'\n        );\n      }\n\n      // Network/CORS errors\n      if (\n        error.message === 'Failed to fetch' ||\n        error.message.includes('NetworkError') ||\n        error.message.includes('CORS')\n      ) {\n        if (url.includes('/notifications/')) {\n          return { status: 'failed', error: error.message };\n        }\n        window.showToast?.(\n          'Masalah koneksi jaringan. Silakan periksa koneksi internet Anda.',\n          'warning'\n        );\n      }\n\n      throw error;\n    } finally {\n      clearTimeout(timeout);\n    }\n  }\n\n  // Helper: upload with progress\n  static async _uploadWithProgress(url, options) {\n    return new Promise((resolve, reject) => {\n      const xhr = new XMLHttpRequest();\n      xhr.open(options.method || 'POST', url);\n\n      if (options.headers) {\n        Object.keys(options.headers).forEach((key) => {\n          xhr.setRequestHeader(key, options.headers[key]);\n        });\n      }\n\n      xhr.upload.addEventListener('progress', (event) => {\n        if (event.lengthComputable && options.onProgress) {\n          const percentComplete = Math.round(\n            (event.loaded / event.total) * 100\n          );\n          options.onProgress(percentComplete);\n        }\n      });\n\n      xhr.addEventListener('load', () => {\n        if (xhr.status >= 200 && xhr.status < 300) {\n          try {\n            resolve(JSON.parse(xhr.responseText));\n          } catch {\n            reject(new Error('Format respons dari server tidak valid'));\n          }\n        } else {\n          try {\n            const errorData = JSON.parse(xhr.responseText);\n            reject(\n              new Error(\n                errorData.message || `HTTP error! status: ${xhr.status}`\n              )\n            );\n          } catch {\n            reject(new Error(`HTTP error! status: ${xhr.status}`));\n          }\n        }\n      });\n\n      xhr.addEventListener('error', () =>\n        reject(new Error('Terjadi kesalahan jaringan'))\n      );\n      xhr.addEventListener('abort', () =>\n        reject(new Error('Upload dibatalkan'))\n      );\n      xhr.addEventListener('timeout', () =>\n        reject(new Error('Upload melebihi batas waktu'))\n      );\n      xhr.send(options.body);\n    });\n  }\n\n  // Auth\n  static async register({ name, email, password }) {\n    this._validateEmail(email);\n    this._validatePassword(password);\n\n    try {\n      const result = await this._fetchWithTimeout(\n        `${CONFIG.BASE_URL}/register`,\n        {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({ name, email, password }),\n        }\n      );\n      window.showToast?.('Registrasi berhasil! Silakan login.', 'success');\n      return result;\n    } catch (error) {\n      if (error.message.includes('email is already taken')) {\n        throw new Error('Email sudah digunakan. Silakan gunakan email lain.');\n      }\n      throw error;\n    }\n  }\n\n  static async login({ email, password }) {\n    this._validateEmail(email);\n\n    try {\n      const result = await this._fetchWithTimeout(`${CONFIG.BASE_URL}/login`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ email, password }),\n      });\n      window.showToast?.(\n        `Selamat datang kembali, ${result.loginResult.name}!`,\n        'success'\n      );\n      return result;\n    } catch (error) {\n      if (\n        error.message.includes('user not found') ||\n        error.message.includes('password')\n      ) {\n        throw new Error('Email atau password salah. Silakan coba lagi.');\n      }\n      throw error;\n    }\n  }\n\n  // Stories\n  static async getAllStories({\n    token,\n    page = 1,\n    size = CONFIG.PAGE_SIZE,\n    location = 0,\n  }) {\n    this._validateToken(token);\n\n    try {\n      const response = await this._fetchWithTimeout(\n        `${CONFIG.BASE_URL}/stories?page=${page}&size=${size}&location=${location}`,\n        { headers: { Authorization: `Bearer ${token}` } }\n      );\n      if (!response || !response.listStory) {\n        throw new Error('Format respons dari server tidak valid');\n      }\n      return response;\n    } catch (error) {\n      window.showToast?.('Gagal memuat cerita. ' + error.message, 'error');\n      throw error;\n    }\n  }\n\n  static async getStoryDetail({ token, id }) {\n    this._validateToken(token);\n    if (!id) throw new Error('ID cerita tidak valid');\n    return this._fetchWithTimeout(`${CONFIG.BASE_URL}/stories/${id}`, {\n      headers: { Authorization: `Bearer ${token}` },\n    });\n  }\n\n  static async addNewStory({ token, data, onProgress }) {\n    this._validateToken(token);\n\n    try {\n      if (!data.has('description')) throw new Error('Deskripsi wajib diisi');\n      if (!data.has('photo')) throw new Error('Foto wajib diunggah');\n\n      const options = {\n        method: 'POST',\n        headers: { Authorization: `Bearer ${token}` },\n        body: data,\n        onProgress,\n      };\n\n      const result = await this._fetchWithTimeout(\n        `${CONFIG.BASE_URL}/stories`,\n        options\n      );\n      window.showToast?.('Cerita berhasil ditambahkan!', 'success');\n      return result;\n    } catch (error) {\n      if (error.message.includes('photo')) {\n        throw new Error(\n          'Gagal mengunggah foto. Pastikan ukuran foto tidak melebihi 5MB.'\n        );\n      } else if (error.status === 400) {\n        throw new Error(\n          'Pastikan semua data yang dikirim valid (foto dan deskripsi wajib diisi).'\n        );\n      } else if (\n        error.message.includes('Network') ||\n        error.message.includes('timeout')\n      ) {\n        throw new Error(\n          'Koneksi gagal. Periksa koneksi internet Anda dan coba lagi.'\n        );\n      }\n      throw error;\n    }\n  }\n\n  // Push Notification\n  static async subscribeNotification({ token, subscription }) {\n    this._validateToken(token);\n    try {\n      const result = await this._fetchWithTimeout(\n        `${CONFIG.BASE_URL}/notifications/subscribe`,\n        {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n            Authorization: `Bearer ${token}`,\n          },\n          body: JSON.stringify(subscription),\n        }\n      );\n      window.showToast?.('Notifikasi berhasil diaktifkan!', 'success');\n      return result;\n    } catch (error) {\n      window.showToast?.('Gagal mengaktifkan notifikasi', 'error');\n      throw error;\n    }\n  }\n\n  static async unsubscribeNotification({ token, endpoint }) {\n    this._validateToken(token);\n    if (!endpoint) throw new Error('Endpoint notifikasi tidak valid');\n\n    try {\n      const isDev =\n        window.location.hostname === 'localhost' ||\n        window.location.hostname === '127.0.0.1';\n\n      if (isDev) {\n        window.showToast?.(\n          'Notifikasi berhasil dinonaktifkan (dev mode)',\n          'info'\n        );\n        return {\n          success: true,\n          message: 'Unsubscribed from notifications (development mock)',\n        };\n      }\n\n      const result = await this._fetchWithTimeout(\n        `${CONFIG.BASE_URL}/notifications/subscribe`,\n        {\n          method: 'DELETE',\n          headers: {\n            'Content-Type': 'application/json',\n            Authorization: `Bearer ${token}`,\n          },\n          body: JSON.stringify({ endpoint }),\n        }\n      );\n      window.showToast?.('Notifikasi berhasil dinonaktifkan', 'info');\n      return result;\n    } catch (error) {\n      if (\n        !(\n          window.location.hostname === 'localhost' ||\n          window.location.hostname === '127.0.0.1'\n        )\n      ) {\n        window.showToast?.('Gagal menonaktifkan notifikasi', 'error');\n      }\n      throw error;\n    }\n  }\n\n  // Validation helpers\n  static _validateToken(token) {\n    if (!token)\n      throw new Error('Autentikasi diperlukan. Silakan login terlebih dahulu.');\n  }\n\n  static _validateEmail(email) {\n    const re = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n    if (!re.test(email))\n      throw new Error('Silakan masukkan alamat email yang valid');\n  }\n\n  static _validatePassword(password) {\n    if (!password || password.length < 8)\n      throw new Error('Password harus minimal 8 karakter');\n  }\n}\n\nexport default DicodingStoryApi;\n","export function showFormattedDate(date, locale = 'id-ID', options = {}) {\n  const defaultOptions = {\n    year: 'numeric',\n    month: 'long',\n    day: 'numeric',\n    ...options,\n  };\n  try {\n    return new Date(date).toLocaleDateString(locale, defaultOptions);\n  } catch (error) {\n    console.error('Error formatting date:', error);\n    return date || 'Unknown date';\n  }\n}\n\nexport function truncateText(text, maxLength = 100) {\n  if (!text) return '';\n  return text.length <= maxLength ? text : `${text.substring(0, maxLength)}...`;\n}\n\nexport function debounce(func, wait = 300, immediate = false) {\n  let timeout;\n  return function executedFunction(...args) {\n    const context = this;\n    const later = () => {\n      timeout = null;\n      if (!immediate) func.apply(context, args);\n    };\n    const callNow = immediate && !timeout;\n    clearTimeout(timeout);\n    timeout = setTimeout(later, wait);\n    if (callNow) func.apply(context, args);\n  };\n}\n\nexport async function sleep(ms = 1000) {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n}\n\nexport function formatFileSize(bytes) {\n  if (bytes === 0) return '0 Bytes';\n  const sizes = ['Bytes', 'KB', 'MB', 'GB'];\n  const i = Math.floor(Math.log(bytes) / Math.log(1024));\n  return parseFloat((bytes / Math.pow(1024, i)).toFixed(2)) + ' ' + sizes[i];\n}\n\nexport function validateEmail(email) {\n  const re = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n  return re.test(email);\n}\n\nexport function getInitials(name) {\n  if (!name || typeof name !== 'string') return 'U';\n  return name\n    .split(' ')\n    .map((part) => part.charAt(0))\n    .join('')\n    .toUpperCase()\n    .substring(0, 2); // Maksimal 2 huruf\n}\n\nexport function isMobileDevice() {\n  return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(\n    navigator.userAgent\n  );\n}\n\nexport function isOnline() {\n  return navigator.onLine;\n}\n\nexport function capitalizeFirstLetter(string) {\n  if (!string) return '';\n  return string.charAt(0).toUpperCase() + string.slice(1);\n}\n\nexport function getRandomColor() {\n  const colors = [\n    '#4361ee',\n    '#3f37c9',\n    '#4895ef',\n    '#4cc9f0',\n    '#f72585',\n    '#b5179e',\n  ];\n  return colors[Math.floor(Math.random() * colors.length)];\n}\n\n/**\n * Animasi utilitas untuk elemen (gunakan animate.css atau custom class)\n * @param {HTMLElement} element\n * @param {string} animation\n * @param {number} duration\n */\nexport function animateElement(element, animation, duration = 300) {\n  return new Promise((resolve) => {\n    const animationClass = `animate-${animation}`;\n    element.classList.add(animationClass);\n    setTimeout(() => {\n      element.classList.remove(animationClass);\n      resolve();\n    }, duration);\n  });\n}\n\n/**\n * IMPROVISASI: Utility untuk memformat waktu relatif (misal: \"2 jam lalu\")\n */\nexport function formatRelativeTime(date, locale = 'id-ID') {\n  try {\n    const now = new Date();\n    const then = new Date(date);\n    const diff = now - then;\n    const seconds = Math.floor(diff / 1000);\n    const minutes = Math.floor(seconds / 60);\n    const hours = Math.floor(minutes / 60);\n    const days = Math.floor(hours / 24);\n\n    if (days > 0) return `${days} hari lalu`;\n    if (hours > 0) return `${hours} jam lalu`;\n    if (minutes > 0) return `${minutes} menit lalu`;\n    if (seconds > 10) return `${seconds} detik lalu`;\n    return 'Baru saja';\n  } catch (error) {\n    return date || '';\n  }\n}\n\n/**\n * IMPROVISASI: Utility untuk copy ke clipboard dengan feedback\n */\nexport async function copyToClipboard(text) {\n  try {\n    await navigator.clipboard.writeText(text);\n    window.showToast?.('Teks berhasil disalin!', 'success');\n    return true;\n  } catch (error) {\n    window.showToast?.('Gagal menyalin teks', 'error');\n    return false;\n  }\n}\n","import DicodingStoryApi from '../data/api';\nimport CONFIG from '../config';\nimport { getInitials } from '../utils/index';\n\nclass AppHeader extends HTMLElement {\n  connectedCallback() {\n    this.render();\n    this.setupEventListeners();\n    this.checkNotificationPermission();\n  }\n\n  render() {\n    const isLoggedIn = !!localStorage.getItem('accessToken');\n    let user = null;\n    try {\n      const userData = localStorage.getItem('user');\n      if (userData && userData !== 'undefined') user = JSON.parse(userData);\n    } catch {\n      localStorage.removeItem('user');\n    }\n\n    this.innerHTML = `\n      <header>\n        <div class=\"container main-header\">\n          <a class=\"brand-name\" href=\"#/\" aria-label=\"Home\">\n            <img src=\"/images/logo.png\" alt=\"Dicoding Story Logo\" width=\"32\" height=\"32\">\n            Dicoding Story\n          </a>\n          <nav id=\"navigation-drawer\" class=\"navigation-drawer\" aria-label=\"Main navigation\">\n            <ul id=\"nav-list\" class=\"nav-list\">\n              <li>\n                <a href=\"#/\" class=\"${window.location.hash === '#/' ? 'active' : ''}\" aria-current=\"${window.location.hash === '#/' ? 'page' : 'false'}\">\n                  <i class=\"fas fa-home\" aria-hidden=\"true\"></i> Home\n                </a>\n              </li>\n              <li>\n                <a href=\"#/about\" class=\"${window.location.hash === '#/about' ? 'active' : ''}\" aria-current=\"${window.location.hash === '#/about' ? 'page' : 'false'}\">\n                  <i class=\"fas fa-info-circle\" aria-hidden=\"true\"></i> About\n                </a>\n              </li>\n              ${\n                isLoggedIn\n                  ? `\n                    <li>\n                      <a href=\"#/stories/add\" class=\"${window.location.hash === '#/stories/add' ? 'active' : ''}\" aria-current=\"${window.location.hash === '#/stories/add' ? 'page' : 'false'}\">\n                        <i class=\"fas fa-plus-circle\" aria-hidden=\"true\"></i> Add Story\n                      </a>\n                    </li>\n                    <li>\n                      <a href=\"#/saved\" class=\"${window.location.hash === '#/saved' ? 'active' : ''}\" aria-current=\"${window.location.hash === '#/saved' ? 'page' : 'false'}\">\n                        <i class=\"fas fa-database\" aria-hidden=\"true\"></i> Saved Stories\n                      </a>\n                    </li>\n                    <li class=\"user-menu\">\n                      <div class=\"user-info\" tabindex=\"0\" aria-haspopup=\"true\" aria-expanded=\"false\">\n                        <div class=\"user-avatar\" aria-hidden=\"true\">${getInitials(user?.name)}</div>\n                        <span>${user?.name || 'User'}</span>\n                        <i class=\"fas fa-chevron-down ml-1\" aria-hidden=\"true\"></i>\n                      </div>\n                      <ul class=\"user-dropdown\" role=\"menu\" style=\"display: none;\">\n                        <li role=\"none\">\n                          <button id=\"notification-toggle\" class=\"dropdown-button notification-toggle\" role=\"menuitem\">\n                            <i class=\"fas fa-bell\" aria-hidden=\"true\"></i>\n                            <span id=\"notification-status\">Enable Notifications</span>\n                            <span class=\"status-indicator\"></span>\n                          </button>\n                        </li>\n                        <li role=\"none\">\n                          <button id=\"logout-button\" class=\"dropdown-button logout-button\" role=\"menuitem\">\n                            <i class=\"fas fa-sign-out-alt\" aria-hidden=\"true\"></i>\n                            Logout\n                          </button>\n                        </li>\n                      </ul>\n                    </li>\n                  `\n                  : `\n                    <li>\n                      <a href=\"#/login\" class=\"${window.location.hash === '#/login' ? 'active' : ''}\" aria-current=\"${window.location.hash === '#/login' ? 'page' : 'false'}\">\n                        <i class=\"fas fa-sign-in-alt\" aria-hidden=\"true\"></i> Login\n                      </a>\n                    </li>\n                    <li>\n                      <a href=\"#/register\" class=\"${window.location.hash === '#/register' ? 'active' : ''}\" aria-current=\"${window.location.hash === '#/register' ? 'page' : 'false'}\">\n                        <i class=\"fas fa-user-plus\" aria-hidden=\"true\"></i> Register\n                      </a>\n                    </li>\n                  `\n              }\n            </ul>\n          </nav>\n          <button id=\"drawer-button\" class=\"drawer-button\" aria-label=\"Toggle navigation\" aria-expanded=\"false\" aria-controls=\"navigation-drawer\">\n            <i class=\"fas fa-bars\" aria-hidden=\"true\"></i>\n          </button>\n        </div>\n      </header>\n    `;\n  }\n\n  setupEventListeners() {\n    this._setupDrawerToggle();\n    this._setupUserMenu();\n    this._setupLogoutButton();\n    this._setupNotificationToggle();\n  }\n\n  _setupDrawerToggle() {\n    const drawerButton = this.querySelector('#drawer-button');\n    const navigationDrawer = this.querySelector('#navigation-drawer');\n    if (!drawerButton || !navigationDrawer) return;\n\n    drawerButton.addEventListener('click', (e) => {\n      e.stopPropagation();\n      const isOpen = navigationDrawer.classList.toggle('open');\n      drawerButton.setAttribute('aria-expanded', isOpen);\n      if (isOpen) {\n        const firstNavItem = navigationDrawer.querySelector('a');\n        if (firstNavItem) firstNavItem.focus();\n      }\n    });\n\n    document.addEventListener('click', (event) => {\n      if (!navigationDrawer.contains(event.target)) {\n        navigationDrawer.classList.remove('open');\n        drawerButton.setAttribute('aria-expanded', 'false');\n      }\n    });\n\n    document.addEventListener('keydown', (event) => {\n      if (event.key === 'Escape') {\n        navigationDrawer.classList.remove('open');\n        drawerButton.setAttribute('aria-expanded', 'false');\n        drawerButton.focus();\n      }\n    });\n  }\n\n  _setupUserMenu() {\n    const userMenu = this.querySelector('.user-menu');\n    if (!userMenu) return;\n    const userInfo = userMenu.querySelector('.user-info');\n    const dropdown = userMenu.querySelector('.user-dropdown');\n\n    userInfo.addEventListener('click', (e) => {\n      e.stopPropagation();\n      const isExpanded = userInfo.getAttribute('aria-expanded') === 'true';\n      userInfo.setAttribute('aria-expanded', !isExpanded);\n      dropdown.style.display = isExpanded ? 'none' : 'block';\n    });\n\n    document.addEventListener('click', () => {\n      userInfo.setAttribute('aria-expanded', 'false');\n      dropdown.style.display = 'none';\n    });\n\n    userInfo.addEventListener('keydown', (e) => {\n      if (e.key === 'Enter' || e.key === ' ') {\n        e.preventDefault();\n        const isExpanded = userInfo.getAttribute('aria-expanded') === 'true';\n        userInfo.setAttribute('aria-expanded', !isExpanded);\n        dropdown.style.display = isExpanded ? 'none' : 'block';\n        if (!isExpanded) {\n          const firstItem = dropdown.querySelector('button');\n          if (firstItem) firstItem.focus();\n        }\n      }\n    });\n  }\n\n  _setupLogoutButton() {\n    const logoutButton = this.querySelector('#logout-button');\n    if (!logoutButton) return;\n    logoutButton.addEventListener('click', () => {\n      Swal.fire({\n        title: 'Logout',\n        text: 'Are you sure you want to logout?',\n        icon: 'question',\n        showCancelButton: true,\n        confirmButtonColor: '#4361ee',\n        cancelButtonColor: '#f72585',\n        confirmButtonText: 'Yes, Logout',\n        cancelButtonText: 'Cancel',\n        focusCancel: true,\n      }).then((result) => {\n        if (result.isConfirmed) {\n          this._cleanupNotifications();\n          localStorage.removeItem('token');\n          localStorage.removeItem('user');\n          window.showToast && window.showToast('Logout berhasil', 'success');\n          window.location.hash = '#/login';\n        }\n      });\n    });\n  }\n\n  async _cleanupNotifications() {\n    if (!('serviceWorker' in navigator) || !('PushManager' in window)) return;\n    try {\n      const registration = await navigator.serviceWorker.ready;\n      const subscription = await registration.pushManager.getSubscription();\n      if (subscription) await subscription.unsubscribe();\n    } catch {}\n  }\n\n  async checkNotificationPermission() {\n    const notificationToggle = this.querySelector('#notification-toggle');\n    const notificationStatus = this.querySelector('#notification-status');\n    const statusIndicator = this.querySelector('.status-indicator');\n    if (!notificationToggle || !notificationStatus || !statusIndicator) return;\n\n    if (Notification.permission === 'granted') {\n      const hasSubscription = await this._checkActiveSubscription();\n      notificationStatus.textContent = hasSubscription\n        ? 'Disable Notifications'\n        : 'Enable Notifications';\n      statusIndicator.classList.toggle('active', hasSubscription);\n      notificationToggle.classList.toggle('enabled', hasSubscription);\n    } else if (Notification.permission === 'denied') {\n      notificationStatus.textContent = 'Notifications Blocked';\n      notificationToggle.disabled = true;\n      notificationToggle.classList.add('blocked');\n      statusIndicator.classList.add('blocked');\n    } else {\n      notificationStatus.textContent = 'Enable Notifications';\n      statusIndicator.classList.remove('active');\n      notificationToggle.classList.remove('enabled');\n    }\n  }\n\n  async _checkActiveSubscription() {\n    if (!('serviceWorker' in navigator) || !('PushManager' in window))\n      return false;\n    try {\n      const registration = await navigator.serviceWorker.ready;\n      const subscription = await registration.pushManager.getSubscription();\n      return !!subscription;\n    } catch {\n      return false;\n    }\n  }\n\n  _setupNotificationToggle() {\n    const notificationToggle = this.querySelector('#notification-toggle');\n    const notificationStatus = this.querySelector('#notification-status');\n    const statusIndicator = this.querySelector('.status-indicator');\n    if (!notificationToggle || !notificationStatus || !statusIndicator) return;\n\n    notificationToggle.addEventListener('click', async () => {\n      if (notificationToggle.disabled) return;\n      notificationToggle.disabled = true;\n      notificationToggle.classList.add('loading');\n      const originalText = notificationStatus.textContent;\n      notificationStatus.textContent = 'Processing...';\n\n      try {\n        const hasSubscription = await this._checkActiveSubscription();\n        if (hasSubscription) {\n          await this._unsubscribeFromNotifications();\n          notificationStatus.textContent = 'Enable Notifications';\n          statusIndicator.classList.remove('active');\n          notificationToggle.classList.remove('enabled');\n        } else {\n          if (Notification.permission === 'granted') {\n            await this._subscribeToNotifications();\n            notificationStatus.textContent = 'Disable Notifications';\n            statusIndicator.classList.add('active');\n            notificationToggle.classList.add('enabled');\n          } else {\n            const permission = await Notification.requestPermission();\n            if (permission === 'granted') {\n              await this._subscribeToNotifications();\n              notificationStatus.textContent = 'Disable Notifications';\n              statusIndicator.classList.add('active');\n              notificationToggle.classList.add('enabled');\n            } else if (permission === 'denied') {\n              notificationStatus.textContent = 'Notifications Blocked';\n              notificationToggle.disabled = true;\n              notificationToggle.classList.add('blocked');\n              statusIndicator.classList.add('blocked');\n              window.showToast &&\n                window.showToast(\n                  'Izin notifikasi ditolak oleh browser',\n                  'warning'\n                );\n            }\n          }\n        }\n      } catch {\n        notificationStatus.textContent = originalText;\n        window.showToast &&\n          window.showToast('Gagal mengubah status notifikasi', 'error');\n      } finally {\n        notificationToggle.disabled = false;\n        notificationToggle.classList.remove('loading');\n      }\n    });\n  }\n\n  async _subscribeToNotifications() {\n    if (!('serviceWorker' in navigator) || !('PushManager' in window)) return;\n    const token = localStorage.getItem('accessToken');\n    if (!token) return;\n    try {\n      const registration = await navigator.serviceWorker.ready;\n      const existingSubscription =\n        await registration.pushManager.getSubscription();\n      if (existingSubscription) await existingSubscription.unsubscribe();\n      const subscription = await registration.pushManager.subscribe({\n        userVisibleOnly: true,\n        applicationServerKey: CONFIG.VAPID_PUBLIC_KEY,\n      });\n      const { endpoint, keys } = subscription.toJSON();\n      await DicodingStoryApi.subscribeNotification({\n        token,\n        subscription: { endpoint, keys },\n      });\n      window.showToast &&\n        window.showToast('Notifikasi berhasil diaktifkan', 'success');\n      return true;\n    } catch {\n      window.showToast &&\n        window.showToast('Gagal mengaktifkan notifikasi', 'error');\n      return false;\n    }\n  }\n\n  async _unsubscribeFromNotifications() {\n    const token = localStorage.getItem('accessToken');\n    if (!token) return false;\n    try {\n      const registration = await navigator.serviceWorker.ready;\n      const subscription = await registration.pushManager.getSubscription();\n      if (subscription) {\n        try {\n          await DicodingStoryApi.unsubscribeNotification({\n            token,\n            endpoint: subscription.endpoint,\n          });\n        } catch {}\n        await subscription.unsubscribe();\n        window.showToast &&\n          window.showToast('Notifikasi berhasil dinonaktifkan', 'info');\n        return true;\n      }\n      return true;\n    } catch {\n      window.showToast &&\n        window.showToast('Gagal menonaktifkan notifikasi', 'error');\n      return false;\n    }\n  }\n}\n\ncustomElements.define('app-header', AppHeader);\n","class AppSidebar extends HTMLElement {\n  constructor() {\n    super();\n    this._isInitialized = false;\n    this._isLoggedIn = false;\n    this._userData = null;\n    this._checkLoginStatus();\n  }\n\n  connectedCallback() {\n    this._render();\n    this._isInitialized = true;\n    this._bindEvents();\n    window.addEventListener('hashchange', () => this._render());\n    window.addEventListener('user-login-state-changed', (event) => {\n      this._isLoggedIn = event.detail.isLoggedIn;\n      this._userData = event.detail.userData;\n      this._render();\n    });\n  }\n\n  disconnectedCallback() {\n    // Clean up event listeners\n    window.removeEventListener('hashchange', this._render);\n    window.removeEventListener('user-login-state-changed', this._render);\n  }\n\n  _checkLoginStatus() {\n    try {\n      const token = localStorage.getItem('accessToken');\n      const userData = localStorage.getItem('user');\n      if (token && userData && userData !== 'undefined') {\n        try {\n          this._isLoggedIn = true;\n          this._userData = JSON.parse(userData);\n        } catch {\n          localStorage.removeItem('user');\n          this._isLoggedIn = !!token;\n          this._userData = null;\n        }\n      } else {\n        this._isLoggedIn = false;\n        this._userData = null;\n      }\n    } catch {\n      this._isLoggedIn = false;\n      this._userData = null;\n    }\n  }\n\n  _render() {\n    this.innerHTML = `\n      <div class=\"sidebar-container\">\n        <button id=\"sidebar-toggle\" class=\"sidebar-toggle\" aria-label=\"Open sidebar\">\n          <i class=\"fas fa-bars\"></i>\n        </button>\n        <div id=\"sidebar\" class=\"sidebar position-fixed\" tabindex=\"-1\" aria-label=\"Sidebar navigation\">\n          <div class=\"sidebar-header\">\n            <img src=\"./images/logo.png\" alt=\"Dicoding Story Logo\" class=\"sidebar-logo\">\n            <h2 class=\"sidebar-title\">Dicoding Story</h2>\n            <button id=\"sidebar-close\" class=\"sidebar-close\" aria-label=\"Close sidebar\">\n              <i class=\"fas fa-times\" aria-hidden=\"true\"></i>\n            </button>\n          </div>\n          <div class=\"sidebar-content\">\n            ${this._renderUserSection()}\n            <nav class=\"sidebar-nav\" aria-label=\"Sidebar main navigation\">\n              <ul>\n                <li>\n                  <a href=\"#/\" class=\"sidebar-link ${this._isActiveRoute('#/') ? 'active' : ''}\">\n                    <i class=\"fas fa-home\" aria-hidden=\"true\"></i>\n                    <span>Home</span>\n                  </a>\n                </li>\n                ${\n                  this._isLoggedIn\n                    ? `\n                <li>\n                  <a href=\"#/stories/add\" class=\"sidebar-link ${this._isActiveRoute('#/stories/add') ? 'active' : ''}\">\n                    <i class=\"fas fa-plus-circle\" aria-hidden=\"true\"></i>\n                    <span>Add Story</span>\n                  </a>\n                </li>\n                `\n                    : ''\n                }\n                <li>\n                  <a href=\"#/about\" class=\"sidebar-link ${this._isActiveRoute('#/about') ? 'active' : ''}\">\n                    <i class=\"fas fa-info-circle\" aria-hidden=\"true\"></i>\n                    <span>About</span>\n                  </a>\n                </li>\n                <li>\n                  <a href=\"#/saved\" class=\"sidebar-link ${this._isActiveRoute('#/saved') ? 'active' : ''}\" id=\"sidebar-saved-link\">\n                    <i class=\"fas fa-database\" aria-hidden=\"true\"></i>\n                    <span>Saved Stories</span>\n                  </a>\n                </li>\n              </ul>\n            </nav>\n          </div>\n          <div class=\"sidebar-footer\">\n            ${\n              this._isLoggedIn\n                ? `\n              <button id=\"logout-button\" class=\"sidebar-logout-button\">\n                <i class=\"fas fa-sign-out-alt\" aria-hidden=\"true\"></i>\n                <span>Log Out</span>\n              </button>\n            `\n                : `\n              <div class=\"sidebar-auth-buttons\">\n                <a href=\"#/login\" class=\"sidebar-auth-button login\">\n                  <i class=\"fas fa-sign-in-alt\" aria-hidden=\"true\"></i>\n                  <span>Login</span>\n                </a>\n                <a href=\"#/register\" class=\"sidebar-auth-button register\">\n                  <i class=\"fas fa-user-plus\" aria-hidden=\"true\"></i>\n                  <span>Register</span>\n                </a>\n              </div>\n            `\n            }\n          </div>\n        </div>\n        <div id=\"sidebar-overlay\" class=\"sidebar-overlay\"></div>\n      </div>\n    `;\n  }\n\n  _renderUserSection() {\n    if (!this._isLoggedIn || !this._userData) {\n      return `\n        <div class=\"sidebar-guest\">\n          <i class=\"fas fa-user-circle sidebar-guest-icon\" aria-hidden=\"true\"></i>\n          <p>Welcome, Guest!</p>\n          <small>Login to share your story</small>\n        </div>\n      `;\n    }\n    const userInitials = this._getInitials(this._userData.name);\n    const avatarColor = this._getAvatarColor(this._userData.name);\n    return `\n      <div class=\"sidebar-user\">\n        <div class=\"sidebar-user-avatar\" style=\"background-color: ${avatarColor}\">\n          ${\n            this._userData.photoUrl\n              ? `<img src=\"${this._userData.photoUrl}\" alt=\"${this._userData.name}'s avatar\">`\n              : `<span class=\"avatar-initials\">${userInitials}</span>`\n          }\n        </div>\n        <div class=\"sidebar-user-info\">\n          <h3 class=\"sidebar-user-name\">${this._userData.name}</h3>\n          <p class=\"sidebar-user-email\">${this._userData.email}</p>\n        </div>\n      </div>\n    `;\n  }\n\n  _getInitials(name) {\n    if (!name || typeof name !== 'string') return '?';\n    return name\n      .split(' ')\n      .map((part) => part.charAt(0))\n      .join('')\n      .toUpperCase()\n      .substring(0, 2);\n  }\n\n  _getAvatarColor(name) {\n    if (!name) return '#4361ee';\n    const colors = [\n      '#4361ee',\n      '#3a0ca3',\n      '#f72585',\n      '#4cc9f0',\n      '#4895ef',\n      '#560bad',\n      '#f8961e',\n      '#fb5607',\n      '#80b918',\n    ];\n    let hash = 0;\n    for (let i = 0; i < name.length; i++) {\n      hash = name.charCodeAt(i) + ((hash << 5) - hash);\n    }\n    return colors[Math.abs(hash) % colors.length];\n  }\n\n  _bindEvents() {\n    const toggleButton = this.querySelector('#sidebar-toggle');\n    const sidebar = this.querySelector('#sidebar');\n    const overlay = this.querySelector('#sidebar-overlay');\n    const closeButton = this.querySelector('#sidebar-close');\n\n    if (toggleButton)\n      toggleButton.addEventListener('click', () => this._toggleSidebar());\n    if (closeButton)\n      closeButton.addEventListener('click', () => this._closeSidebar());\n    if (overlay) overlay.addEventListener('click', () => this._closeSidebar());\n\n    // Logout event: dispatch custom event for global handler\n    const logoutButton = this.querySelector('#logout-button');\n    if (logoutButton) {\n      logoutButton.addEventListener('click', () => {\n        this.dispatchEvent(\n          new CustomEvent('user-logout', { bubbles: true, composed: true })\n        );\n        this._closeSidebar();\n      });\n    }\n\n    // Sidebar links: close sidebar on navigation\n    const sidebarLinks = this.querySelectorAll('.sidebar-link');\n    sidebarLinks.forEach((link) => {\n      link.addEventListener('click', () => this._closeSidebar());\n    });\n\n    // Saved Stories link: always go to #/saved, never redirect to login\n    const savedLink = this.querySelector('#sidebar-saved-link');\n    if (savedLink) {\n      savedLink.addEventListener('click', (e) => {\n        e.preventDefault();\n        window.location.hash = '#/saved';\n        this._closeSidebar();\n      });\n    }\n\n    // Keyboard accessibility for sidebar\n    sidebar &&\n      sidebar.addEventListener('keydown', (e) => {\n        if (e.key === 'Escape') this._closeSidebar();\n      });\n  }\n\n  _toggleSidebar() {\n    const sidebar = this.querySelector('#sidebar');\n    const overlay = this.querySelector('#sidebar-overlay');\n    if (!sidebar || !overlay) return;\n    if (sidebar.classList.contains('open')) {\n      this._closeSidebar();\n    } else {\n      sidebar.classList.add('open');\n      overlay.classList.add('visible');\n      document.body.classList.add('sidebar-open');\n      sidebar.focus();\n    }\n  }\n\n  _closeSidebar() {\n    const sidebar = this.querySelector('#sidebar');\n    const overlay = this.querySelector('#sidebar-overlay');\n    if (!sidebar || !overlay) return;\n    sidebar.classList.remove('open');\n    overlay.classList.remove('visible');\n    document.body.classList.remove('sidebar-open');\n  }\n\n  _isActiveRoute(route) {\n    const currentRoute = window.location.hash || '#/';\n    if (currentRoute === route) return true;\n    if (route === '#/stories/add' && currentRoute.includes('#/stories/add'))\n      return true;\n    if (\n      route === '#/stories' &&\n      currentRoute.includes('#/stories/') &&\n      !currentRoute.includes('#/stories/add')\n    )\n      return true;\n    if (\n      route === '#/saved' &&\n      (currentRoute === '#/favorites' || currentRoute === '#/saved')\n    )\n      return true;\n    return false;\n  }\n}\n\ncustomElements.define('app-sidebar', AppSidebar);\nexport default AppSidebar;\n","class AppFooter extends HTMLElement {\n  connectedCallback() {\n    this.render();\n    this.setupEventListeners();\n  }\n\n  render() {\n    const currentYear = new Date().getFullYear();\n    this.innerHTML = `\n      <footer class=\"app-footer\" role=\"contentinfo\">\n        <div class=\"container footer-content\">\n          <div class=\"social-links\" aria-label=\"Social media links\">\n            <a href=\"https://github.com/NaufalArsyaputraPradana/\" aria-label=\"GitHub\" target=\"_blank\" rel=\"noopener noreferrer\">\n              <i class=\"fab fa-github\"></i>\n            </a>\n            <a href=\"https://www.linkedin.com/in/naufalarsyaputrapradana/\" aria-label=\"LinkedIn\" target=\"_blank\" rel=\"noopener noreferrer\">\n              <i class=\"fab fa-linkedin\"></i>\n            </a>\n            <a href=\"https://www.instagram.com/arsya.pradana_/\" aria-label=\"Instagram\" target=\"_blank\" rel=\"noopener noreferrer\">\n              <i class=\"fab fa-instagram\"></i>\n            </a>\n          </div>\n          <p class=\"footer-year\" tabindex=\"0\" style=\"cursor:pointer;\">\n            &copy; ${currentYear} Dicoding Story. All rights reserved.\n          </p>\n          <p class=\"copyright\">\n            Made with <i class=\"fas fa-code\" style=\"color: var(--danger)\" aria-hidden=\"true\"></i>\n            by <a href=\"https://github.com/NaufalArsyaputraPradana/\" target=\"_blank\" rel=\"noopener noreferrer\">Naufal Arsyaputra Pradana</a>\n            for Dicoding Submission\n          </p>\n        </div>\n      </footer>\n    `;\n  }\n\n  setupEventListeners() {\n    // Scroll to top on year click or Enter/Space key\n    const yearElement = this.querySelector('.footer-year');\n    if (yearElement) {\n      yearElement.addEventListener('click', () => {\n        window.scrollTo({ top: 0, behavior: 'smooth' });\n      });\n      yearElement.addEventListener('keydown', (e) => {\n        if (e.key === 'Enter' || e.key === ' ') {\n          e.preventDefault();\n          window.scrollTo({ top: 0, behavior: 'smooth' });\n        }\n      });\n    }\n  }\n}\n\ncustomElements.define('app-footer', AppFooter);\n","class AppLoader extends HTMLElement {\n  constructor() {\n    super();\n    this.message = 'Loading...';\n    this._timeout = null;\n  }\n\n  static get observedAttributes() {\n    return ['message'];\n  }\n\n  attributeChangedCallback(name, oldValue, newValue) {\n    if (name === 'message' && oldValue !== newValue) {\n      this.message = newValue;\n      this.renderMessage();\n    }\n  }\n\n  connectedCallback() {\n    this.render();\n    this.hide();\n  }\n\n  show(message = '', withTimeout = 0) {\n    if (message) {\n      this.message = message;\n      this.renderMessage();\n    }\n    this.style.display = 'flex';\n    this.setAttribute('aria-busy', 'true');\n    if (withTimeout > 0) {\n      clearTimeout(this._timeout);\n      this._timeout = setTimeout(() => this.hide(), withTimeout);\n    }\n  }\n\n  hide() {\n    this.style.display = 'none';\n    this.setAttribute('aria-busy', 'false');\n    clearTimeout(this._timeout);\n  }\n\n  render() {\n    this.innerHTML = `\n      <div class=\"loading-spinner\" aria-live=\"polite\" aria-busy=\"true\">\n        <div class=\"spinner\"></div>\n        <p class=\"loading-message\">${this.message}</p>\n      </div>\n    `;\n  }\n\n  renderMessage() {\n    const messageElement = this.querySelector('.loading-message');\n    if (messageElement) {\n      messageElement.textContent = this.message;\n    }\n  }\n}\n\ncustomElements.define('app-loader', AppLoader);\n","const instanceOfAny = (object, constructors) => constructors.some((c) => object instanceof c);\n\nlet idbProxyableTypes;\nlet cursorAdvanceMethods;\n// This is a function to prevent it throwing up in node environments.\nfunction getIdbProxyableTypes() {\n    return (idbProxyableTypes ||\n        (idbProxyableTypes = [\n            IDBDatabase,\n            IDBObjectStore,\n            IDBIndex,\n            IDBCursor,\n            IDBTransaction,\n        ]));\n}\n// This is a function to prevent it throwing up in node environments.\nfunction getCursorAdvanceMethods() {\n    return (cursorAdvanceMethods ||\n        (cursorAdvanceMethods = [\n            IDBCursor.prototype.advance,\n            IDBCursor.prototype.continue,\n            IDBCursor.prototype.continuePrimaryKey,\n        ]));\n}\nconst transactionDoneMap = new WeakMap();\nconst transformCache = new WeakMap();\nconst reverseTransformCache = new WeakMap();\nfunction promisifyRequest(request) {\n    const promise = new Promise((resolve, reject) => {\n        const unlisten = () => {\n            request.removeEventListener('success', success);\n            request.removeEventListener('error', error);\n        };\n        const success = () => {\n            resolve(wrap(request.result));\n            unlisten();\n        };\n        const error = () => {\n            reject(request.error);\n            unlisten();\n        };\n        request.addEventListener('success', success);\n        request.addEventListener('error', error);\n    });\n    // This mapping exists in reverseTransformCache but doesn't exist in transformCache. This\n    // is because we create many promises from a single IDBRequest.\n    reverseTransformCache.set(promise, request);\n    return promise;\n}\nfunction cacheDonePromiseForTransaction(tx) {\n    // Early bail if we've already created a done promise for this transaction.\n    if (transactionDoneMap.has(tx))\n        return;\n    const done = new Promise((resolve, reject) => {\n        const unlisten = () => {\n            tx.removeEventListener('complete', complete);\n            tx.removeEventListener('error', error);\n            tx.removeEventListener('abort', error);\n        };\n        const complete = () => {\n            resolve();\n            unlisten();\n        };\n        const error = () => {\n            reject(tx.error || new DOMException('AbortError', 'AbortError'));\n            unlisten();\n        };\n        tx.addEventListener('complete', complete);\n        tx.addEventListener('error', error);\n        tx.addEventListener('abort', error);\n    });\n    // Cache it for later retrieval.\n    transactionDoneMap.set(tx, done);\n}\nlet idbProxyTraps = {\n    get(target, prop, receiver) {\n        if (target instanceof IDBTransaction) {\n            // Special handling for transaction.done.\n            if (prop === 'done')\n                return transactionDoneMap.get(target);\n            // Make tx.store return the only store in the transaction, or undefined if there are many.\n            if (prop === 'store') {\n                return receiver.objectStoreNames[1]\n                    ? undefined\n                    : receiver.objectStore(receiver.objectStoreNames[0]);\n            }\n        }\n        // Else transform whatever we get back.\n        return wrap(target[prop]);\n    },\n    set(target, prop, value) {\n        target[prop] = value;\n        return true;\n    },\n    has(target, prop) {\n        if (target instanceof IDBTransaction &&\n            (prop === 'done' || prop === 'store')) {\n            return true;\n        }\n        return prop in target;\n    },\n};\nfunction replaceTraps(callback) {\n    idbProxyTraps = callback(idbProxyTraps);\n}\nfunction wrapFunction(func) {\n    // Due to expected object equality (which is enforced by the caching in `wrap`), we\n    // only create one new func per func.\n    // Cursor methods are special, as the behaviour is a little more different to standard IDB. In\n    // IDB, you advance the cursor and wait for a new 'success' on the IDBRequest that gave you the\n    // cursor. It's kinda like a promise that can resolve with many values. That doesn't make sense\n    // with real promises, so each advance methods returns a new promise for the cursor object, or\n    // undefined if the end of the cursor has been reached.\n    if (getCursorAdvanceMethods().includes(func)) {\n        return function (...args) {\n            // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use\n            // the original object.\n            func.apply(unwrap(this), args);\n            return wrap(this.request);\n        };\n    }\n    return function (...args) {\n        // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use\n        // the original object.\n        return wrap(func.apply(unwrap(this), args));\n    };\n}\nfunction transformCachableValue(value) {\n    if (typeof value === 'function')\n        return wrapFunction(value);\n    // This doesn't return, it just creates a 'done' promise for the transaction,\n    // which is later returned for transaction.done (see idbObjectHandler).\n    if (value instanceof IDBTransaction)\n        cacheDonePromiseForTransaction(value);\n    if (instanceOfAny(value, getIdbProxyableTypes()))\n        return new Proxy(value, idbProxyTraps);\n    // Return the same value back if we're not going to transform it.\n    return value;\n}\nfunction wrap(value) {\n    // We sometimes generate multiple promises from a single IDBRequest (eg when cursoring), because\n    // IDB is weird and a single IDBRequest can yield many responses, so these can't be cached.\n    if (value instanceof IDBRequest)\n        return promisifyRequest(value);\n    // If we've already transformed this value before, reuse the transformed value.\n    // This is faster, but it also provides object equality.\n    if (transformCache.has(value))\n        return transformCache.get(value);\n    const newValue = transformCachableValue(value);\n    // Not all types are transformed.\n    // These may be primitive types, so they can't be WeakMap keys.\n    if (newValue !== value) {\n        transformCache.set(value, newValue);\n        reverseTransformCache.set(newValue, value);\n    }\n    return newValue;\n}\nconst unwrap = (value) => reverseTransformCache.get(value);\n\n/**\n * Open a database.\n *\n * @param name Name of the database.\n * @param version Schema version.\n * @param callbacks Additional callbacks.\n */\nfunction openDB(name, version, { blocked, upgrade, blocking, terminated } = {}) {\n    const request = indexedDB.open(name, version);\n    const openPromise = wrap(request);\n    if (upgrade) {\n        request.addEventListener('upgradeneeded', (event) => {\n            upgrade(wrap(request.result), event.oldVersion, event.newVersion, wrap(request.transaction), event);\n        });\n    }\n    if (blocked) {\n        request.addEventListener('blocked', (event) => blocked(\n        // Casting due to https://github.com/microsoft/TypeScript-DOM-lib-generator/pull/1405\n        event.oldVersion, event.newVersion, event));\n    }\n    openPromise\n        .then((db) => {\n        if (terminated)\n            db.addEventListener('close', () => terminated());\n        if (blocking) {\n            db.addEventListener('versionchange', (event) => blocking(event.oldVersion, event.newVersion, event));\n        }\n    })\n        .catch(() => { });\n    return openPromise;\n}\n/**\n * Delete a database.\n *\n * @param name Name of the database.\n */\nfunction deleteDB(name, { blocked } = {}) {\n    const request = indexedDB.deleteDatabase(name);\n    if (blocked) {\n        request.addEventListener('blocked', (event) => blocked(\n        // Casting due to https://github.com/microsoft/TypeScript-DOM-lib-generator/pull/1405\n        event.oldVersion, event));\n    }\n    return wrap(request).then(() => undefined);\n}\n\nconst readMethods = ['get', 'getKey', 'getAll', 'getAllKeys', 'count'];\nconst writeMethods = ['put', 'add', 'delete', 'clear'];\nconst cachedMethods = new Map();\nfunction getMethod(target, prop) {\n    if (!(target instanceof IDBDatabase &&\n        !(prop in target) &&\n        typeof prop === 'string')) {\n        return;\n    }\n    if (cachedMethods.get(prop))\n        return cachedMethods.get(prop);\n    const targetFuncName = prop.replace(/FromIndex$/, '');\n    const useIndex = prop !== targetFuncName;\n    const isWrite = writeMethods.includes(targetFuncName);\n    if (\n    // Bail if the target doesn't exist on the target. Eg, getAll isn't in Edge.\n    !(targetFuncName in (useIndex ? IDBIndex : IDBObjectStore).prototype) ||\n        !(isWrite || readMethods.includes(targetFuncName))) {\n        return;\n    }\n    const method = async function (storeName, ...args) {\n        // isWrite ? 'readwrite' : undefined gzipps better, but fails in Edge :(\n        const tx = this.transaction(storeName, isWrite ? 'readwrite' : 'readonly');\n        let target = tx.store;\n        if (useIndex)\n            target = target.index(args.shift());\n        // Must reject if op rejects.\n        // If it's a write operation, must reject if tx.done rejects.\n        // Must reject with op rejection first.\n        // Must resolve with op value.\n        // Must handle both promises (no unhandled rejections)\n        return (await Promise.all([\n            target[targetFuncName](...args),\n            isWrite && tx.done,\n        ]))[0];\n    };\n    cachedMethods.set(prop, method);\n    return method;\n}\nreplaceTraps((oldTraps) => ({\n    ...oldTraps,\n    get: (target, prop, receiver) => getMethod(target, prop) || oldTraps.get(target, prop, receiver),\n    has: (target, prop) => !!getMethod(target, prop) || oldTraps.has(target, prop),\n}));\n\nconst advanceMethodProps = ['continue', 'continuePrimaryKey', 'advance'];\nconst methodMap = {};\nconst advanceResults = new WeakMap();\nconst ittrProxiedCursorToOriginalProxy = new WeakMap();\nconst cursorIteratorTraps = {\n    get(target, prop) {\n        if (!advanceMethodProps.includes(prop))\n            return target[prop];\n        let cachedFunc = methodMap[prop];\n        if (!cachedFunc) {\n            cachedFunc = methodMap[prop] = function (...args) {\n                advanceResults.set(this, ittrProxiedCursorToOriginalProxy.get(this)[prop](...args));\n            };\n        }\n        return cachedFunc;\n    },\n};\nasync function* iterate(...args) {\n    // tslint:disable-next-line:no-this-assignment\n    let cursor = this;\n    if (!(cursor instanceof IDBCursor)) {\n        cursor = await cursor.openCursor(...args);\n    }\n    if (!cursor)\n        return;\n    cursor = cursor;\n    const proxiedCursor = new Proxy(cursor, cursorIteratorTraps);\n    ittrProxiedCursorToOriginalProxy.set(proxiedCursor, cursor);\n    // Map this double-proxy back to the original, so other cursor methods work.\n    reverseTransformCache.set(proxiedCursor, unwrap(cursor));\n    while (cursor) {\n        yield proxiedCursor;\n        // If one of the advancing methods was not called, call continue().\n        cursor = await (advanceResults.get(proxiedCursor) || cursor.continue());\n        advanceResults.delete(proxiedCursor);\n    }\n}\nfunction isIteratorProp(target, prop) {\n    return ((prop === Symbol.asyncIterator &&\n        instanceOfAny(target, [IDBIndex, IDBObjectStore, IDBCursor])) ||\n        (prop === 'iterate' && instanceOfAny(target, [IDBIndex, IDBObjectStore])));\n}\nreplaceTraps((oldTraps) => ({\n    ...oldTraps,\n    get(target, prop, receiver) {\n        if (isIteratorProp(target, prop))\n            return iterate;\n        return oldTraps.get(target, prop, receiver);\n    },\n    has(target, prop) {\n        return isIteratorProp(target, prop) || oldTraps.has(target, prop);\n    },\n}));\n\nexport { deleteDB, openDB, unwrap, wrap };\n","import { openDB } from 'idb';\n\nconst DB_NAME = 'dicoding-story-db';\nconst DB_VERSION = 1;\nconst STORE_NAME = 'stories';\nconst FAVORITES_STORE = 'favorites';\n\nasync function getDb() {\n  return openDB(DB_NAME, DB_VERSION, {\n    upgrade(db) {\n      if (!db.objectStoreNames.contains(STORE_NAME)) {\n        db.createObjectStore(STORE_NAME, { keyPath: 'id' });\n      }\n      if (!db.objectStoreNames.contains(FAVORITES_STORE)) {\n        db.createObjectStore(FAVORITES_STORE, { keyPath: 'id' });\n      }\n    },\n  });\n}\n\n// Stories\nexport async function saveStories(stories) {\n  if (!Array.isArray(stories)) return;\n  const db = await getDb();\n  const tx = db.transaction(STORE_NAME, 'readwrite');\n  for (const story of stories) {\n    try {\n      await tx.store.put(story);\n    } catch (e) {\n      console.error('Failed to save story:', story, e);\n    }\n  }\n  await tx.done;\n}\n\nexport async function getAllStories() {\n  const db = await getDb();\n  return db.getAll(STORE_NAME);\n}\n\nexport async function getStoryById(id) {\n  const db = await getDb();\n  return db.get(STORE_NAME, id);\n}\n\nexport async function deleteStory(id) {\n  const db = await getDb();\n  return db.delete(STORE_NAME, id);\n}\n\nexport async function clearStories() {\n  const db = await getDb();\n  return db.clear(STORE_NAME);\n}\n\n// Favorites\nexport async function addToFavorites(story) {\n  if (!story || !story.id) return;\n  const db = await getDb();\n  await db.put(FAVORITES_STORE, story);\n}\n\nexport async function removeFromFavorites(id) {\n  const db = await getDb();\n  await db.delete(FAVORITES_STORE, id);\n}\n\nexport async function getFavorites() {\n  const db = await getDb();\n  return db.getAll(FAVORITES_STORE);\n}\n\nexport async function isFavorite(id) {\n  const db = await getDb();\n  const fav = await db.get(FAVORITES_STORE, id);\n  return !!fav;\n}\n\nexport async function clearFavorites() {\n  const db = await getDb();\n  return db.clear(FAVORITES_STORE);\n}\n\n// Utility: Sync stories/favorites (for future offline sync)\nexport async function bulkSaveFavorites(favorites) {\n  if (!Array.isArray(favorites)) return;\n  const db = await getDb();\n  const tx = db.transaction(FAVORITES_STORE, 'readwrite');\n  for (const fav of favorites) {\n    try {\n      await tx.store.put(fav);\n    } catch (e) {\n      console.error('Failed to save favorite:', fav, e);\n    }\n  }\n  await tx.done;\n}\n\nconst IdbHelper = {\n  saveStories,\n  getAllStories,\n  getStoryById,\n  deleteStory,\n  clearStories,\n  addToFavorites,\n  removeFromFavorites,\n  getFavorites,\n  isFavorite,\n  clearFavorites,\n  bulkSaveFavorites,\n};\n\nexport default IdbHelper;\n","import { showFormattedDate, truncateText, getInitials } from '../utils/index';\nimport CONFIG from '../config';\n// Tambahkan import IdbHelper\nimport IdbHelper from '../idb';\n\nclass AppCard extends HTMLElement {\n  set story(data) {\n    this._story = data;\n    this.render();\n  }\n\n  render() {\n    if (!this._story) return;\n\n    try {\n      const story = {\n        id: this._story.id || `unknown-${Date.now()}`,\n        name: this._story.name || 'Unknown User',\n        description: this._story.description || 'No description provided',\n        photoUrl: this._story.photoUrl || './images/placeholder.jpg',\n        createdAt: this._story.createdAt || new Date().toISOString(),\n        lat: this._story.lat,\n        lon: this._story.lon,\n      };\n\n      const formattedDate = showFormattedDate(story.createdAt, 'id-ID');\n      const titleId = `story-title-${story.id}`;\n      const descId = `story-desc-${story.id}`;\n      const userColor = getUserColor(story.name);\n\n      // Check if story is saved in favorites (localStorage)\n      let isSaved = false;\n      try {\n        const favoritesJson = localStorage.getItem('favoriteStories');\n        if (favoritesJson) {\n          const favorites = JSON.parse(favoritesJson);\n          isSaved = Array.isArray(favorites) && favorites.includes(story.id);\n        }\n      } catch {\n        isSaved = false;\n      }\n\n      this.innerHTML = `\n        <article class=\"story-item\" aria-labelledby=\"${titleId}\" aria-describedby=\"${descId}\">\n          <div class=\"story-image-container\">\n            <div class=\"story-badge\" style=\"background-color: ${userColor}\">\n              <i class=\"fas fa-camera\" aria-hidden=\"true\"></i>\n            </div>\n            <img \n              class=\"story-image\" \n              src=\"${story.photoUrl}\" \n              alt=\"Photo shared by ${story.name}\" \n              loading=\"lazy\"\n              onerror=\"this.src='./images/placeholder.jpg'\"\n            >\n          </div>\n          <div class=\"story-content\">\n            <div class=\"story-header\">\n              <div class=\"story-user\">\n                <div class=\"user-avatar\" aria-hidden=\"true\" style=\"background-color: ${userColor}\">\n                  ${getInitials(story.name)}\n                </div>\n                <div>\n                  <h3 class=\"story-name\" id=\"${titleId}\">${story.name}</h3>\n                  <time class=\"story-date\" datetime=\"${story.createdAt}\">\n                    <i class=\"far fa-calendar-alt\" aria-hidden=\"true\"></i> ${formattedDate}\n                  </time>\n                </div>\n              </div>\n              ${\n                story.lat && story.lon\n                  ? `<div class=\"story-location-badge\" title=\"Has location data\">\n                      <i class=\"fas fa-map-marker-alt\" aria-hidden=\"true\"></i>\n                    </div>`\n                  : ''\n              }\n            </div>\n            <p class=\"story-description\" id=\"${descId}\">${truncateText(story.description, 120)}</p>\n            ${\n              story.lat && story.lon\n                ? `<div class=\"story-map\" id=\"map-${story.id}\" aria-label=\"Location of story by ${story.name}\" tabindex=\"0\"></div>`\n                : ''\n            }\n            <div class=\"story-actions\">\n              <a href=\"#/stories/${story.id}\" class=\"story-link\" aria-label=\"Read full story by ${story.name}\">\n                <i class=\"fas fa-book-reader\" aria-hidden=\"true\"></i>\n                Read Full Story\n              </a>\n              <button \n                class=\"save-story-btn${isSaved ? ' saved' : ''}\" \n                aria-label=\"${isSaved ? 'Saved' : 'Save to favorites'}\"\n                title=\"${isSaved ? 'Saved' : 'Save to favorites'}\"\n              >\n                <i class=\"fas fa-bookmark\"></i>\n                <span>${isSaved ? 'Saved' : 'Save'}</span>\n              </button>\n            </div>\n          </div>\n        </article>\n      `;\n\n      // Save button logic\n      const saveBtn = this.querySelector('.save-story-btn');\n      if (saveBtn) {\n        saveBtn.addEventListener('click', async (e) => {\n          e.preventDefault();\n          let favorites = [];\n          try {\n            const favoritesJson = localStorage.getItem('favoriteStories');\n            favorites = favoritesJson ? JSON.parse(favoritesJson) : [];\n          } catch {\n            favorites = [];\n          }\n          const alreadySaved = favorites.includes(story.id);\n          if (!alreadySaved) {\n            favorites.push(story.id);\n            localStorage.setItem('favoriteStories', JSON.stringify(favorites));\n            saveBtn.classList.add('saved');\n            saveBtn.setAttribute('aria-label', 'Saved');\n            saveBtn.title = 'Saved';\n            saveBtn.querySelector('span').textContent = 'Saved';\n            // Tambahkan ke IndexedDB\n            try {\n              await IdbHelper.addToFavorites(story);\n            } catch (err) {\n              // Optional: tampilkan error jika gagal simpan ke IndexedDB\n              window.showToast?.('Gagal menyimpan ke database lokal', 'error');\n            }\n            window.showToast?.('Cerita disimpan ke Favorit!', 'success');\n          } else {\n            // Optional: allow unsave\n            favorites = favorites.filter((id) => id !== story.id);\n            localStorage.setItem('favoriteStories', JSON.stringify(favorites));\n            saveBtn.classList.remove('saved');\n            saveBtn.setAttribute('aria-label', 'Save to favorites');\n            saveBtn.title = 'Save to favorites';\n            saveBtn.querySelector('span').textContent = 'Save';\n            // Hapus dari IndexedDB\n            try {\n              await IdbHelper.removeFromFavorites(story.id);\n            } catch (err) {\n              window.showToast?.(\n                'Gagal menghapus dari database lokal',\n                'error'\n              );\n            }\n            window.showToast?.('Cerita dihapus dari Favorit', 'info');\n          }\n        });\n      }\n\n      // Render map if location exists\n      if (story.lat && story.lon) {\n        requestAnimationFrame(() => this.renderMap());\n      }\n    } catch (error) {\n      this.innerHTML = `\n        <article class=\"story-item\">\n          <div class=\"story-content\">\n            <div class=\"story-header\">\n              <div class=\"story-user\">\n                <div class=\"user-avatar\" style=\"background-color: #4361ee\">U</div>\n                <div>\n                  <h3 class=\"story-name\">Story data error</h3>\n                  <time class=\"story-date\">Unknown date</time>\n                </div>\n              </div>\n            </div>\n            <p class=\"story-description\">There was an error rendering this story. Please try refreshing the page.</p>\n            <div class=\"story-actions\">\n              <a href=\"#/\" class=\"story-link\">\n                <i class=\"fas fa-home\" aria-hidden=\"true\"></i>\n                Back to Home\n              </a>\n            </div>\n          </div>\n        </article>\n      `;\n    }\n  }\n\n  renderMap() {\n    try {\n      if (!this._story) return;\n      const lat = parseFloat(this._story.lat);\n      const lon = parseFloat(this._story.lon);\n      if (isNaN(lat) || isNaN(lon)) return;\n\n      const storyId = this._story.id || `unknown-${Date.now()}`;\n      const storyName = this._story.name || 'Unknown User';\n      const storyDescription = this._story.description || '';\n      const mapElement = this.querySelector(`#map-${storyId}`);\n      if (!mapElement || !window.L) return;\n\n      const map = L.map(mapElement, {\n        zoomControl: false,\n        dragging: false,\n        touchZoom: false,\n        scrollWheelZoom: false,\n        doubleClickZoom: false,\n        boxZoom: false,\n        keyboard: false,\n        attributionControl: false,\n      }).setView([lat, lon], 13);\n\n      L.tileLayer(CONFIG.MAP_TILE_LAYERS.osm.url, { maxZoom: 19 }).addTo(map);\n\n      const userColor = getUserColor(storyName);\n      const customIcon = L.divIcon({\n        html: `<div style=\"background-color: ${userColor}; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; box-shadow: 0 2px 5px rgba(0,0,0,0.3);\">\n                <i class=\"fas fa-map-marker-alt\"></i>\n              </div>`,\n        className: '',\n        iconSize: [30, 30],\n        iconAnchor: [15, 30],\n      });\n\n      L.marker([lat, lon], { icon: customIcon })\n        .addTo(map)\n        .bindPopup(\n          `<div class=\"map-popup\">\n            <b>${storyName}</b>\n            <p>${truncateText(storyDescription, 50)}...</p>\n            <a href=\"#/stories/${storyId}\" class=\"popup-link\">View Details</a>\n          </div>`,\n          { className: 'custom-popup', closeButton: false }\n        )\n        .openPopup();\n\n      map.on('click', () => {\n        window.location.hash = `#/stories/${storyId}`;\n      });\n\n      mapElement.addEventListener('keydown', (event) => {\n        if (event.key === 'Enter' || event.key === ' ') {\n          window.location.hash = `#/stories/${storyId}`;\n        }\n      });\n    } catch (error) {\n      // Silent fail for map\n    }\n  }\n\n  connectedCallback() {\n    try {\n      if (\n        'IntersectionObserver' in window &&\n        window.matchMedia('(prefers-reduced-motion: no-preference)').matches\n      ) {\n        const observer = new IntersectionObserver(\n          (entries) => {\n            entries.forEach((entry) => {\n              if (entry.isIntersecting) {\n                this.classList.add('visible');\n                observer.unobserve(this);\n              }\n            });\n          },\n          { threshold: 0.2 }\n        );\n        observer.observe(this);\n      } else {\n        this.classList.add('visible');\n      }\n    } catch {\n      this.classList.add('visible');\n    }\n  }\n}\n\ncustomElements.define('app-card', AppCard);\n\n// Helper functions\nfunction getUserColor(name) {\n  const colors = [\n    '#4361ee',\n    '#3f37c9',\n    '#4895ef',\n    '#4cc9f0',\n    '#f72585',\n    '#7209b7',\n    '#3a0ca3',\n    '#f8961e',\n    '#fb5607',\n    '#80b918',\n  ];\n  if (!name || typeof name !== 'string') return colors[0];\n  const hash = name\n    .split('')\n    .reduce((acc, char) => char.charCodeAt(0) + ((acc << 5) - acc), 0);\n  return colors[Math.abs(hash) % colors.length];\n}\n","import DicodingStoryApi from '../../data/api';\nimport { saveStories, getAllStories } from '../../idb';\n\nexport default class HomePresenter {\n  #view;\n  #page = 1;\n  #hasMoreData = true;\n  #isLoading = false;\n  #includeLocation = false;\n\n  constructor({ view }) {\n    this.#view = view;\n  }\n\n  async init() {\n    try {\n      this.#view.renderPage();\n      this.#setupEventListeners();\n      await this.#loadInitialStories();\n    } catch (error) {\n      console.error('Error in HomePresenter.init:', error);\n      this.#view.showError('Error initializing page. Please try refreshing.');\n    }\n  }\n\n  #setupEventListeners() {\n    this.#view.setLoadMoreCallback(() => this.#loadMoreStories());\n    this.#view.setLocationFilterCallback((isChecked) => {\n      this.#includeLocation = isChecked;\n      this.#page = 1;\n      this.#hasMoreData = true;\n      this.#loadInitialStories();\n    });\n  }\n\n  async #loadInitialStories() {\n    if (this.#isLoading) return;\n    this.#isLoading = true;\n    this.#page = 1;\n\n    try {\n      this.#view.clearStories();\n      this.#view.showLoading();\n\n      const token = localStorage.getItem('accessToken');\n      if (!token) {\n        this.#view.showLoginRequired();\n        return;\n      }\n\n      const response = await DicodingStoryApi.getAllStories({\n        token,\n        page: this.#page,\n        location: this.#includeLocation ? 1 : 0,\n      });\n\n      if (response.error) {\n        this.#view.showError(response.message || 'Gagal memuat cerita');\n        return;\n      }\n\n      if (!response || typeof response !== 'object') {\n        this.#view.showError('Format respons server tidak valid');\n        return;\n      }\n\n      const stories = response.listStory || [];\n      const size = response.size || 10;\n\n      if (!Array.isArray(stories)) {\n        this.#view.showError('Format data cerita tidak valid');\n        return;\n      }\n\n      if (stories.length === 0) {\n        this.#view.showEmptyState();\n        this.#hasMoreData = false;\n      } else {\n        await saveStories(stories);\n        this.#view.renderStories(stories);\n        this.#hasMoreData = stories.length === size;\n        this.#view.updateLoadMoreButton(this.#hasMoreData);\n      }\n    } catch (error) {\n      // Fallback: load from cache if fetch fails\n      const cachedStories = await getAllStories();\n      if (cachedStories && cachedStories.length > 0) {\n        this.#view.renderStories(cachedStories);\n        this.#view.showOfflineMessage();\n      } else {\n        this.#view.showError(error.message || 'Gagal memuat cerita');\n      }\n    } finally {\n      this.#isLoading = false;\n      this.#view.hideLoading();\n    }\n  }\n\n  async #loadMoreStories() {\n    if (this.#isLoading || !this.#hasMoreData) return;\n    this.#isLoading = true;\n    this.#page += 1;\n\n    try {\n      this.#view.showLoadingMore();\n\n      const token = localStorage.getItem('accessToken');\n      if (!token) {\n        this.#view.showLoginRequired();\n        return;\n      }\n\n      const response = await DicodingStoryApi.getAllStories({\n        token,\n        page: this.#page,\n        location: this.#includeLocation ? 1 : 0,\n      });\n\n      if (response.error) {\n        this.#view.showError(\n          response.message || 'Gagal memuat cerita tambahan'\n        );\n        return;\n      }\n\n      if (!response || typeof response !== 'object') {\n        this.#view.showError('Format respons server tidak valid');\n        return;\n      }\n\n      const stories = response.listStory || [];\n      const size = response.size || 10;\n\n      if (!Array.isArray(stories)) {\n        this.#view.showError('Format data cerita tidak valid');\n        return;\n      }\n\n      if (stories.length > 0) {\n        await saveStories(stories);\n        this.#view.appendStories(stories);\n        this.#hasMoreData = stories.length === size;\n      } else {\n        this.#hasMoreData = false;\n      }\n\n      this.#view.updateLoadMoreButton(this.#hasMoreData);\n    } catch (error) {\n      // Fallback: show offline message, but do not append duplicate stories\n      this.#view.showOfflineMessage();\n    } finally {\n      this.#isLoading = false;\n      this.#view.hideLoadingMore();\n    }\n  }\n}\n","import '../../components/header';\nimport '../../components/card';\nimport '../../components/loader';\nimport '../../components/footer';\nimport '../../components/sidebar';\nimport { debounce } from '../../utils/index';\nimport HomePresenter from './home-presenter';\n\nexport default class HomePage {\n  constructor() {\n    this._presenter = new HomePresenter({ view: this });\n    this._debouncedScroll = debounce(this._handleScroll.bind(this), 200);\n  }\n\n  renderPage() {\n    this._setupInfiniteScroll();\n    this._setupOfflineListener();\n  }\n\n  async render() {\n    return `\n      <app-sidebar></app-sidebar>\n      <app-header></app-header>\n      <main id=\"main-content\" class=\"main-content\" tabindex=\"-1\">\n        <section class=\"container\">\n          <h1 class=\"page-title\">\n            <i class=\"fas fa-book-open\" aria-hidden=\"true\"></i>\n            Latest Stories\n          </h1>\n          <div class=\"filter-container mb-2\">\n            <label for=\"include-location\" class=\"filter-label\">\n              <input type=\"checkbox\" id=\"include-location\" name=\"include-location\">\n              <span class=\"ml-1\">Show stories with location only</span>\n            </label>\n          </div>\n          <div id=\"stories-list\" class=\"stories-list\"></div>\n          <div id=\"loading-more\" class=\"hidden\">\n            <div class=\"spinner\" style=\"width: 30px; height: 30px; margin: 0 auto;\"></div>\n          </div>\n          <button id=\"load-more\" class=\"load-more\" aria-label=\"Load more stories\">\n            <i class=\"fas fa-arrow-down\" aria-hidden=\"true\"></i>\n            Load More\n          </button>\n          <div id=\"empty-state\" class=\"empty-state hidden\">\n            <i class=\"fas fa-inbox fa-3x\"></i>\n            <p>No stories found. Be the first to share your experience!</p>\n          </div>\n        </section>\n      </main>\n      <app-footer></app-footer>\n      <app-loader></app-loader>\n    `;\n  }\n\n  async afterRender() {\n    this._presenter.init();\n    this._setupAccessibility();\n  }\n\n  setLoadMoreCallback(callback) {\n    const loadMoreButton = document.getElementById('load-more');\n    if (loadMoreButton) {\n      loadMoreButton.addEventListener('click', callback);\n    }\n  }\n\n  setLocationFilterCallback(callback) {\n    const locationFilter = document.getElementById('include-location');\n    if (locationFilter) {\n      locationFilter.addEventListener('change', (event) => {\n        callback(event.target.checked);\n      });\n    }\n  }\n\n  _setupInfiniteScroll() {\n    window.addEventListener('scroll', this._debouncedScroll);\n  }\n\n  _handleScroll() {\n    const loadMoreButton = document.getElementById('load-more');\n    if (\n      !loadMoreButton ||\n      loadMoreButton.style.display === 'none' ||\n      loadMoreButton.disabled\n    ) {\n      return;\n    }\n    const scrollY = window.scrollY;\n    const visible = document.documentElement.clientHeight;\n    const pageHeight = document.documentElement.scrollHeight;\n    const bottomOfPage = visible + scrollY >= pageHeight - 100;\n    if (bottomOfPage) {\n      loadMoreButton.click();\n    }\n  }\n\n  _setupOfflineListener() {\n    window.addEventListener('online', () => {\n      this._presenter.init();\n    });\n  }\n\n  _setupAccessibility() {\n    // Fokus otomatis ke main content saat halaman dimuat\n    const mainContent = document.getElementById('main-content');\n    if (mainContent) setTimeout(() => mainContent.focus(), 200);\n\n    // Skip link support (aksesibilitas)\n    const skipLink = document.querySelector('.skip-link');\n    if (skipLink) {\n      skipLink.addEventListener('click', function (event) {\n        event.preventDefault();\n        if (mainContent) {\n          skipLink.blur();\n          mainContent.focus();\n          mainContent.scrollIntoView({ behavior: 'smooth' });\n        }\n      });\n    }\n  }\n\n  showLoading() {\n    document.querySelector('app-loader')?.show('Loading stories...');\n  }\n\n  hideLoading() {\n    document.querySelector('app-loader')?.hide();\n  }\n\n  showLoadingMore() {\n    document.getElementById('loading-more')?.classList.remove('hidden');\n  }\n\n  hideLoadingMore() {\n    document.getElementById('loading-more')?.classList.add('hidden');\n  }\n\n  clearStories() {\n    const storiesList = document.getElementById('stories-list');\n    if (storiesList) storiesList.innerHTML = '';\n    document.getElementById('empty-state')?.classList.add('hidden');\n  }\n\n  renderStories(stories) {\n    const storiesList = document.getElementById('stories-list');\n    if (!storiesList) return;\n    if (!stories || !Array.isArray(stories)) {\n      console.error('Invalid stories data:', stories);\n      return;\n    }\n    const validStories = stories.filter(\n      (story) => story && typeof story === 'object'\n    );\n    validStories.forEach((story, index) => {\n      try {\n        const card = document.createElement('app-card');\n        card.story = story;\n        storiesList.appendChild(card);\n        // Animasi masuk card\n        if (\n          window.matchMedia('(prefers-reduced-motion: no-preference)').matches\n        ) {\n          card.animate(\n            [\n              { opacity: 0, transform: 'translateY(20px)' },\n              { opacity: 1, transform: 'translateY(0)' },\n            ],\n            {\n              duration: 300,\n              easing: 'ease-out',\n              delay: index * 50,\n            }\n          );\n        }\n      } catch (error) {\n        console.error('Error rendering story card:', error, { story });\n      }\n    });\n  }\n\n  appendStories(stories) {\n    const storiesList = document.getElementById('stories-list');\n    if (!storiesList) return;\n    if (!stories || !Array.isArray(stories)) {\n      console.error('Invalid stories data:', stories);\n      return;\n    }\n    const validStories = stories.filter(\n      (story) => story && typeof story === 'object'\n    );\n    if (validStories.length === 0) {\n      console.warn('No valid stories to append');\n      return;\n    }\n    validStories.forEach((story, index) => {\n      try {\n        const card = document.createElement('app-card');\n        card.story = story;\n        storiesList.appendChild(card);\n        if (\n          window.matchMedia('(prefers-reduced-motion: no-preference)').matches\n        ) {\n          card.animate(\n            [\n              { opacity: 0, transform: 'translateY(20px)' },\n              { opacity: 1, transform: 'translateY(0)' },\n            ],\n            {\n              duration: 300,\n              easing: 'ease-out',\n              delay: index * 50,\n            }\n          );\n        }\n      } catch (error) {\n        console.error('Error appending story card:', error, { story });\n      }\n    });\n  }\n\n  updateLoadMoreButton(hasMore) {\n    const loadMoreButton = document.getElementById('load-more');\n    if (!loadMoreButton) return;\n    if (hasMore) {\n      loadMoreButton.style.display = 'flex';\n      loadMoreButton.disabled = false;\n    } else {\n      loadMoreButton.style.display = 'none';\n      loadMoreButton.disabled = true;\n    }\n  }\n\n  showEmptyState() {\n    document.getElementById('empty-state')?.classList.remove('hidden');\n    const loadMoreButton = document.getElementById('load-more');\n    if (loadMoreButton) loadMoreButton.style.display = 'none';\n  }\n\n  showLoginRequired() {\n    Swal.fire({\n      icon: 'warning',\n      title: 'Login Required',\n      text: 'You need to login to view stories',\n      confirmButtonText: 'Login Now',\n      confirmButtonColor: '#4361ee',\n    }).then((result) => {\n      if (result.isConfirmed) {\n        window.location.hash = '#/login';\n      }\n    });\n  }\n\n  showOfflineMessage() {\n    window.showToast &&\n      window.showToast(\n        'Anda sedang offline. Menampilkan data tersimpan.',\n        'info'\n      );\n  }\n\n  showError(message) {\n    Swal.fire({\n      icon: 'error',\n      title: 'Error',\n      text: message || 'Failed to load stories',\n      confirmButtonColor: '#4361ee',\n    });\n  }\n}\n","import '../../components/header';\nimport '../../components/footer';\nimport '../../components/loader';\nimport '../../components/sidebar';\n\nexport default class AboutPage {\n  async render() {\n    document.title = 'About - Dicoding Story';\n    return `\n      <app-sidebar></app-sidebar>\n      <app-header></app-header>\n      <main id=\"main-content\" class=\"main-content\" tabindex=\"-1\">\n        <section class=\"container\">\n          <h1 class=\"page-title\">\n            <i class=\"fas fa-info-circle\"></i>\n            About the App\n          </h1>\n          <div class=\"about-content\">\n            <div class=\"about-card\" id=\"about-app\">\n              <h2><i class=\"fas fa-book-open\"></i> Dicoding Story</h2>\n              <p>\n                <strong>Dicoding Story</strong> is a platform for sharing programming and technology \n                learning experiences. This app was created as a submission project \n                for Dicoding's <em>Menjadi Front-End Web Developer Expert</em> class.\n              </p>\n              <p class=\"mt-2\">\n                The application allows users to share their learning journey with others,\n                add location to their stories, and explore stories from other learners.\n              </p>\n            </div>\n            <div class=\"about-card\" id=\"about-features\">\n              <h2><i class=\"fas fa-feather-alt\"></i> Features</h2>\n              <ul class=\"feature-list\">\n                <li><i class=\"fas fa-check-circle\"></i> Share stories with images</li>\n                <li><i class=\"fas fa-check-circle\"></i> Add location to stories with interactive maps</li>\n                <li><i class=\"fas fa-check-circle\"></i> View stories from other users</li>\n                <li><i class=\"fas fa-check-circle\"></i> Responsive design for all devices</li>\n                <li><i class=\"fas fa-check-circle\"></i> Offline capability with cached data</li>\n                <li><i class=\"fas fa-check-circle\"></i> Push notifications for new features</li>\n                <li><i class=\"fas fa-check-circle\"></i> PWA: Installable & works offline</li>\n                <li><i class=\"fas fa-check-circle\"></i> Accessibility & dark mode support</li>\n                <li><i class=\"fas fa-check-circle\"></i> Modern UI/UX with animations</li>\n                <li><i class=\"fas fa-check-circle\"></i> Favorite & save stories for offline</li>\n              </ul>\n            </div>\n            <div class=\"about-card\" id=\"about-tech\">\n              <h2><i class=\"fas fa-code\"></i> Technology Stack</h2>\n              <div class=\"tech-stack\">\n                <div class=\"tech-item\"><i class=\"fab fa-html5\"></i><span>HTML5</span></div>\n                <div class=\"tech-item\"><i class=\"fab fa-css3-alt\"></i><span>CSS3</span></div>\n                <div class=\"tech-item\"><i class=\"fab fa-js\"></i><span>JavaScript</span></div>\n                <div class=\"tech-item\"><i class=\"fas fa-map-marked-alt\"></i><span>Leaflet.js</span></div>\n                <div class=\"tech-item\"><i class=\"fas fa-mobile-alt\"></i><span>PWA</span></div>\n                <div class=\"tech-item\"><i class=\"fas fa-server\"></i><span>REST API</span></div>\n                <div class=\"tech-item\"><i class=\"fas fa-database\"></i><span>IndexedDB</span></div>\n                <div class=\"tech-item\"><i class=\"fas fa-bolt\"></i><span>Service Worker</span></div>\n                <div class=\"tech-item\"><i class=\"fas fa-bell\"></i><span>Push Notification</span></div>\n                <div class=\"tech-item\"><i class=\"fas fa-paint-brush\"></i><span>Animate.css</span></div>\n                <div class=\"tech-item\"><i class=\"fas fa-universal-access\"></i><span>A11y</span></div>\n              </div>\n            </div>\n            <div class=\"about-card\" id=\"about-developer\">\n              <h2><i class=\"fas fa-user-tie\"></i> About Developer</h2>\n              <p>\n                This application was developed by <strong>Naufal Arsyaputra Pradana</strong> \n                as part of the submission for Dicoding's Front-End Web Developer Expert class.\n              </p>\n              <div class=\"tech-stack mt-2\">\n                <div class=\"tech-item\">\n                  <a href=\"https://github.com/NaufalArsyaputraPradana/\" target=\"_blank\" rel=\"noopener noreferrer\">\n                    <i class=\"fab fa-github\"></i>\n                    <span>GitHub</span>\n                  </a>\n                </div>\n                <div class=\"tech-item\">\n                  <a href=\"https://www.linkedin.com/in/naufalarsyaputrapradana/\" target=\"_blank\" rel=\"noopener noreferrer\">\n                    <i class=\"fab fa-linkedin\"></i>\n                    <span>LinkedIn</span>\n                  </a>\n                </div>\n                <div class=\"tech-item\">\n                  <a href=\"https://www.instagram.com/arsya.pradana_/\" target=\"_blank\" rel=\"noopener noreferrer\">\n                    <i class=\"fab fa-instagram\"></i>\n                    <span>Instagram</span>\n                  </a>\n                </div>\n              </div>\n              <div class=\"mt-2\">\n                <a href=\"mailto:support@dicodingstory.app\" class=\"btn btn-secondary\" aria-label=\"Contact Support\">\n                  <i class=\"fas fa-envelope\"></i> Contact Support\n                </a>\n                <a href=\"https://github.com/naufalarsyaputrapradana/Dicoding-Story-App/issues\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"btn btn-primary ml-2\" aria-label=\"Feedback & Issues\">\n                  <i class=\"fas fa-comment-dots\"></i> Feedback & Issues\n                </a>\n              </div>\n            </div>\n          </div>\n        </section>\n      </main>\n      <app-footer></app-footer>\n    `;\n  }\n\n  async afterRender() {\n    // Animate about cards (aksesibilitas & UX)\n    if (window.matchMedia('(prefers-reduced-motion: no-preference)').matches) {\n      const cards = [\n        document.getElementById('about-app'),\n        document.getElementById('about-features'),\n        document.getElementById('about-tech'),\n        document.getElementById('about-developer'),\n      ];\n      cards.forEach((card, index) => {\n        if (card) {\n          card.style.opacity = '0';\n          card.style.transform = 'translateY(20px)';\n          card.style.transition = 'opacity 0.3s, transform 0.3s';\n          setTimeout(\n            () => {\n              card.style.opacity = '1';\n              card.style.transform = 'translateY(0)';\n            },\n            index * 100 + 300\n          );\n        }\n      });\n    }\n\n    // Fokus otomatis ke main content untuk aksesibilitas\n    const mainContent = document.getElementById('main-content');\n    if (mainContent) setTimeout(() => mainContent.focus(), 200);\n  }\n}\n","import DicodingStoryApi from '../../../data/api';\nimport '../../../components/header';\nimport '../../../components/loader';\nimport '../../../components/footer';\nimport '../../../components/sidebar';\nimport { validateEmail, isOnline } from '../../../utils/index';\n\nexport default class LoginPage {\n  async render() {\n    return `\n      <app-sidebar></app-sidebar>\n      <app-header></app-header>\n      <main id=\"main-content\" class=\"main-content\" tabindex=\"-1\">\n        <section class=\"auth-container\">\n          <h1 class=\"auth-title\">\n            <i class=\"fas fa-sign-in-alt\"></i>\n            Login\n          </h1>\n          <form id=\"login-form\" class=\"auth-form\" novalidate autocomplete=\"on\">\n            <div class=\"auth-form-group\">\n              <label for=\"email\">Email</label>\n              <input \n                type=\"email\" \n                id=\"email\" \n                name=\"email\" \n                required\n                placeholder=\"Enter your email\"\n                aria-describedby=\"email-help\"\n                autocomplete=\"username\"\n              >\n              <small id=\"email-help\" class=\"text-muted\">Enter a valid email address</small>\n              <div class=\"error-message\" id=\"email-error\"></div>\n            </div>\n            <div class=\"auth-form-group\">\n              <label for=\"password\">Password</label>\n              <input \n                type=\"password\" \n                id=\"password\" \n                name=\"password\" \n                required \n                minlength=\"8\"\n                placeholder=\"Enter your password\"\n                aria-describedby=\"password-help\"\n                autocomplete=\"current-password\"\n              >\n              <small id=\"password-help\" class=\"text-muted\">Minimum 8 characters</small>\n              <div class=\"error-message\" id=\"password-error\"></div>\n            </div>\n            <button type=\"submit\" class=\"auth-submit-button\">\n              <i class=\"fas fa-sign-in-alt\"></i>\n              Login\n            </button>\n            <div class=\"flex items-center mt-2\">\n              <input type=\"checkbox\" id=\"remember-me\" name=\"remember-me\">\n              <label for=\"remember-me\" class=\"ml-2\">Remember me</label>\n            </div>\n          </form>\n          <div class=\"auth-link\">\n            Don't have an account? <a href=\"#/register\">Register here</a>\n          </div>\n          ${\n            !isOnline()\n              ? `\n            <div class=\"offline-notice mt-2\">\n              <i class=\"fas fa-wifi-slash\"></i> You are currently offline. \n              Login is not available without internet connection.\n            </div>\n          `\n              : ''\n          }\n        </section>\n      </main>\n      <app-footer></app-footer>\n      <app-loader></app-loader>\n    `;\n  }\n\n  async afterRender() {\n    this._setupForm();\n    this._setupInputValidation();\n    this._checkRememberedUser();\n    this._focusFirstInput();\n  }\n\n  _setupForm() {\n    const form = document.querySelector('#login-form');\n    if (!form) return;\n\n    form.addEventListener('submit', async (event) => {\n      event.preventDefault();\n\n      if (!this._validateForm()) return;\n      if (!isOnline()) {\n        Swal.fire({\n          icon: 'error',\n          title: 'Offline Mode',\n          text: 'Login is not available without internet connection.',\n          confirmButtonColor: '#4361ee',\n        });\n        return;\n      }\n\n      const email = form.querySelector('#email').value.trim();\n      const password = form.querySelector('#password').value.trim();\n      const rememberMe = form.querySelector('#remember-me').checked;\n\n      const loader = document.querySelector('app-loader');\n      if (loader) loader.show('Authenticating...');\n\n      try {\n        const response = await DicodingStoryApi.login({ email, password });\n\n        localStorage.setItem('accessToken', response.loginResult.token);\n        localStorage.setItem('user', JSON.stringify(response.loginResult.user));\n\n        // Trigger sidebar and header update\n        window.dispatchEvent(\n          new CustomEvent('user-login-state-changed', {\n            detail: { isLoggedIn: true, userData: response.loginResult.user },\n          })\n        );\n\n        if (rememberMe) {\n          localStorage.setItem('rememberedEmail', email);\n        } else {\n          localStorage.removeItem('rememberedEmail');\n        }\n\n        await Swal.fire({\n          icon: 'success',\n          title: 'Login successful!',\n          showConfirmButton: false,\n          timer: 1500,\n        });\n\n        window.location.hash = '#/';\n      } catch (error) {\n        console.error('Login failed:', error);\n        Swal.fire({\n          icon: 'error',\n          title: 'Login failed',\n          text: error.message || 'Invalid email or password',\n          confirmButtonColor: '#4361ee',\n        });\n      } finally {\n        if (loader) loader.hide();\n      }\n    });\n  }\n\n  _setupInputValidation() {\n    const emailInput = document.querySelector('#email');\n    const passwordInput = document.querySelector('#password');\n\n    if (emailInput) {\n      emailInput.addEventListener('input', () => {\n        this._validateEmail();\n      });\n    }\n\n    if (passwordInput) {\n      passwordInput.addEventListener('input', () => {\n        this._validatePassword();\n      });\n    }\n  }\n\n  _validateForm() {\n    const isEmailValid = this._validateEmail();\n    const isPasswordValid = this._validatePassword();\n    return isEmailValid && isPasswordValid;\n  }\n\n  _validateEmail() {\n    const emailInput = document.querySelector('#email');\n    const errorElement = document.querySelector('#email-error');\n\n    if (!emailInput || !errorElement) return false;\n\n    const email = emailInput.value.trim();\n\n    if (!email) {\n      errorElement.textContent = 'Email is required';\n      return false;\n    }\n\n    if (!validateEmail(email)) {\n      errorElement.textContent = 'Please enter a valid email address';\n      return false;\n    }\n\n    errorElement.textContent = '';\n    return true;\n  }\n\n  _validatePassword() {\n    const passwordInput = document.querySelector('#password');\n    const errorElement = document.querySelector('#password-error');\n\n    if (!passwordInput || !errorElement) return false;\n\n    const password = passwordInput.value.trim();\n\n    if (!password) {\n      errorElement.textContent = 'Password is required';\n      return false;\n    }\n\n    if (password.length < 8) {\n      errorElement.textContent = 'Password must be at least 8 characters';\n      return false;\n    }\n\n    errorElement.textContent = '';\n    return true;\n  }\n\n  _checkRememberedUser() {\n    const rememberedEmail = localStorage.getItem('rememberedEmail');\n    const emailInput = document.querySelector('#email');\n    const rememberCheckbox = document.querySelector('#remember-me');\n\n    if (rememberedEmail && emailInput) {\n      emailInput.value = rememberedEmail;\n      if (rememberCheckbox) {\n        rememberCheckbox.checked = true;\n      }\n      document.querySelector('#password').focus();\n    }\n  }\n\n  _focusFirstInput() {\n    // Aksesibilitas: fokus otomatis ke input email saat halaman login\n    const emailInput = document.querySelector('#email');\n    if (emailInput) setTimeout(() => emailInput.focus(), 200);\n  }\n}\n","import DicodingStoryApi from '../../../data/api';\nimport '../../../components/header';\nimport '../../../components/loader';\nimport '../../../components/footer';\nimport '../../../components/sidebar';\nimport { validateEmail, isOnline } from '../../../utils/index';\n\nexport default class RegisterPage {\n  async render() {\n    return `\n      <app-sidebar></app-sidebar>\n      <app-header></app-header>\n      <main id=\"main-content\" class=\"main-content\" tabindex=\"-1\">\n        <section class=\"auth-container\">\n          <h1 class=\"auth-title\">\n            <i class=\"fas fa-user-plus\"></i>\n            Register\n          </h1>\n          <form id=\"register-form\" class=\"auth-form\" novalidate autocomplete=\"on\">\n            <div class=\"auth-form-group\">\n              <label for=\"name\">Full Name</label>\n              <input \n                type=\"text\" \n                id=\"name\" \n                name=\"name\" \n                required\n                minlength=\"3\"\n                placeholder=\"Enter your full name\"\n                aria-describedby=\"name-help\"\n                autocomplete=\"name\"\n              >\n              <small id=\"name-help\" class=\"text-muted\">Minimum 3 characters</small>\n              <div class=\"error-message\" id=\"name-error\"></div>\n            </div>\n            <div class=\"auth-form-group\">\n              <label for=\"email\">Email</label>\n              <input \n                type=\"email\" \n                id=\"email\" \n                name=\"email\" \n                required\n                placeholder=\"Enter your email\"\n                aria-describedby=\"email-help\"\n                autocomplete=\"username\"\n              >\n              <small id=\"email-help\" class=\"text-muted\">Enter a valid email address</small>\n              <div class=\"error-message\" id=\"email-error\"></div>\n            </div>\n            <div class=\"auth-form-group\">\n              <label for=\"password\">Password</label>\n              <input \n                type=\"password\" \n                id=\"password\" \n                name=\"password\" \n                required \n                minlength=\"8\"\n                placeholder=\"Enter password (min 8 characters)\"\n                aria-describedby=\"password-help\"\n                autocomplete=\"new-password\"\n              >\n              <small id=\"password-help\" class=\"text-muted\">Minimum 8 characters</small>\n              <div class=\"error-message\" id=\"password-error\"></div>\n            </div>\n            <button type=\"submit\" class=\"auth-submit-button\">\n              <i class=\"fas fa-user-plus\"></i>\n              Register\n            </button>\n          </form>\n          <div class=\"auth-link\">\n            Already have an account? <a href=\"#/login\">Login here</a>\n          </div>\n          ${\n            !isOnline()\n              ? `\n            <div class=\"offline-notice mt-2\">\n              <i class=\"fas fa-wifi-slash\"></i> You are currently offline. \n              Registration is not available without internet connection.\n            </div>\n          `\n              : ''\n          }\n        </section>\n      </main>\n      <app-footer></app-footer>\n      <app-loader></app-loader>\n    `;\n  }\n\n  async afterRender() {\n    this._setupForm();\n    this._setupInputValidation();\n    this._focusFirstInput();\n  }\n\n  _setupForm() {\n    const form = document.querySelector('#register-form');\n    if (!form) return;\n\n    form.addEventListener('submit', async (event) => {\n      event.preventDefault();\n\n      if (!this._validateForm()) return;\n      if (!isOnline()) {\n        Swal.fire({\n          icon: 'error',\n          title: 'Offline Mode',\n          text: 'Registration is not available without internet connection.',\n          confirmButtonColor: '#4361ee',\n        });\n        return;\n      }\n\n      const name = form.querySelector('#name').value.trim();\n      const email = form.querySelector('#email').value.trim();\n      const password = form.querySelector('#password').value.trim();\n\n      const loader = document.querySelector('app-loader');\n      if (loader) loader.show('Creating account...');\n\n      try {\n        await DicodingStoryApi.register({ name, email, password });\n\n        await Swal.fire({\n          icon: 'success',\n          title: 'Registration successful!',\n          text: 'Please login with your new account',\n          confirmButtonColor: '#4361ee',\n        });\n\n        window.location.hash = '#/login';\n        form.reset();\n      } catch (error) {\n        Swal.fire({\n          icon: 'error',\n          title: 'Registration failed',\n          text: error.message || 'Email may already be registered',\n          confirmButtonColor: '#4361ee',\n        });\n      } finally {\n        if (loader) loader.hide();\n      }\n    });\n  }\n\n  _setupInputValidation() {\n    const nameInput = document.querySelector('#name');\n    const emailInput = document.querySelector('#email');\n    const passwordInput = document.querySelector('#password');\n\n    if (nameInput) {\n      nameInput.addEventListener('input', () => {\n        this._validateName();\n      });\n    }\n\n    if (emailInput) {\n      emailInput.addEventListener('input', () => {\n        this._validateEmail();\n      });\n    }\n\n    if (passwordInput) {\n      passwordInput.addEventListener('input', () => {\n        this._validatePassword();\n      });\n    }\n  }\n\n  _validateForm() {\n    const isNameValid = this._validateName();\n    const isEmailValid = this._validateEmail();\n    const isPasswordValid = this._validatePassword();\n    return isNameValid && isEmailValid && isPasswordValid;\n  }\n\n  _validateName() {\n    const nameInput = document.querySelector('#name');\n    const errorElement = document.querySelector('#name-error');\n\n    if (!nameInput || !errorElement) return false;\n\n    const name = nameInput.value.trim();\n\n    if (!name) {\n      errorElement.textContent = 'Name is required';\n      return false;\n    }\n\n    if (name.length < 3) {\n      errorElement.textContent = 'Name must be at least 3 characters';\n      return false;\n    }\n\n    errorElement.textContent = '';\n    return true;\n  }\n\n  _validateEmail() {\n    const emailInput = document.querySelector('#email');\n    const errorElement = document.querySelector('#email-error');\n\n    if (!emailInput || !errorElement) return false;\n\n    const email = emailInput.value.trim();\n\n    if (!email) {\n      errorElement.textContent = 'Email is required';\n      return false;\n    }\n\n    if (!validateEmail(email)) {\n      errorElement.textContent = 'Please enter a valid email address';\n      return false;\n    }\n\n    errorElement.textContent = '';\n    return true;\n  }\n\n  _validatePassword() {\n    const passwordInput = document.querySelector('#password');\n    const errorElement = document.querySelector('#password-error');\n\n    if (!passwordInput || !errorElement) return false;\n\n    const password = passwordInput.value.trim();\n\n    if (!password) {\n      errorElement.textContent = 'Password is required';\n      return false;\n    }\n\n    if (password.length < 8) {\n      errorElement.textContent = 'Password must be at least 8 characters';\n      return false;\n    }\n\n    errorElement.textContent = '';\n    return true;\n  }\n\n  _focusFirstInput() {\n    // Aksesibilitas: fokus otomatis ke input nama saat halaman register\n    const nameInput = document.querySelector('#name');\n    if (nameInput) setTimeout(() => nameInput.focus(), 200);\n  }\n}\n","import DicodingStoryApi from '../../data/api';\nimport { isOnline } from '../../utils/index';\n\nclass StoryDetailPresenter {\n  constructor({ view, id }) {\n    this._view = view;\n    this._id = id;\n    this._map = null;\n    this._story = null;\n    this._mapInitialized = false;\n  }\n\n  async init() {\n    this._view.renderPage();\n    await this._loadStoryDetail();\n    this._setupOnlineListener();\n    this._setupActions();\n  }\n\n  async _loadStoryDetail() {\n    try {\n      this._view.showLoading();\n      const token = localStorage.getItem('accessToken');\n      if (!token) {\n        this._view.showLoginRequired();\n        return;\n      }\n      const cachedStory = this._getCachedStory();\n      try {\n        const response = await DicodingStoryApi.getStoryDetail({\n          token,\n          id: this._id,\n        });\n        if (response.error)\n          throw new Error(response.message || 'Gagal memuat cerita');\n        this._story = response.story;\n        this._cacheStory(response.story);\n        this._view.renderStoryDetail(response.story);\n        this._view.hideOfflineMessage();\n        if (this._story.lat && this._story.lon) {\n          this._initMapWithDelay(300);\n        }\n      } catch (apiError) {\n        // Fallback to cache if API fails\n        if (cachedStory) {\n          this._story = cachedStory;\n          this._view.renderStoryDetail(cachedStory);\n          this._view.showOfflineMessage();\n          if (cachedStory.lat && cachedStory.lon && !this._mapInitialized) {\n            this._initMapWithDelay(300);\n          }\n        } else {\n          this._view.showError(apiError.message);\n        }\n      }\n    } catch (error) {\n      // Fallback to cache if unexpected error\n      const cachedStory = this._getCachedStory();\n      if (cachedStory) {\n        this._story = cachedStory;\n        this._view.renderStoryDetail(cachedStory);\n        this._view.showOfflineMessage();\n        if (cachedStory.lat && cachedStory.lon && !this._mapInitialized) {\n          this._initMapWithDelay(300);\n        }\n      } else {\n        this._view.showError('Terjadi kesalahan. Silakan coba lagi.');\n      }\n    } finally {\n      this._view.hideLoading();\n    }\n  }\n\n  _setupOnlineListener() {\n    window.addEventListener('online', () => {\n      if (!this._story) {\n        this._loadStoryDetail();\n      } else {\n        this._view.hideOfflineMessage();\n      }\n    });\n    window.addEventListener('offline', () => {\n      if (this._story) {\n        this._view.showOfflineMessage();\n      }\n    });\n  }\n\n  _initMapWithDelay(delay = 100) {\n    if (!window.L) {\n      console.error('Leaflet library not available');\n      return;\n    }\n    setTimeout(() => {\n      this._initMap();\n    }, delay);\n  }\n\n  _initMap() {\n    if (this._mapInitialized) return;\n    if (!this._story) return;\n    const lat = parseFloat(this._story.lat);\n    const lon = parseFloat(this._story.lon);\n    if (isNaN(lat) || isNaN(lon)) return;\n    const mapContainer = this._view.getMapContainer();\n    if (!mapContainer) return;\n    try {\n      this._map = L.map(mapContainer).setView([lat, lon], 13);\n      const baseMaps = this._createBaseMaps();\n      baseMaps['Street'].addTo(this._map);\n      L.control.layers(baseMaps, {}, { position: 'topright' }).addTo(this._map);\n      this._addStoryMarker();\n      this._addLocateControl();\n      this._updateMapSize();\n      this._mapInitialized = true;\n    } catch (error) {\n      this._view.showMapError();\n    }\n  }\n\n  _createBaseMaps() {\n    const baseMaps = {};\n    baseMaps['Street'] = L.tileLayer(\n      'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\n      {\n        attribution:\n          '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\n        maxZoom: 19,\n      }\n    );\n    baseMaps['Satellite'] = L.tileLayer(\n      'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}',\n      {\n        attribution:\n          'Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community',\n        maxZoom: 19,\n      }\n    );\n    baseMaps['Dark'] = L.tileLayer(\n      'https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png',\n      {\n        attribution:\n          '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors &copy; <a href=\"https://carto.com/attributions\">CARTO</a>',\n        maxZoom: 19,\n      }\n    );\n    baseMaps['Topographic'] = L.tileLayer(\n      'https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png',\n      {\n        attribution:\n          'Map data: &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors, <a href=\"http://viewfinderpanoramas.org\">SRTM</a> | Map style: &copy; <a href=\"https://opentopomap.org\">OpenTopoMap</a> (<a href=\"https://creativecommons.org/licenses/by-sa/3.0/\">CC-BY-SA</a>)',\n        maxZoom: 17,\n      }\n    );\n    return baseMaps;\n  }\n\n  _addStoryMarker() {\n    if (!this._map || !this._story) return;\n    const lat = parseFloat(this._story.lat);\n    const lon = parseFloat(this._story.lon);\n    if (isNaN(lat) || isNaN(lon)) return;\n    const name = this._story.name || 'Untitled Story';\n    const description = this._story.description || '';\n    const popup = `\n      <div class=\"custom-popup\">\n        <h3>${name}</h3>\n        <p>${description.substring(0, 100)}${description.length > 100 ? '...' : ''}</p>\n      </div>\n    `;\n    L.marker([lat, lon]).addTo(this._map).bindPopup(popup).openPopup();\n  }\n\n  _addLocateControl() {\n    if (!this._map) return;\n    L.control\n      .locate({\n        position: 'topright',\n        strings: { title: 'Show my location' },\n        locateOptions: { enableHighAccuracy: true },\n      })\n      .addTo(this._map);\n  }\n\n  _updateMapSize() {\n    if (!this._map) return;\n    setTimeout(() => {\n      this._map.invalidateSize();\n    }, 300);\n    window.addEventListener('resize', () => {\n      if (this._map) this._map.invalidateSize();\n    });\n  }\n\n  _cacheStory(story) {\n    try {\n      const cacheData = { ...story, cachedAt: new Date().toISOString() };\n      localStorage.setItem(`story_${story.id}`, JSON.stringify(cacheData));\n      const cachedStories = JSON.parse(\n        localStorage.getItem('cachedStories') || '[]'\n      );\n      const updatedCache = cachedStories.map((item) =>\n        item.id === story.id ? cacheData : item\n      );\n      if (!cachedStories.some((item) => item.id === story.id)) {\n        updatedCache.push(cacheData);\n      }\n      const limitedCache = updatedCache.slice(0, 50);\n      localStorage.setItem('cachedStories', JSON.stringify(limitedCache));\n    } catch (error) {\n      // silent\n    }\n  }\n\n  _getCachedStory() {\n    try {\n      const cachedStoryJson = localStorage.getItem(`story_${this._id}`);\n      if (cachedStoryJson) {\n        try {\n          const parsedStory = JSON.parse(cachedStoryJson);\n          if (!parsedStory || typeof parsedStory !== 'object') return null;\n          parsedStory.name = parsedStory.name || 'Unknown User';\n          parsedStory.description = parsedStory.description || '';\n          parsedStory.photoUrl =\n            parsedStory.photoUrl || './images/placeholder.jpg';\n          parsedStory.createdAt =\n            parsedStory.createdAt || new Date().toISOString();\n          return parsedStory;\n        } catch {\n          localStorage.removeItem(`story_${this._id}`);\n          return null;\n        }\n      }\n      const cachedStoriesJson = localStorage.getItem('cachedStories');\n      if (!cachedStoriesJson) return null;\n      try {\n        const cachedStories = JSON.parse(cachedStoriesJson);\n        if (!Array.isArray(cachedStories)) return null;\n        const foundStory = cachedStories.find(\n          (story) => story && story.id === this._id\n        );\n        if (!foundStory) return null;\n        foundStory.name = foundStory.name || 'Unknown User';\n        foundStory.description = foundStory.description || '';\n        foundStory.photoUrl = foundStory.photoUrl || './images/placeholder.jpg';\n        foundStory.createdAt = foundStory.createdAt || new Date().toISOString();\n        return foundStory;\n      } catch {\n        return null;\n      }\n    } catch {\n      return null;\n    }\n  }\n\n  _setupActions() {\n    if (navigator.share) {\n      this._view.showShareButton();\n      this._view.setShareButtonCallback(() => this._shareStory());\n    }\n    this._view.setFavoriteButtonCallback((isFavorite) => {\n      this._toggleFavorite(isFavorite);\n    });\n  }\n\n  async _shareStory() {\n    if (!this._story) return;\n    try {\n      const shareData = {\n        title: `Cerita dari ${this._story.name}`,\n        text: this._story.description,\n        url: window.location.href,\n      };\n      await navigator.share(shareData);\n      window.showToast &&\n        window.showToast('Cerita berhasil dibagikan!', 'success');\n    } catch (error) {\n      if (error.name !== 'AbortError') {\n        window.showToast &&\n          window.showToast('Gagal membagikan cerita', 'error');\n      }\n    }\n  }\n\n  _toggleFavorite(isFavorite) {\n    if (!this._story) return;\n    try {\n      const favoritesJson = localStorage.getItem('favoriteStories');\n      let favorites = favoritesJson ? JSON.parse(favoritesJson) : [];\n      if (isFavorite) {\n        if (!favorites.includes(this._story.id)) {\n          favorites.push(this._story.id);\n          window.showToast &&\n            window.showToast('Ditambahkan ke favorit!', 'success');\n        }\n      } else {\n        favorites = favorites.filter((id) => id !== this._story.id);\n        window.showToast && window.showToast('Dihapus dari favorit', 'info');\n      }\n      localStorage.setItem('favoriteStories', JSON.stringify(favorites));\n    } catch (error) {\n      // silent\n    }\n  }\n\n  async saveCurrentStoryToOffline() {\n    if (this._story) {\n      // Optionally, implement saving to IndexedDB for offline use\n      window.showToast &&\n        window.showToast('Cerita disimpan untuk offline', 'success');\n    }\n  }\n}\n\nexport default StoryDetailPresenter;\n","import '../../components/header';\nimport '../../components/loader';\nimport '../../components/footer';\nimport '../../components/sidebar';\nimport { showFormattedDate } from '../../utils/index';\nimport StoryDetailPresenter from './story-detail-presenter';\nimport IdbHelper from '../../idb';\n\nexport default class StoryDetailPage {\n  constructor() {\n    const { id } = this._getUrlParams();\n    this._id = id;\n    this._presenter = new StoryDetailPresenter({\n      view: this,\n      id: this._id,\n    });\n    this._mapContainer = null;\n    this._favoriteCallback = null;\n    this._story = null;\n  }\n\n  renderPage() {\n    if (!this._id) {\n      this.showInvalidIdError();\n      return;\n    }\n  }\n\n  async render() {\n    return `\n      <app-sidebar></app-sidebar>\n      <app-header></app-header>\n      <main id=\"main-content\" class=\"main-content\" tabindex=\"-1\">\n        <section class=\"container\">\n          <div id=\"story-content\">\n            <div class=\"loading-placeholder\">\n              <div class=\"ph-item\">\n                <div class=\"ph-col-12\">\n                  <div class=\"ph-picture\"></div>\n                  <div class=\"ph-row\">\n                    <div class=\"ph-col-4\"></div>\n                    <div class=\"ph-col-8 empty\"></div>\n                    <div class=\"ph-col-6\"></div>\n                    <div class=\"ph-col-6 empty\"></div>\n                    <div class=\"ph-col-12\"></div>\n                    <div class=\"ph-col-12\"></div>\n                    <div class=\"ph-col-12\"></div>\n                    <div class=\"ph-col-8\"></div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div id=\"offline-notice\" class=\"offline-notice mt-2 hidden\">\n            <i class=\"fas fa-wifi-slash\"></i> You are currently offline. Some features may be limited.\n          </div>\n        </section>\n      </main>\n      <app-footer></app-footer>\n      <app-loader></app-loader>\n    `;\n  }\n\n  async afterRender() {\n    this._presenter.init();\n\n    // Save to favorites (fallback if presenter doesn't handle)\n    const saveBtn = document.getElementById('save-story-button');\n    if (saveBtn && this._story) {\n      saveBtn.addEventListener('click', async () => {\n        await IdbHelper.addToFavorites(this._story);\n        window.showToast &&\n          window.showToast('Cerita disimpan ke halaman Favorit!', 'success');\n      });\n    }\n  }\n\n  renderStoryDetail(story) {\n    this._story = story;\n    const storyContent = document.querySelector('#story-content');\n    if (!story || !storyContent) return;\n\n    const storyName = story.name || 'Unknown User';\n    const storyDescription = story.description || 'No description provided';\n    const storyPhoto = story.photoUrl || './images/placeholder.jpg';\n    const storyCreatedAt = story.createdAt || new Date().toISOString();\n\n    const formattedDate = showFormattedDate(storyCreatedAt, 'id-ID', {\n      weekday: 'long',\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit',\n    });\n\n    const userColor = this._getUserColor(storyName);\n    const storyTitleId = `story-title-${story.id}`;\n    const storyDescId = `story-desc-${story.id}`;\n    const isFavorite = this._isInFavorites(story.id);\n\n    storyContent.innerHTML = `\n      <article class=\"story-detail-item\" id=\"story-article\" aria-labelledby=\"${storyTitleId}\">\n        <div class=\"story-image-wrapper\">\n          <img \n            class=\"story-detail-image\" \n            src=\"${storyPhoto}\" \n            alt=\"Photo shared by ${storyName}\" \n            loading=\"lazy\"\n            onerror=\"this.src='./images/placeholder.jpg'\"\n          >\n          <div class=\"story-image-overlay\">\n            <div class=\"story-image-badge\" style=\"background-color: ${userColor}\">\n              <i class=\"fas fa-camera-retro\" aria-hidden=\"true\"></i>\n            </div>\n          </div>\n        </div>\n        <div class=\"story-detail-content\">\n          <div class=\"story-header\">\n            <div class=\"story-user\">\n              <div class=\"user-avatar\" aria-hidden=\"true\" style=\"background-color: ${userColor}\">\n                ${this._getInitials(storyName)}\n              </div>\n              <div>\n                <h1 class=\"story-name\" id=\"${storyTitleId}\">${storyName}</h1>\n                <time class=\"story-date\" datetime=\"${storyCreatedAt}\">\n                  <i class=\"far fa-calendar-alt\" aria-hidden=\"true\"></i> ${formattedDate}\n                </time>\n              </div>\n            </div>\n            <div class=\"story-actions-top\">\n              <button id=\"share-button\" class=\"icon-button hidden\" aria-label=\"Share this story\">\n                <i class=\"fas fa-share-alt\" aria-hidden=\"true\"></i>\n              </button>\n            </div>\n          </div>\n          <div class=\"story-body\">\n            <p class=\"story-description\" id=\"${storyDescId}\">${storyDescription}</p>\n          </div>\n          ${\n            story.lat && story.lon\n              ? `\n                <div class=\"story-location\">\n                  <h2 class=\"section-title\">\n                    <i class=\"fas fa-map-marker-alt\" aria-hidden=\"true\"></i>\n                    Location\n                  </h2>\n                  <div class=\"story-map-container\">\n                    <div class=\"story-map-large\" id=\"detail-map\" tabindex=\"0\" aria-label=\"Map showing the location of ${storyName}'s story\"></div>\n                  </div>\n                  <p class=\"map-instructions\">\n                    <i class=\"fas fa-info-circle\" aria-hidden=\"true\"></i>\n                    You can switch between different map styles using the layer control in the top right.\n                  </p>\n                </div>\n              `\n              : ''\n          }\n          <div class=\"story-actions mt-3\">\n            <a href=\"#/\" class=\"back-link\" aria-label=\"Back to stories list\">\n              <i class=\"fas fa-arrow-left\" aria-hidden=\"true\"></i>\n              Back to Stories\n            </a>\n            <a href=\"#/stories/add\" class=\"action-button\" aria-label=\"Share your own story\">\n              <i class=\"fas fa-plus-circle\"></i>\n              Share Your Story\n            </a>\n          </div>\n        </div>\n      </article>\n    `;\n\n    if (story.lat && story.lon) {\n      this._mapContainer = document.getElementById('detail-map');\n    }\n\n    this._setupFavoriteButton(isFavorite);\n\n    // Tampilkan tombol share jika Web Share API tersedia\n    if (navigator.share) {\n      this.showShareButton();\n      this.setShareButtonCallback(async () => {\n        try {\n          await navigator.share({\n            title: `Cerita dari ${storyName}`,\n            text: storyDescription,\n            url: window.location.href,\n          });\n          window.showToast &&\n            window.showToast('Cerita berhasil dibagikan!', 'success');\n        } catch (error) {\n          if (error.name !== 'AbortError') {\n            window.showToast &&\n              window.showToast('Gagal membagikan cerita', 'error');\n          }\n        }\n      });\n    }\n  }\n\n  getMapContainer() {\n    return this._mapContainer;\n  }\n\n  showLoading() {\n    document.querySelector('app-loader')?.show('Loading story...');\n  }\n\n  hideLoading() {\n    document.querySelector('app-loader')?.hide();\n  }\n\n  showOfflineMessage() {\n    document.getElementById('offline-notice')?.classList.remove('hidden');\n  }\n\n  hideOfflineMessage() {\n    document.getElementById('offline-notice')?.classList.add('hidden');\n  }\n\n  showOfflineNoDataMessage() {\n    Swal.fire({\n      icon: 'warning',\n      title: 'Offline',\n      text: 'This story is not available offline. Please connect to the internet and try again.',\n      confirmButtonColor: '#4361ee',\n    }).then(() => {\n      window.location.hash = '#/';\n    });\n  }\n\n  showLoginRequired() {\n    Swal.fire({\n      icon: 'warning',\n      title: 'Login Required',\n      text: 'Please login to view story details',\n      confirmButtonText: 'Login Now',\n      confirmButtonColor: '#4361ee',\n    }).then(() => {\n      window.location.hash = '#/login';\n    });\n  }\n\n  showInvalidIdError() {\n    Swal.fire({\n      icon: 'error',\n      title: 'Invalid Story ID',\n      text: 'The story ID is missing or invalid',\n      confirmButtonColor: '#4361ee',\n    }).then(() => {\n      window.location.hash = '#/';\n    });\n  }\n\n  showError(message) {\n    Swal.fire({\n      icon: 'error',\n      title: 'Error',\n      text: message || 'Failed to load story',\n      confirmButtonColor: '#4361ee',\n    }).then(() => {\n      window.location.hash = '#/';\n    });\n  }\n\n  showTimeoutError() {\n    const offlineNotice = document.getElementById('offline-notice');\n    if (offlineNotice) {\n      offlineNotice.innerHTML = `\n        <i class=\"fas fa-exclamation-triangle\"></i> \n        Server response is slow. Showing cached data if available.\n      `;\n      offlineNotice.classList.remove('hidden');\n      offlineNotice.style.backgroundColor = '#f8961e';\n    }\n    Swal.fire({\n      icon: 'warning',\n      title: 'Connection Issue',\n      text: \"The server is taking too long to respond. We'll try to show cached data if available.\",\n      confirmButtonColor: '#4361ee',\n      showCancelButton: true,\n      cancelButtonText: 'Back to Home',\n      confirmButtonText: 'Continue with Cache',\n    }).then((result) => {\n      if (!result.isConfirmed) {\n        window.location.hash = '#/';\n      }\n    });\n  }\n\n  showMapError() {\n    const mapContainer = document.querySelector('.story-map-container');\n    if (mapContainer) {\n      mapContainer.innerHTML = `\n        <div class=\"map-error-container\">\n          <div class=\"map-error-message\">\n            <i class=\"fas fa-map-marked-alt\"></i>\n            <p>Failed to load map. Please try refreshing the page.</p>\n          </div>\n        </div>\n      `;\n    }\n  }\n\n  _getUrlParams() {\n    const hash = window.location.hash;\n    const match = hash.match(/#\\/stories\\/([^/]+)$/);\n    return { id: match ? match[1] : null };\n  }\n\n  _getInitials(name) {\n    if (!name || typeof name !== 'string') return 'U';\n    return name\n      .split(' ')\n      .map((part) => part.charAt(0))\n      .join('')\n      .toUpperCase()\n      .substring(0, 2);\n  }\n\n  _getUserColor(name) {\n    const colors = [\n      '#4361ee',\n      '#3f37c9',\n      '#4895ef',\n      '#4cc9f0',\n      '#f72585',\n      '#7209b7',\n      '#3a0ca3',\n      '#f8961e',\n      '#fb5607',\n      '#80b918',\n    ];\n    const hash = name\n      .split('')\n      .reduce((acc, char) => char.charCodeAt(0) + ((acc << 5) - acc), 0);\n    return colors[Math.abs(hash) % colors.length];\n  }\n\n  _isInFavorites(storyId) {\n    try {\n      const favoritesJson = localStorage.getItem('favoriteStories');\n      if (!favoritesJson) return false;\n      const favorites = JSON.parse(favoritesJson);\n      return Array.isArray(favorites) && favorites.includes(storyId);\n    } catch (error) {\n      console.error('Error checking favorites:', error);\n      return false;\n    }\n  }\n\n  _setupFavoriteButton(initialState) {\n    const favoriteButton = document.getElementById('favorite-button');\n    if (!favoriteButton) return;\n    favoriteButton.addEventListener('click', () => {\n      const currentState = favoriteButton.classList.contains('active');\n      const newState = !currentState;\n      if (newState) {\n        favoriteButton.classList.add('active');\n        favoriteButton.setAttribute('aria-label', 'Remove from favorites');\n      } else {\n        favoriteButton.classList.remove('active');\n        favoriteButton.setAttribute('aria-label', 'Add to favorites');\n      }\n      if (this._favoriteCallback) {\n        this._favoriteCallback(newState);\n      }\n      // Simpan ke localStorage\n      try {\n        const favoritesJson = localStorage.getItem('favoriteStories');\n        let favorites = favoritesJson ? JSON.parse(favoritesJson) : [];\n        if (newState) {\n          if (!favorites.includes(this._story.id)) {\n            favorites.push(this._story.id);\n            window.showToast &&\n              window.showToast('Ditambahkan ke favorit!', 'success');\n          }\n        } else {\n          favorites = favorites.filter((id) => id !== this._story.id);\n          window.showToast && window.showToast('Dihapus dari favorit', 'info');\n        }\n        localStorage.setItem('favoriteStories', JSON.stringify(favorites));\n      } catch (error) {\n        console.error('Error updating favorites:', error);\n      }\n    });\n  }\n\n  setFavoriteButtonCallback(callback) {\n    this._favoriteCallback = callback;\n  }\n\n  showShareButton() {\n    document.getElementById('share-button')?.classList.remove('hidden');\n  }\n\n  setShareButtonCallback(callback) {\n    const shareButton = document.getElementById('share-button');\n    if (shareButton) {\n      shareButton.addEventListener('click', callback);\n    }\n  }\n\n  animateRemoval(callback) {\n    const article = document.getElementById('story-article');\n    if (!article) {\n      if (callback) callback();\n      return;\n    }\n    article.style.transition = 'all 0.5s ease-out';\n    article.style.opacity = '0';\n    article.style.transform = 'scale(0.9)';\n    setTimeout(() => {\n      if (callback) callback();\n    }, 500);\n  }\n\n  cancelRemovalAnimation() {\n    const article = document.getElementById('story-article');\n    if (!article) return;\n    article.style.opacity = '1';\n    article.style.transform = 'scale(1)';\n  }\n}\n","import DicodingStoryApi from '../../data/api';\nimport CONFIG from '../../config';\nimport { formatFileSize } from '../../utils/index';\n\nexport default class AddPresenter {\n  #view;\n  _photoFile = null;\n  _map = null;\n  _marker = null;\n  _cameraStream = null;\n  _mapInitialized = false;\n\n  constructor({ view }) {\n    this.#view = view;\n    window.addEventListener('hashchange', () => this.stopCamera());\n    window.addEventListener('beforeunload', () => this.stopCamera());\n  }\n\n  init() {\n    this._setupForm();\n    this._setupPhotoPreview();\n    this._setupCamera();\n    this._setupLocationCheckbox();\n    this._setupInputValidation();\n    this._setupAutoSaveDraft();\n    this._checkMediaPermissions();\n  }\n\n  // Drafts\n  loadRecentDrafts() {\n    try {\n      const recentsJson = localStorage.getItem('recentDrafts');\n      if (!recentsJson) {\n        this.#view.displayRecentDrafts([]);\n        return;\n      }\n      const recents = JSON.parse(recentsJson);\n      this.#view.displayRecentDrafts(recents);\n    } catch (error) {\n      console.error('Error loading recent drafts:', error);\n      this.#view.displayRecentDrafts([]);\n    }\n  }\n\n  useDraft(draftId) {\n    try {\n      const recentsJson = localStorage.getItem('recentDrafts');\n      if (!recentsJson) return;\n      const recents = JSON.parse(recentsJson);\n      const draft = recents.find((d) => d.id === draftId);\n      if (draft) {\n        let description = draft.fullDescription || draft.description;\n        this.#view.applyDraftToForm(description);\n      }\n    } catch (error) {\n      console.error('Error using draft:', error);\n    }\n  }\n\n  _setupAutoSaveDraft() {\n    let draftTimeout;\n    const descriptionInput = document.getElementById('description');\n    if (descriptionInput) {\n      descriptionInput.addEventListener('input', () => {\n        clearTimeout(draftTimeout);\n        draftTimeout = setTimeout(() => {\n          this._saveDraft(descriptionInput.value);\n        }, 30000); // 30 detik tanpa aktivitas\n      });\n    }\n  }\n\n  _saveDraft(text) {\n    if (!text || text.trim().length < 5) return;\n    try {\n      const draftsJson = localStorage.getItem('recentDrafts');\n      let drafts = draftsJson ? JSON.parse(draftsJson) : [];\n      const preview = text.substring(0, 50) + (text.length > 50 ? '...' : '');\n      const newDraft = {\n        id: Date.now().toString(),\n        description: preview,\n        fullDescription: text,\n        timestamp: new Date().toISOString(),\n      };\n      drafts.unshift(newDraft);\n      drafts = drafts.slice(0, 5);\n      localStorage.setItem('recentDrafts', JSON.stringify(drafts));\n      window.showToast && window.showToast('Draft saved automatically', 'info');\n    } catch (error) {\n      console.error('Error saving draft:', error);\n    }\n  }\n\n  // Camera\n  _checkMediaPermissions() {\n    if (navigator.permissions && navigator.permissions.query) {\n      navigator.permissions\n        .query({ name: 'camera' })\n        .then((permissionStatus) => {\n          const cameraButton = document.getElementById('camera-button');\n          if (permissionStatus.state === 'denied' && cameraButton) {\n            cameraButton.classList.add('permission-denied');\n            cameraButton.title =\n              'Camera permission denied. Please update your browser settings.';\n          }\n          permissionStatus.onchange = () => {\n            if (cameraButton) {\n              if (permissionStatus.state === 'denied') {\n                cameraButton.classList.add('permission-denied');\n                cameraButton.title =\n                  'Camera permission denied. Please update your browser settings.';\n              } else {\n                cameraButton.classList.remove('permission-denied');\n                cameraButton.title = '';\n              }\n            }\n          };\n        })\n        .catch((error) => {\n          console.log('Error checking camera permission:', error);\n        });\n    }\n  }\n\n  stopCamera() {\n    if (this._cameraStream) {\n      try {\n        this._cameraStream.getTracks().forEach((track) => track.stop());\n      } catch (error) {\n        console.error('Error stopping camera tracks:', error);\n      }\n      this._cameraStream = null;\n      if (this.#view) this.#view.resetCameraUI();\n    }\n  }\n\n  _setupCamera() {\n    this.#view.setOpenCameraCallback(async () => {\n      try {\n        if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {\n          throw new Error('Your browser does not support camera access');\n        }\n        this.stopCamera();\n        const stream = await navigator.mediaDevices.getUserMedia({\n          video: {\n            facingMode: 'environment',\n            width: { ideal: 1280 },\n            height: { ideal: 720 },\n          },\n          audio: false,\n        });\n        this._cameraStream = stream;\n        this.#view.showCameraStream(stream);\n        window.addEventListener('beforeunload', () => this.stopCamera(), {\n          once: true,\n        });\n      } catch (error) {\n        if (error.name === 'NotAllowedError') {\n          this.#view.showCameraError(\n            'Camera access denied. Please allow camera access in your browser settings.'\n          );\n        } else if (error.name === 'NotFoundError') {\n          this.#view.showCameraError(\n            'No camera found on your device or camera is in use by another application.'\n          );\n        } else if (error.name === 'NotReadableError') {\n          this.#view.showCameraError(\n            'Could not access camera. Your camera might be in use by another application.'\n          );\n        } else if (error.name === 'OverconstrainedError') {\n          try {\n            const fallbackStream = await navigator.mediaDevices.getUserMedia({\n              video: true,\n              audio: false,\n            });\n            this._cameraStream = fallbackStream;\n            this.#view.showCameraStream(fallbackStream);\n          } catch {\n            this.#view.showCameraError(\n              'Could not access camera with requested settings. Please try a different device.'\n            );\n          }\n        } else {\n          this.#view.showCameraError(\n            'Could not access camera: ' + (error.message || 'Unknown error')\n          );\n        }\n      }\n    });\n\n    this.#view.setTakePhotoCallback(() => {\n      if (!this._cameraStream) {\n        this.#view.showCameraError('Camera is not ready. Please try again.');\n        return;\n      }\n      try {\n        const dataUrl = this.#view.capturePhoto();\n        if (!dataUrl) {\n          this.#view.showCameraError('Failed to capture photo');\n          return;\n        }\n        this.#view.showCameraFlash();\n        const filename = 'camera-photo-' + new Date().getTime() + '.jpg';\n        const file = this._dataURLToFile(dataUrl, filename);\n        if (!file) {\n          this.#view.showCameraError('Failed to process captured photo');\n          return;\n        }\n        if (file.size > CONFIG.MAX_PHOTO_SIZE) {\n          this.#view.showPhotoError(\n            `File too large. Maximum size is ${formatFileSize(CONFIG.MAX_PHOTO_SIZE)}`\n          );\n          return;\n        }\n        this._photoFile = file;\n        this.#view.showPhotoPreview(file);\n        window.showToast &&\n          window.showToast('Photo captured successfully!', 'success');\n        setTimeout(() => this.stopCamera(), 500);\n      } catch (error) {\n        this.#view.showCameraError('Error capturing photo: ' + error.message);\n      }\n    });\n\n    this.#view.setCloseCameraCallback(() => this.stopCamera());\n  }\n\n  _dataURLToFile(dataUrl, filename) {\n    try {\n      if (\n        !dataUrl ||\n        typeof dataUrl !== 'string' ||\n        !dataUrl.startsWith('data:image/')\n      )\n        return null;\n      const arr = dataUrl.split(',');\n      if (arr.length !== 2) return null;\n      const mimeMatch = arr[0].match(/:(.*?);/);\n      if (!mimeMatch || mimeMatch.length < 2) return null;\n      const mime = mimeMatch[1];\n      const bstr = atob(arr[1]);\n      let n = bstr.length;\n      const u8arr = new Uint8Array(n);\n      while (n--) u8arr[n] = bstr.charCodeAt(n);\n      return new File([u8arr], filename, { type: mime });\n    } catch (error) {\n      console.error('Error converting data URL to file:', error);\n      return null;\n    }\n  }\n\n  _setupPhotoPreview() {\n    this.#view.setPhotoInputCallback((file) => {\n      if (!file) return;\n      if (file.size > CONFIG.MAX_PHOTO_SIZE) {\n        this.#view.showPhotoError(\n          `File too large. Maximum size is ${formatFileSize(CONFIG.MAX_PHOTO_SIZE)}`\n        );\n        return;\n      }\n      if (!['image/jpeg', 'image/png', 'image/jpg'].includes(file.type)) {\n        this.#view.showPhotoError('Only JPEG and PNG images are allowed');\n        return;\n      }\n      this._photoFile = file;\n      this.#view.clearPhotoError();\n      this.#view.showPhotoPreview(file);\n    });\n  }\n\n  // Form\n  _setupForm() {\n    this.#view.setSubmitCallback(async (formData) => {\n      const token = localStorage.getItem('accessToken');\n      if (!token) {\n        await this.#view.showLoginRequiredAlert();\n        window.location.hash = '#/login';\n        return;\n      }\n      if (!this._validateForm()) {\n        this.#view.showFormValidationError();\n        return;\n      }\n      if (!formData.has('description') || !formData.get('description').trim()) {\n        this.#view.showDescriptionError('Description is required');\n        this.#view.showFormValidationError();\n        return;\n      }\n      if (!formData.has('photo') || !formData.get('photo')) {\n        if (this._photoFile) {\n          formData.set('photo', this._photoFile);\n        } else {\n          this.#view.showPhotoError('Please select or take a photo');\n          this.#view.showFormValidationError();\n          return;\n        }\n      }\n      this.#view.showLoader('Saving your story...');\n      this.#view.showProgressBar();\n      try {\n        await DicodingStoryApi.addNewStory({\n          token,\n          data: formData,\n          onProgress: (progress) => this.#view.updateProgressBar(progress),\n        });\n        this.#view.updateProgressBar(100);\n        setTimeout(() => this.#view.hideProgressBar(), 500);\n        await this.#view.showSuccessAlert();\n        this.#view.showConfetti();\n        this._addToRecents(formData.get('description'));\n        setTimeout(() => {\n          window.location.hash = '#/';\n          this.#view.resetForm();\n          this.stopCamera();\n        }, 1000);\n      } catch (error) {\n        this.#view.hideProgressBar();\n        this.#view.showErrorAlert(error.message);\n      } finally {\n        this.#view.hideLoader();\n      }\n    });\n  }\n\n  _setupInputValidation() {\n    this.#view.setDescriptionInputCallback((value) =>\n      this._validateDescription(value)\n    );\n  }\n\n  _validateDescription(description) {\n    if (!description) {\n      this.#view.showDescriptionError('Please enter a description');\n      return false;\n    }\n    if (description.length < 10) {\n      this.#view.showDescriptionError(\n        'Description must be at least 10 characters'\n      );\n      return false;\n    }\n    const sensitiveWords = ['judi', 'poker', 'togel', 'seks', 'adult', 'xxx'];\n    const containsSensitiveContent = sensitiveWords.some((word) =>\n      description.toLowerCase().includes(word)\n    );\n    if (containsSensitiveContent) {\n      this.#view.showDescriptionError(\n        'Your story may contain inappropriate content. Please revise.'\n      );\n      return false;\n    }\n    this.#view.clearDescriptionError();\n    return true;\n  }\n\n  _validateForm() {\n    const isDescriptionValid = this._validateDescription(\n      this.#view.getDescription()\n    );\n    const isPhotoValid = this._validatePhoto();\n    return isDescriptionValid && isPhotoValid;\n  }\n\n  _validatePhoto() {\n    if (!this._photoFile) {\n      const photoInput = document.getElementById('photo');\n      if (photoInput && photoInput.files.length > 0) {\n        this._photoFile = photoInput.files[0];\n      } else {\n        const photoPreview = document.querySelector('#photo-preview img');\n        if (!photoPreview || photoPreview.classList.contains('hidden')) {\n          this.#view.showPhotoError('Please select or take a photo');\n          return false;\n        }\n      }\n    }\n    if (this._photoFile && this._photoFile.size > CONFIG.MAX_PHOTO_SIZE) {\n      this.#view.showPhotoError(\n        `File too large. Maximum size is ${formatFileSize(CONFIG.MAX_PHOTO_SIZE)}`\n      );\n      return false;\n    }\n    return true;\n  }\n\n  // Location/Map\n  _setupLocationCheckbox() {\n    this.#view.setLocationCheckboxCallback((isChecked) => {\n      if (isChecked) {\n        this.#view.showMapContainer();\n        if (!this._mapInitialized) {\n          setTimeout(() => this._initMap(), 300);\n        } else if (this._map) {\n          this._map.invalidateSize();\n        }\n      } else {\n        this.#view.hideMapContainer();\n      }\n    });\n  }\n\n  _initMap() {\n    if (!window.L) {\n      this.#view.showMapError(\n        'Map library not loaded. Please check your internet connection and reload the page.'\n      );\n      return;\n    }\n    try {\n      const mapElement = document.getElementById('map');\n      if (!mapElement) return;\n      this._map = L.map('map', {\n        zoomControl: true,\n        attributionControl: true,\n      }).setView(CONFIG.DEFAULT_MAP_CENTER, CONFIG.DEFAULT_MAP_ZOOM);\n      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n        attribution:\n          '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\n        maxZoom: 19,\n      }).addTo(this._map);\n      setTimeout(() => this._map.invalidateSize(), 100);\n      this._mapInitialized = true;\n      if (window.L.Control && window.L.Control.Geocoder) {\n        const geocoder = L.Control.Geocoder.nominatim({\n          geocodingQueryParams: { countrycodes: 'id', limit: 5 },\n        });\n        const control = L.Control.geocoder({\n          defaultMarkGeocode: false,\n          geocoder: geocoder,\n          placeholder: 'Search for places...',\n          errorMessage: 'Nothing found.',\n          suggestMinLength: 3,\n          suggestTimeout: 250,\n          queryMinLength: 1,\n        }).addTo(this._map);\n        control.on('markgeocode', (e) => {\n          const { lat, lng } = e.geocode.center;\n          this._updateLocation(lat, lng);\n          this._map.setView([lat, lng], 15);\n        });\n      }\n      if (window.L.control && window.L.control.locate) {\n        L.control\n          .locate({\n            position: 'topright',\n            strings: { title: 'Temukan lokasi saya' },\n            locateOptions: { enableHighAccuracy: true, maxZoom: 15 },\n            flyTo: true,\n          })\n          .addTo(this._map);\n      }\n      this._map.on('click', (e) =>\n        this._updateLocation(e.latlng.lat, e.latlng.lng)\n      );\n      this.#view.setLocateMeCallback(() => {\n        if ('geolocation' in navigator) {\n          this.#view.showLoader('Finding your location...');\n          navigator.geolocation.getCurrentPosition(\n            (position) => {\n              this.#view.hideLoader();\n              const { latitude, longitude } = position.coords;\n              this._updateLocation(latitude, longitude);\n              this._map.setView([latitude, longitude], 15);\n              window.showToast &&\n                window.showToast('Location found!', 'success');\n            },\n            (error) => {\n              this.#view.hideLoader();\n              let errorMessage = 'Could not get your location.';\n              switch (error.code) {\n                case error.PERMISSION_DENIED:\n                  errorMessage =\n                    'Location access denied. Please check your browser settings.';\n                  break;\n                case error.POSITION_UNAVAILABLE:\n                  errorMessage = 'Location information is unavailable.';\n                  break;\n                case error.TIMEOUT:\n                  errorMessage = 'Location request timed out.';\n                  break;\n              }\n              this.#view.showMapError(errorMessage);\n            },\n            { enableHighAccuracy: true, timeout: 10000, maximumAge: 0 }\n          );\n        } else {\n          this.#view.showMapError(\n            'Geolocation is not supported by your browser'\n          );\n        }\n      });\n      this.#view.setSearchLocationCallback(() => {\n        const geocoderControl = document.querySelector(\n          '.leaflet-control-geocoder'\n        );\n        if (geocoderControl) {\n          try {\n            const searchButton = geocoderControl.querySelector(\n              '.leaflet-control-geocoder-icon'\n            );\n            const searchInput = geocoderControl.querySelector('input');\n            if (searchButton) searchButton.click();\n            if (searchInput) searchInput.focus();\n          } catch {\n            this._showLocationSearchPrompt();\n          }\n        } else {\n          this._showLocationSearchPrompt();\n        }\n      });\n    } catch (error) {\n      this.#view.showMapError('Failed to initialize map: ' + error.message);\n    }\n  }\n\n  _showLocationSearchPrompt() {\n    Swal.fire({\n      title: 'Search Location',\n      input: 'text',\n      inputPlaceholder: 'Enter a place or address',\n      showCancelButton: true,\n      confirmButtonColor: '#4361ee',\n      cancelButtonColor: '#6c757d',\n      confirmButtonText: 'Search',\n      showLoaderOnConfirm: true,\n      preConfirm: (query) => {\n        if (!query) {\n          Swal.showValidationMessage('Please enter a location');\n          return;\n        }\n        return fetch(\n          `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(query)}&limit=5`\n        )\n          .then((response) => {\n            if (!response.ok) throw new Error('Network response was not ok');\n            return response.json();\n          })\n          .catch((error) => {\n            Swal.showValidationMessage(`Search failed: ${error.message}`);\n          });\n      },\n      allowOutsideClick: () => !Swal.isLoading(),\n    }).then((result) => {\n      if (result.isConfirmed && result.value && result.value.length > 0) {\n        const locations = result.value;\n        if (locations.length === 1) {\n          const location = locations[0];\n          const lat = parseFloat(location.lat);\n          const lon = parseFloat(location.lon);\n          this._updateLocation(lat, lon);\n          if (this._map) this._map.setView([lat, lon], 15);\n        } else if (locations.length > 1) {\n          const options = locations.map((loc) => ({\n            text: loc.display_name,\n            value: loc.place_id,\n            lat: parseFloat(loc.lat),\n            lon: parseFloat(loc.lon),\n          }));\n          Swal.fire({\n            title: 'Select Location',\n            input: 'radio',\n            inputOptions: options.reduce((acc, opt) => {\n              acc[opt.value] = opt.text;\n              return acc;\n            }, {}),\n            showCancelButton: true,\n            confirmButtonColor: '#4361ee',\n            confirmButtonText: 'Select',\n          }).then((result) => {\n            if (result.isConfirmed) {\n              const selectedOption = options.find(\n                (opt) => opt.value.toString() === result.value\n              );\n              if (selectedOption) {\n                this._updateLocation(selectedOption.lat, selectedOption.lon);\n                if (this._map)\n                  this._map.setView(\n                    [selectedOption.lat, selectedOption.lon],\n                    15\n                  );\n              }\n            }\n          });\n        } else {\n          Swal.fire({\n            icon: 'info',\n            title: 'No Results',\n            text: 'No locations found for your search.',\n          });\n        }\n      }\n    });\n  }\n\n  _updateLocation(lat, lng) {\n    this.#view.updateLocationCoordinates(lat, lng);\n    if (this._marker) {\n      this._marker.setLatLng([lat, lng]);\n    } else if (this._map) {\n      this._marker = L.marker([lat, lng], {\n        draggable: true,\n        autoPan: true,\n      }).addTo(this._map);\n      this._marker.on('dragend', (event) => {\n        const marker = event.target;\n        const position = marker.getLatLng();\n        this._updateLocation(position.lat, position.lng);\n      });\n    }\n    if (this._map) {\n      this._map.setView([lat, lng], this._map.getZoom() || 15);\n      const locationText = document.getElementById('location-text');\n      if (locationText) {\n        locationText.innerHTML = `\n          <span class=\"loading-dots\">Getting location name</span>\n          <br>Coordinates: ${lat.toFixed(6)}, ${lng.toFixed(6)}\n        `;\n      }\n      this._reverseGeocode(lat, lng);\n    }\n  }\n\n  _reverseGeocode(lat, lng) {\n    if (window.L && window.L.Control && window.L.Control.Geocoder) {\n      try {\n        const geocoder = L.Control.Geocoder.nominatim();\n        if (geocoder) {\n          geocoder.reverse({ lat, lng }, this._map.getZoom(), (results) => {\n            if (results && results.length > 0) {\n              const locationName = results[0].name;\n              const locationText = document.getElementById('location-text');\n              if (locationText && locationName) {\n                locationText.innerHTML = `\n                  <strong>${locationName}</strong>\n                  <br>Coordinates: ${lat.toFixed(6)}, ${lng.toFixed(6)}\n                `;\n              }\n            }\n          });\n          return;\n        }\n      } catch (error) {\n        console.warn('Leaflet reverse geocoding failed:', error);\n      }\n    }\n    // Fallback to Nominatim API\n    try {\n      fetch(\n        `https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lng}&zoom=18&addressdetails=1`\n      )\n        .then((response) => response.json())\n        .then((data) => {\n          if (data && data.display_name) {\n            const locationText = document.getElementById('location-text');\n            if (locationText) {\n              locationText.innerHTML = `\n                <strong>${data.display_name}</strong>\n                <br>Coordinates: ${lat.toFixed(6)}, ${lng.toFixed(6)}\n              `;\n            }\n          }\n        })\n        .catch((error) => {\n          const locationText = document.getElementById('location-text');\n          if (locationText) {\n            locationText.textContent = `Coordinates: ${lat.toFixed(6)}, ${lng.toFixed(6)}`;\n          }\n        });\n    } catch (error) {\n      // fallback\n    }\n  }\n\n  _addToRecents(description) {\n    try {\n      const recentsJson = localStorage.getItem('recentDrafts');\n      let recents = recentsJson ? JSON.parse(recentsJson) : [];\n      const preview =\n        description.substring(0, 50) + (description.length > 50 ? '...' : '');\n      recents.unshift({\n        description: preview,\n        timestamp: new Date().toISOString(),\n        id: Date.now().toString(),\n      });\n      recents = recents.slice(0, 5);\n      localStorage.setItem('recentDrafts', JSON.stringify(recents));\n    } catch (error) {\n      console.error('Error saving to recents:', error);\n    }\n  }\n}\n","import '../../components/header';\nimport '../../components/loader';\nimport '../../components/footer';\nimport '../../components/sidebar';\nimport AddPresenter from './add-presenter';\n\nexport default class AddStoryPage {\n  constructor() {\n    this._presenter = new AddPresenter({ view: this });\n  }\n\n  async render() {\n    return `\n      <app-sidebar></app-sidebar>\n      <app-header></app-header>\n      <main id=\"main-content\" class=\"main-content\" tabindex=\"-1\">\n        <section class=\"container\">\n          <div class=\"add-story-container\">\n            <h1 class=\"page-title\">Share Your Story</h1>\n            <div class=\"recent-drafts-container hidden\" id=\"recent-drafts\"></div>\n            <form id=\"add-story-form\" class=\"story-form\" autocomplete=\"on\" novalidate>\n              <div class=\"form-group\">\n                <label for=\"description\" class=\"form-label\">Story Description</label>\n                <textarea\n                  id=\"description\"\n                  class=\"form-control\"\n                  placeholder=\"Share your learning experience...\"\n                  rows=\"4\"\n                  required\n                  maxlength=\"280\"\n                  aria-describedby=\"description-error\"\n                ></textarea>\n                <small id=\"description-error\" class=\"error-text\"></small>\n                <div class=\"character-counter\">\n                  <span id=\"char-count\">0</span> / 280 characters\n                </div>\n              </div>\n              <div class=\"form-group\">\n                <label class=\"form-label\">Photo</label>\n                <div class=\"photo-upload-container\">\n                  <div class=\"photo-preview-container\">\n                    <div class=\"photo-preview\" id=\"photo-preview\">\n                      <i class=\"fas fa-image preview-placeholder\"></i>\n                      <img id=\"preview-image\" class=\"hidden\" alt=\"Preview of your photo\">\n                    </div>\n                  </div>\n                  <div class=\"photo-actions\">\n                    <div class=\"photo-upload\">\n                      <label for=\"photo\" class=\"custom-file-upload\">\n                        <i class=\"fas fa-upload\"></i> Select Photo\n                      </label>\n                      <input type=\"file\" id=\"photo\" name=\"photo\" accept=\"image/jpeg, image/png\" hidden>\n                    </div>\n                    <div class=\"or-divider\">or</div>\n                    <button type=\"button\" id=\"camera-button\" class=\"camera-button\">\n                      <i class=\"fas fa-camera\"></i> Take Photo\n                    </button>\n                  </div>\n                </div>\n                <small id=\"photo-error\" class=\"error-text\"></small>\n              </div>\n              <div class=\"camera-container hidden\" id=\"camera-container\">\n                <div class=\"camera-view-container\">\n                  <video id=\"camera-view\" autoplay playsinline></video>\n                  <canvas id=\"camera-canvas\" class=\"hidden\"></canvas>\n                </div>\n                <div class=\"camera-controls\">\n                  <button type=\"button\" id=\"take-photo\" class=\"camera-control-button\">\n                    <i class=\"fas fa-circle\"></i>\n                  </button>\n                  <button type=\"button\" id=\"close-camera\" class=\"camera-control-button\">\n                    <i class=\"fas fa-times\"></i>\n                  </button>\n                </div>\n                <small id=\"camera-error\" class=\"error-text\"></small>\n              </div>\n              <div class=\"form-group\">\n                <div class=\"custom-checkbox\">\n                  <input type=\"checkbox\" id=\"location-enabled\" name=\"location-enabled\">\n                  <label for=\"location-enabled\">\n                    <i class=\"fas fa-map-marker-alt\"></i> Include location\n                  </label>\n                </div>\n              </div>\n              <div id=\"map-container\" class=\"map-container hidden\">\n                <div id=\"map\" class=\"add-story-map\"></div>\n                <input type=\"hidden\" id=\"lat\" name=\"lat\">\n                <input type=\"hidden\" id=\"lon\" name=\"lon\">\n                <small id=\"map-error\" class=\"error-text\"></small>\n                <div class=\"location-info\" id=\"location-info\">\n                  <i class=\"fas fa-map-pin\"></i>\n                  <span id=\"location-text\">No location selected</span>\n                </div>\n              </div>\n              <div class=\"progress-container hidden\" id=\"progress-container\">\n                <div class=\"progress-bar\" id=\"progress-bar\" style=\"width: 0%\"></div>\n              </div>\n              <div class=\"form-actions\">\n                <a href=\"#/\" class=\"cancel-button\">Cancel</a>\n                <button type=\"submit\" class=\"submit-button\" id=\"submit-button\">\n                  <i class=\"fas fa-paper-plane\"></i> Share Story\n                </button>\n              </div>\n            </form>\n          </div>\n        </section>\n      </main>\n      <app-footer></app-footer>\n      <app-loader></app-loader>\n      <canvas id=\"confetti-canvas\" class=\"confetti-canvas\"></canvas>\n    `;\n  }\n\n  async afterRender() {\n    this._presenter.init();\n    this._presenter.loadRecentDrafts();\n    this._setupCharCounter();\n    this._setupAccessibility();\n  }\n\n  _setupCharCounter() {\n    const textarea = document.getElementById('description');\n    const charCount = document.getElementById('char-count');\n    if (textarea && charCount) {\n      textarea.addEventListener('input', () => {\n        const count = textarea.value.length;\n        charCount.textContent = count;\n        if (count > 240 && count <= 270) {\n          charCount.classList.add('text-warning');\n          charCount.classList.remove('text-danger');\n        } else if (count > 270) {\n          charCount.classList.add('text-danger');\n          charCount.classList.remove('text-warning');\n        } else {\n          charCount.classList.remove('text-warning', 'text-danger');\n        }\n      });\n    }\n  }\n\n  _setupAccessibility() {\n    // Fokus otomatis ke textarea saat halaman add story\n    const textarea = document.getElementById('description');\n    if (textarea) setTimeout(() => textarea.focus(), 200);\n\n    // Skip link support\n    const skipLink = document.querySelector('.skip-link');\n    const mainContent = document.getElementById('main-content');\n    if (skipLink && mainContent) {\n      skipLink.addEventListener('click', function (event) {\n        event.preventDefault();\n        skipLink.blur();\n        mainContent.focus();\n        mainContent.scrollIntoView({ behavior: 'smooth' });\n      });\n    }\n  }\n\n  displayRecentDrafts(drafts) {\n    const container = document.getElementById('recent-drafts');\n    if (!container) return;\n    if (!drafts || !Array.isArray(drafts) || drafts.length === 0) {\n      container.classList.add('hidden');\n      return;\n    }\n    container.classList.remove('hidden');\n    let html =\n      '<h2 class=\"recent-drafts-title\">Recent Drafts</h2><div class=\"recent-drafts-list\">';\n    drafts.forEach((draft) => {\n      const date = new Date(draft.timestamp);\n      const formattedDate = date.toLocaleDateString('id-ID', {\n        day: 'numeric',\n        month: 'short',\n      });\n      html += `\n        <div class=\"recent-draft-item\" data-id=\"${draft.id}\">\n          <div class=\"draft-content\">\n            <p class=\"draft-text\">${draft.description}</p>\n            <span class=\"draft-date\">${formattedDate}</span>\n          </div>\n          <button class=\"use-draft-btn\" data-id=\"${draft.id}\">\n            <i class=\"fas fa-arrow-right\"></i>\n          </button>\n        </div>\n      `;\n    });\n    html += '</div>';\n    container.innerHTML = html;\n    document.querySelectorAll('.use-draft-btn').forEach((btn) => {\n      btn.addEventListener('click', () => {\n        const draftId = btn.getAttribute('data-id');\n        this._presenter.useDraft(draftId);\n      });\n    });\n  }\n\n  applyDraftToForm(description) {\n    const textarea = document.getElementById('description');\n    if (textarea) {\n      textarea.value = description;\n      textarea.dispatchEvent(new Event('input'));\n      textarea.focus();\n      document\n        .querySelector('.story-form')\n        .scrollIntoView({ behavior: 'smooth' });\n    }\n  }\n\n  // Camera methods\n  setOpenCameraCallback(callback) {\n    const openCameraButton = document.querySelector('#camera-button');\n    if (openCameraButton) openCameraButton.addEventListener('click', callback);\n  }\n  setTakePhotoCallback(callback) {\n    const takePhotoButton = document.querySelector('#take-photo');\n    if (takePhotoButton) takePhotoButton.addEventListener('click', callback);\n  }\n  showCameraStream(stream) {\n    const cameraContainer = document.querySelector('#camera-container');\n    const videoElement = document.querySelector('#camera-view');\n    if (!cameraContainer || !videoElement) return;\n    cameraContainer.classList.remove('hidden');\n    videoElement.srcObject = stream;\n    videoElement.onloadedmetadata = () => {\n      videoElement\n        .play()\n        .catch((error) => console.error('Error playing video:', error));\n    };\n  }\n  capturePhoto() {\n    const videoElement = document.querySelector('#camera-view');\n    const canvas = document.querySelector('#camera-canvas');\n    if (!videoElement || !canvas) return null;\n    if (videoElement.videoWidth === 0 || videoElement.videoHeight === 0)\n      return null;\n    canvas.width = videoElement.videoWidth;\n    canvas.height = videoElement.videoHeight;\n    const context = canvas.getContext('2d');\n    context.drawImage(videoElement, 0, 0, canvas.width, canvas.height);\n    return canvas.toDataURL('image/jpeg', 0.9);\n  }\n  showCameraFlash() {\n    const flash = document.createElement('div');\n    flash.className = 'camera-flash';\n    document.body.appendChild(flash);\n    setTimeout(() => {\n      flash.style.opacity = '0.8';\n      setTimeout(() => {\n        flash.style.opacity = '0';\n        setTimeout(() => {\n          document.body.removeChild(flash);\n        }, 300);\n      }, 100);\n    }, 10);\n  }\n  resetCameraUI() {\n    const cameraContainer = document.querySelector('#camera-container');\n    const videoElement = document.querySelector('#camera-view');\n    if (cameraContainer) cameraContainer.classList.add('hidden');\n    if (videoElement) videoElement.srcObject = null;\n  }\n  showCameraError(message) {\n    Swal.fire({\n      icon: 'error',\n      title: 'Camera Error',\n      text: message,\n      confirmButtonColor: '#4361ee',\n    });\n  }\n\n  // Photo preview methods\n  setPhotoInputCallback(callback) {\n    const photoInput = document.querySelector('#photo');\n    if (photoInput) {\n      photoInput.addEventListener('change', (event) => {\n        callback(event.target.files[0]);\n      });\n    }\n  }\n  showPhotoPreview(file) {\n    const photoPreview = document.getElementById('photo-preview');\n    if (!photoPreview) return;\n    const reader = new FileReader();\n    reader.onload = (e) => {\n      photoPreview.innerHTML = `\n        <img \n          src=\"${e.target.result}\" \n          alt=\"Selected photo preview\" \n          style=\"max-width: 100%; border-radius: 8px; max-height: 300px;\"\n        >\n      `;\n    };\n    reader.readAsDataURL(file);\n  }\n  showPhotoError(message) {\n    const photoError = document.getElementById('photo-error');\n    if (photoError) {\n      photoError.textContent = message;\n      photoError.style.display = 'block';\n    }\n  }\n  clearPhotoError() {\n    const photoError = document.getElementById('photo-error');\n    if (photoError) {\n      photoError.textContent = '';\n      photoError.style.display = 'none';\n    }\n  }\n\n  // Location methods\n  setLocationCheckboxCallback(callback) {\n    const locationCheckbox = document.getElementById('location-enabled');\n    if (locationCheckbox) {\n      locationCheckbox.addEventListener('change', () => {\n        callback(locationCheckbox.checked);\n      });\n    }\n  }\n  showMapContainer() {\n    const mapContainer = document.getElementById('map-container');\n    if (mapContainer) {\n      mapContainer.classList.remove('hidden');\n      setTimeout(() => {\n        if (window.L && window.L.map) {\n          const map = window.L.map._instances?.[0];\n          if (map) map.invalidateSize();\n        }\n      }, 100);\n    }\n  }\n  hideMapContainer() {\n    const mapContainer = document.getElementById('map-container');\n    if (mapContainer) mapContainer.classList.add('hidden');\n  }\n  setLocateMeCallback(callback) {\n    const locateMeButton = document.getElementById('locate-me');\n    if (locateMeButton) locateMeButton.addEventListener('click', callback);\n  }\n  setSearchLocationCallback(callback) {\n    const searchLocationButton = document.getElementById('search-location');\n    if (searchLocationButton)\n      searchLocationButton.addEventListener('click', callback);\n  }\n  updateLocationCoordinates(lat, lng) {\n    const latInput = document.getElementById('lat');\n    const lonInput = document.getElementById('lon');\n    const locationText = document.getElementById('location-text');\n    if (latInput && lonInput) {\n      latInput.value = lat;\n      lonInput.value = lng;\n    }\n    if (locationText) {\n      locationText.textContent = `Coordinates: ${lat.toFixed(6)}, ${lng.toFixed(6)}`;\n    }\n  }\n  showMapError(message) {\n    Swal.fire({\n      icon: 'error',\n      title: 'Map Error',\n      text: message,\n      confirmButtonColor: '#4361ee',\n    });\n  }\n\n  // Form methods\n  setSubmitCallback(callback) {\n    const form = document.getElementById('add-story-form');\n    if (!form) return;\n    form.addEventListener('submit', async (event) => {\n      event.preventDefault();\n      const description = this.getDescription();\n      const photoInput = document.getElementById('photo');\n      const photoFile = photoInput.files[0];\n      const useLocation = document.getElementById('location-enabled').checked;\n      const lat = document.getElementById('lat').value;\n      const lon = document.getElementById('lon').value;\n      const formData = new FormData();\n      formData.append('description', description);\n      if (photoFile) formData.append('photo', photoFile);\n      if (useLocation && lat && lon) {\n        formData.append('lat', lat);\n        formData.append('lon', lon);\n      }\n      callback(formData);\n    });\n  }\n  getDescription() {\n    const descriptionInput = document.getElementById('description');\n    return descriptionInput ? descriptionInput.value.trim() : '';\n  }\n  setDescriptionInputCallback(callback) {\n    const descriptionInput = document.getElementById('description');\n    if (descriptionInput) {\n      descriptionInput.addEventListener('input', () => {\n        callback(descriptionInput.value.trim());\n      });\n    }\n  }\n  showDescriptionError(message) {\n    const descriptionError = document.getElementById('description-error');\n    if (descriptionError) {\n      descriptionError.textContent = message;\n      descriptionError.style.display = 'block';\n      const descriptionInput = document.getElementById('description');\n      if (descriptionInput) {\n        descriptionInput.classList.add('error');\n        descriptionInput.setAttribute('aria-invalid', 'true');\n      }\n    }\n  }\n  clearDescriptionError() {\n    const descriptionError = document.getElementById('description-error');\n    if (descriptionError) {\n      descriptionError.textContent = '';\n      descriptionError.style.display = 'none';\n      const descriptionInput = document.getElementById('description');\n      if (descriptionInput) {\n        descriptionInput.classList.remove('error');\n        descriptionInput.setAttribute('aria-invalid', 'false');\n      }\n    }\n  }\n\n  // UI helper methods\n  showLoader(message = 'Loading...') {\n    document.querySelector('app-loader')?.show(message);\n  }\n  hideLoader() {\n    document.querySelector('app-loader')?.hide();\n  }\n  disableSubmitButton() {\n    const submitButton = document.getElementById('submit-button');\n    if (submitButton) submitButton.disabled = true;\n  }\n  resetForm() {\n    const form = document.getElementById('add-story-form');\n    const photoPreview = document.getElementById('photo-preview');\n    const mapContainer = document.getElementById('map-container');\n    const locationCheckbox = document.getElementById('location-enabled');\n    if (form) form.reset();\n    if (photoPreview) {\n      photoPreview.innerHTML = `<i class=\"fas fa-image preview-placeholder\"></i>\n      <img id=\"preview-image\" class=\"hidden\" alt=\"Preview of your photo\">`;\n    }\n    if (mapContainer) mapContainer.classList.add('hidden');\n    if (locationCheckbox) locationCheckbox.checked = false;\n    const charCount = document.getElementById('char-count');\n    if (charCount) {\n      charCount.textContent = '0';\n      charCount.classList.remove('text-warning', 'text-danger');\n    }\n  }\n\n  // Alerts\n  async showLoginRequiredAlert() {\n    return Swal.fire({\n      icon: 'warning',\n      title: 'Login Required',\n      text: 'You need to login first',\n      confirmButtonText: 'OK',\n      confirmButtonColor: '#4361ee',\n    });\n  }\n  async showOfflineAlert() {\n    return Swal.fire({\n      icon: 'error',\n      title: 'Offline Mode',\n      text: 'Adding stories is not available without internet connection.',\n      confirmButtonColor: '#4361ee',\n    });\n  }\n  async showSuccessAlert() {\n    return Swal.fire({\n      icon: 'success',\n      title: 'Story added successfully!',\n      showConfirmButton: false,\n      timer: 1500,\n    });\n  }\n  async showErrorAlert(message) {\n    return Swal.fire({\n      icon: 'error',\n      title: 'Error',\n      text: message || 'Failed to add story',\n      confirmButtonColor: '#4361ee',\n    });\n  }\n  showProgressBar() {\n    document.getElementById('progress-container')?.classList.remove('hidden');\n  }\n  hideProgressBar() {\n    document.getElementById('progress-container')?.classList.add('hidden');\n  }\n  updateProgressBar(percent) {\n    const progressBar = document.getElementById('progress-bar');\n    if (progressBar) progressBar.style.width = `${percent}%`;\n  }\n  showFormValidationError() {\n    Swal.fire({\n      icon: 'warning',\n      title: 'Form Validation Error',\n      text: 'Please fix the errors in the form before submitting.',\n      confirmButtonColor: '#4361ee',\n    });\n  }\n  showConfetti() {\n    const canvas = document.getElementById('confetti-canvas');\n    if (!canvas) return;\n    canvas.classList.add('active');\n    const confettiSettings = {\n      target: canvas,\n      max: 150,\n      size: 1.5,\n      animate: true,\n      props: ['circle', 'square', 'triangle', 'line'],\n      colors: [\n        [165, 104, 246],\n        [230, 61, 135],\n        [0, 199, 228],\n        [253, 214, 126],\n      ],\n      clock: 25,\n      rotate: true,\n      start_from_edge: true,\n      respawn: false,\n    };\n    const confetti = window.confetti.create(canvas, confettiSettings);\n    confetti({\n      particleCount: 150,\n      spread: 160,\n    });\n    setTimeout(() => {\n      canvas.classList.remove('active');\n    }, 3000);\n  }\n  setCloseCameraCallback(callback) {\n    const closeButton = document.getElementById('close-camera');\n    if (closeButton) closeButton.addEventListener('click', callback);\n  }\n}\n","import '../components/sidebar';\nimport '../components/header';\nimport '../components/footer';\n\nexport default class NotFoundPage {\n  async render() {\n    return `\n      <app-sidebar></app-sidebar>\n      <app-header></app-header>\n      <main id=\"main-content\" class=\"main-content\" tabindex=\"-1\">\n        <section class=\"container not-found text-center\" aria-labelledby=\"not-found-title\">\n          <h1 class=\"page-title\" id=\"not-found-title\">\n            <i class=\"fas fa-exclamation-triangle\" aria-hidden=\"true\"></i>\n            404 - Halaman Tidak Ditemukan\n          </h1>\n          <p class=\"mb-2\">Maaf, halaman yang Anda cari tidak tersedia atau telah dipindahkan.</p>\n          <a href=\"#/\" class=\"btn btn-primary back-link\" aria-label=\"Kembali ke Beranda\">\n            <i class=\"fas fa-home\"></i>\n            Kembali ke Beranda\n          </a>\n          <div class=\"mt-2\">\n            <button class=\"btn btn-secondary\" id=\"reload-btn\" aria-label=\"Muat ulang halaman\">\n              <i class=\"fas fa-sync-alt\"></i> Muat Ulang\n            </button>\n          </div>\n        </section>\n      </main>\n      <app-footer></app-footer>\n    `;\n  }\n\n  async afterRender() {\n    // Fokus otomatis ke main content untuk aksesibilitas\n    const mainContent = document.getElementById('main-content');\n    if (mainContent) {\n      setTimeout(() => mainContent.focus(), 200);\n    }\n\n    // Tombol reload\n    const reloadBtn = document.getElementById('reload-btn');\n    if (reloadBtn) {\n      reloadBtn.addEventListener('click', () => window.location.reload());\n    }\n  }\n}\n","/**\n * Utility for parsing and extracting route information from the current URL hash.\n * Mendukung parsing resource, id, add, dan query params.\n */\n\nfunction extractPathnameSegments(path) {\n  // Remove query parameters if any\n  const cleanPath = path.split('?')[0];\n  const splitUrl = cleanPath.split('/').filter(Boolean);\n\n  // Mendukung rute dinamis seperti #/stories/123/edit\n  return {\n    resource: splitUrl[0] || null,\n    id: splitUrl[1] && splitUrl[1] !== 'add' ? splitUrl[1] : null,\n    isAddPage: splitUrl[1] === 'add',\n    extra: splitUrl.slice(2), // improvisasi: untuk segment lebih dari 2\n  };\n}\n\nexport function getActivePathname() {\n  // Mendukung hash dan fallback ke '/'\n  return location.hash.replace('#', '') || '/';\n}\n\nexport function getActiveRoute() {\n  // Mendukung rute dinamis dan add\n  const { resource, id, isAddPage } =\n    extractPathnameSegments(getActivePathname());\n  let route = '#/';\n  if (resource) route = `#/${resource}`;\n  if (isAddPage) route += '/add';\n  if (id) route += '/:id';\n  return route;\n}\n\nexport function parseActivePathname() {\n  return extractPathnameSegments(getActivePathname());\n}\n\nexport function getQueryParams() {\n  // Mendukung query string pada hash, misal #/stories/123?foo=bar\n  const hash = location.hash || '';\n  const query = hash.includes('?') ? hash.split('?')[1] : '';\n  if (!query) return {};\n  return query.split('&').reduce((params, param) => {\n    const [key, value] = param.split('=');\n    params[key] = decodeURIComponent(value || '');\n    return params;\n  }, {});\n}\n\n/**\n * IMPROVISASI: Helper untuk mendapatkan parameter dinamis dari hash\n * Misal: #/stories/123/edit => getDynamicParams(['stories', ':id', 'edit'])\n */\nexport function getDynamicParams(pattern) {\n  const path = getActivePathname().split('?')[0];\n  const pathSegments = path.split('/').filter(Boolean);\n  const params = {};\n  pattern.forEach((segment, idx) => {\n    if (segment.startsWith(':')) {\n      params[segment.slice(1)] = pathSegments[idx] || null;\n    }\n  });\n  return params;\n}\n","import { getActiveRoute } from '../routes/url-parser';\nimport CONFIG from '../config';\n\nconst ACCESS_TOKEN_KEY = CONFIG.ACCESS_TOKEN_KEY;\nconst USER_KEY = 'user';\nconst unauthenticatedRoutesOnly = ['/login', '/register'];\n\n// Ambil token akses dari localStorage\nexport function getAccessToken() {\n  try {\n    const accessToken = localStorage.getItem(ACCESS_TOKEN_KEY);\n    if (!accessToken || accessToken === 'null' || accessToken === 'undefined')\n      return null;\n    return accessToken;\n  } catch (error) {\n    console.error('getAccessToken: error:', error);\n    return null;\n  }\n}\n\n// Simpan token akses ke localStorage\nexport function putAccessToken(token) {\n  try {\n    localStorage.setItem(ACCESS_TOKEN_KEY, token);\n    return true;\n  } catch (error) {\n    console.error('putAccessToken: error:', error);\n    return false;\n  }\n}\n\n// Hapus token akses dari localStorage\nexport function removeAccessToken() {\n  try {\n    localStorage.removeItem(ACCESS_TOKEN_KEY);\n    return true;\n  } catch (error) {\n    console.error('removeAccessToken: error:', error);\n    return false;\n  }\n}\n\n// Ambil data user dari localStorage\nexport function getUser() {\n  try {\n    const user = localStorage.getItem(USER_KEY);\n    if (!user || user === 'null' || user === 'undefined') return null;\n    return JSON.parse(user);\n  } catch (error) {\n    console.error('getUser: error:', error);\n    return null;\n  }\n}\n\n// Simpan data user ke localStorage\nexport function putUser(user) {\n  try {\n    localStorage.setItem(USER_KEY, JSON.stringify(user));\n    return true;\n  } catch (error) {\n    console.error('putUser: error:', error);\n    return false;\n  }\n}\n\n// Hapus data user dari localStorage\nexport function removeUser() {\n  try {\n    localStorage.removeItem(USER_KEY);\n    return true;\n  } catch (error) {\n    console.error('removeUser: error:', error);\n    return false;\n  }\n}\n\n// Cek jika route hanya untuk user yang sudah login\nexport function checkAuthenticatedRoute(page) {\n  const isLogin = !!getAccessToken();\n  if (!isLogin) {\n    location.hash = '/login';\n    window.showToast?.('Silakan login terlebih dahulu', 'warning');\n    return null;\n  }\n  return page;\n}\n\n// Logout user (hapus token & user)\nexport function getLogout() {\n  removeAccessToken();\n  removeUser();\n  window.showToast?.('Logout berhasil', 'success');\n  location.hash = '/login';\n}\n\n// Helper: cek status login\nexport function isLoggedIn() {\n  return !!getAccessToken();\n}\n","import IdbHelper from '../../idb';\nimport { getAccessToken } from '../../utils/auth.js';\n\nexport default class SavedPage {\n  constructor() {\n    this._title = 'Cerita Favorit - DicoStory';\n  }\n\n  async render() {\n    document.title = this._title;\n    return `\n      <app-sidebar></app-sidebar>\n      <app-header></app-header>\n      <main id=\"main-content\" class=\"main-content\" tabindex=\"-1\">\n        <section class=\"favorites-page page-transition\">\n          <div class=\"coordinator-layout\">\n            <div class=\"coordinator-header\">\n              <div>\n                <h2 class=\"coordinator-title text-gradient\">\n                  <i class=\"fas fa-heart\"></i> Cerita Favorit\n                </h2>\n                <p class=\"subtitle\">Kumpulan cerita yang Anda tandai sebagai favorit</p>\n              </div>\n              <a href=\"#/\" class=\"btn btn-secondary animated-underline\">\n                <i class=\"fas fa-arrow-left\"></i> Kembali ke Beranda\n              </a>\n            </div>\n            <div id=\"favorites-container\" class=\"coordinator-grid fade-in-up\">\n              <div class=\"loader\" id=\"favorites-loader\"></div>\n            </div>\n            <div id=\"error-container\" class=\"error-container hidden\"></div>\n          </div>\n        </section>\n      </main>\n      <app-footer></app-footer>\n    `;\n  }\n\n  async afterRender() {\n    // Aksesibilitas: fokus otomatis ke main content\n    const mainContent = document.getElementById('main-content');\n    if (mainContent) setTimeout(() => mainContent.focus(), 200);\n\n    // Cek login\n    if (!getAccessToken()) {\n      window.location.hash = '#/login';\n      return;\n    }\n    this.showLoading();\n    try {\n      const favorites = await IdbHelper.getFavorites();\n      this.renderFavorites(favorites);\n    } catch (error) {\n      console.error('Error loading favorites:', error);\n      this.showError(\n        'Gagal memuat cerita favorit: ' + (error.message || 'Unknown error')\n      );\n    }\n  }\n\n  showLoading() {\n    document.getElementById('favorites-loader')?.classList.remove('hidden');\n    document.getElementById('error-container')?.classList.add('hidden');\n  }\n\n  hideLoading() {\n    document.getElementById('favorites-loader')?.classList.add('hidden');\n  }\n\n  async renderFavorites(favorites) {\n    this.hideLoading();\n    const favoritesContainer = document.getElementById('favorites-container');\n    if (!favoritesContainer) return;\n\n    if (!favorites || favorites.length === 0) {\n      favoritesContainer.innerHTML = `\n        <div class=\"empty-state text-center fade-in-up\">\n          <img src=\"./images/empty-favorite.svg\" alt=\"Tidak ada favorit\" style=\"max-width:120px; margin-bottom:1rem;opacity:.85;\">\n          <h3 class=\"mb-1\">Belum ada cerita favorit</h3>\n          <p class=\"mb-2\">Tandai cerita yang Anda sukai agar mudah ditemukan di sini.</p>\n          <a href=\"#/\" class=\"btn btn-primary gradient-border\">\n            <i class=\"fas fa-compass\"></i> Jelajahi Cerita\n          </a>\n        </div>\n      `;\n      return;\n    }\n\n    favoritesContainer.innerHTML = '';\n    favorites.forEach((story, idx) => {\n      // Gunakan app-card agar konsisten dengan home\n      const card = document.createElement('app-card');\n      card.story = story;\n      card.classList.add('glass', 'fade-in-up');\n      card.style.animationDelay = `${idx * 60}ms`;\n\n      // Tambahkan badge \"Favorit\" di pojok atas card\n      card.addEventListener('DOMSubtreeModified', function injectBadge() {\n        const header = card.querySelector('.story-header');\n        if (header && !card.querySelector('.badge-favorite')) {\n          const badge = document.createElement('span');\n          badge.className = 'badge badge-favorite';\n          badge.innerHTML = `<i class=\"fas fa-heart\"></i> Favorit`;\n          badge.style.marginLeft = '0.5em';\n          header.appendChild(badge);\n          card.removeEventListener('DOMSubtreeModified', injectBadge);\n        }\n      });\n\n      // Tambahkan tombol hapus favorit di dalam card (kanan bawah)\n      const removeBtn = document.createElement('button');\n      removeBtn.className = 'remove-favorite-btn gradient-border';\n      removeBtn.innerHTML = `<i class=\"fas fa-trash\"></i> Hapus`;\n      removeBtn.setAttribute('aria-label', 'Hapus dari favorit');\n      removeBtn.title = 'Hapus dari favorit';\n      removeBtn.style.marginLeft = 'auto';\n\n      // Event hapus\n      removeBtn.addEventListener('click', async (event) => {\n        event.preventDefault();\n        await IdbHelper.removeFromFavorites(story.id);\n\n        // Sinkronkan localStorage\n        try {\n          const favoritesJson = localStorage.getItem('favoriteStories');\n          let favoritesArr = favoritesJson ? JSON.parse(favoritesJson) : [];\n          favoritesArr = favoritesArr.filter((id) => id !== story.id);\n          localStorage.setItem('favoriteStories', JSON.stringify(favoritesArr));\n        } catch {}\n\n        // Animasi hapus\n        card.style.transition = 'all 0.4s cubic-bezier(.4,0,.2,1)';\n        card.style.opacity = '0';\n        card.style.transform = 'scale(0.97) translateY(20px)';\n        setTimeout(() => card.remove(), 400);\n\n        const remainingFavorites = await IdbHelper.getFavorites();\n        if (remainingFavorites.length === 0) this.renderFavorites([]);\n        window.showToast?.('Cerita dihapus dari Favorit', 'info');\n      });\n\n      // Sisipkan tombol hapus ke dalam .story-actions di card\n      card.addEventListener('DOMSubtreeModified', function injectRemoveBtn() {\n        const actions = card.querySelector('.story-actions');\n        if (actions && !actions.querySelector('.remove-favorite-btn')) {\n          actions.appendChild(removeBtn);\n          card.removeEventListener('DOMSubtreeModified', injectRemoveBtn);\n        }\n      });\n\n      favoritesContainer.appendChild(card);\n    });\n  }\n\n  showError(message) {\n    this.hideLoading();\n    const errorContainer = document.getElementById('error-container');\n    if (!errorContainer) return;\n    errorContainer.classList.remove('hidden');\n    errorContainer.innerHTML = `\n      <div class=\"error-content text-center fade-in-up\">\n        <i class=\"fas fa-exclamation-triangle fa-3x mb-2\"></i>\n        <h3>Gagal memuat cerita favorit</h3>\n        <p>${message}</p>\n        <button id=\"retry-button\" class=\"btn btn-primary mt-2 gradient-border\">Coba Lagi</button>\n      </div>\n    `;\n    document\n      .getElementById('retry-button')\n      ?.addEventListener('click', async () => {\n        this.showLoading();\n        try {\n          const favorites = await IdbHelper.getFavorites();\n          this.renderFavorites(favorites);\n        } catch (error) {\n          this.showError(\n            'Gagal memuat cerita favorit: ' + (error.message || 'Unknown error')\n          );\n        }\n      });\n  }\n\n  _truncateText(text, maxLength) {\n    if (!text) return '';\n    if (text.length <= maxLength) return text;\n    return text.substr(0, maxLength) + '...';\n  }\n\n  _formatDate(dateString) {\n    if (!dateString) return '-';\n    const options = {\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit',\n    };\n    return new Date(dateString).toLocaleDateString('id-ID', options);\n  }\n}\n","import HomePage from '../pages/home/home-page';\nimport AboutPage from '../pages/about/about-page';\nimport LoginPage from '../pages/auth/login/login-page';\nimport RegisterPage from '../pages/auth/register/register-page';\nimport StoryDetailPage from '../pages/story-detail/story-detail-page';\nimport AddStoryPage from '../pages/add/add-page';\nimport NotFoundPage from '../pages/not-found-page';\nimport SavedStoriesPage from '../pages/saved/saved-page';\n\n// IMPROVISASI: Tambahkan rute fallback dan alias untuk kemudahan navigasi\nconst routes = {\n  '#/': HomePage,\n  '#/home': HomePage, // alias untuk beranda\n  '#/about': AboutPage,\n  '#/login': LoginPage,\n  '#/register': RegisterPage,\n  '#/stories/:id': StoryDetailPage,\n  '#/stories/add': AddStoryPage,\n  '#/saved': SavedStoriesPage,\n  '#/favorites': SavedStoriesPage, // alias untuk halaman favorit\n  '#/404': NotFoundPage,\n  '*': NotFoundPage, // fallback wildcard\n};\n\nexport default routes;\n","import '../components/header';\nimport '../components/sidebar';\nimport '../components/footer';\nimport '../components/loader';\nimport '../components/card';\nimport routes from '../routes/routes';\nimport { getActiveRoute, parseActivePathname } from '../routes/url-parser';\n\nclass App {\n  #content = null;\n  #activePresenter = null;\n  #previousRoute = null;\n\n  constructor({ content }) {\n    this.#content = content;\n\n    // Sidebar logout event (global handler)\n    document.addEventListener('user-logout', () => {\n      localStorage.removeItem('token');\n      localStorage.removeItem('user');\n      window.showToast?.('Logout berhasil', 'success');\n      window.location.hash = '#/login';\n      this.#updateSidebar();\n    });\n  }\n\n  async renderPage() {\n    const url = getActiveRoute();\n    const { resource, id, isAddPage } = parseActivePathname();\n\n    this.#cleanupPreviousPage();\n    this.#setDocumentTitle(resource, id);\n\n    // Special handling for Add Story page (with right transition)\n    if (isAddPage) {\n      await this.#renderWithTransition(\n        async () => {\n          const page = new routes['#/stories/add']();\n          this.#content.innerHTML = await page.render();\n          await page.afterRender?.();\n          if (page._presenter) this.#activePresenter = page._presenter;\n          this.#previousRoute = url;\n          this.#updateSidebar();\n        },\n        { direction: 'right' }\n      );\n      return;\n    }\n\n    // Other pages (left transition)\n    const PageClass = routes[url] || routes['#/404'];\n    await this.#renderWithTransition(\n      async () => {\n        const page = new PageClass();\n        this.#content.innerHTML = await page.render();\n        await page.afterRender?.();\n        if (page._presenter) this.#activePresenter = page._presenter;\n        this.#previousRoute = url;\n        this.#updateSidebar();\n      },\n      { direction: 'left' }\n    );\n  }\n\n  async #renderWithTransition(renderFn, { direction = 'left' } = {}) {\n    this.#showLoading();\n    try {\n      await document.startViewTransition(async () => {\n        await renderFn();\n        // Animate main content for better UX\n        if (\n          window.matchMedia('(prefers-reduced-motion: no-preference)').matches\n        ) {\n          const mainContent = document.getElementById('main-content');\n          if (mainContent) {\n            mainContent.animate(\n              direction === 'right'\n                ? [\n                    { transform: 'translateX(100%)', opacity: 0 },\n                    { transform: 'translateX(0)', opacity: 1 },\n                  ]\n                : [\n                    { transform: 'translateX(-50px)', opacity: 0 },\n                    { transform: 'translateX(0)', opacity: 1 },\n                  ],\n              { duration: 300, easing: 'ease-out' }\n            );\n          }\n        }\n      }).finished;\n    } catch (error) {\n      console.error('Error rendering page:', error);\n      this.#showErrorPage();\n    } finally {\n      this.#hideLoading();\n    }\n  }\n\n  #cleanupPreviousPage() {\n    // Stop camera if leaving Add Story page\n    if (\n      this.#previousRoute === '#/stories/add' &&\n      this.#activePresenter?.stopCamera\n    ) {\n      this.#activePresenter.stopCamera();\n    }\n    this.#activePresenter = null;\n  }\n\n  #setDocumentTitle(resource, id) {\n    const titles = {\n      stories: id ? 'Story Details' : 'Add Story',\n      login: 'Login',\n      register: 'Register',\n      about: 'About',\n      default: 'Home',\n    };\n    document.title = `Dicoding Story | ${titles[resource] || titles.default}`;\n  }\n\n  #showLoading() {\n    document.querySelector('app-loader')?.show();\n  }\n\n  #hideLoading() {\n    document.querySelector('app-loader')?.hide();\n  }\n\n  #showErrorPage() {\n    this.#content.innerHTML = `\n      <app-sidebar></app-sidebar>\n      <section class=\"container\">\n        <h1 class=\"page-title\">Error</h1>\n        <p>Gagal memuat halaman. Silakan coba lagi.</p>\n        <div class=\"flex gap-2 mt-3\">\n          <a href=\"#/\" class=\"back-link\">\n            <i class=\"fas fa-home\"></i>\n            Kembali ke Beranda\n          </a>\n          <button onclick=\"window.location.reload()\" class=\"back-link\" style=\"background-color: var(--danger)\">\n            <i class=\"fas fa-sync-alt\"></i>\n            Muat Ulang\n          </button>\n        </div>\n      </section>\n    `;\n  }\n\n  #updateSidebar() {\n    try {\n      const token = localStorage.getItem('accessToken');\n      const userData = localStorage.getItem('user');\n      if (token && userData && userData !== 'undefined') {\n        try {\n          window.dispatchEvent(\n            new CustomEvent('user-login-state-changed', {\n              detail: { isLoggedIn: true, userData: JSON.parse(userData) },\n            })\n          );\n        } catch {\n          localStorage.removeItem('user');\n          const defaultUserData = { name: 'User', email: '' };\n          localStorage.setItem('user', JSON.stringify(defaultUserData));\n          window.dispatchEvent(\n            new CustomEvent('user-login-state-changed', {\n              detail: { isLoggedIn: true, userData: defaultUserData },\n            })\n          );\n        }\n      } else {\n        window.dispatchEvent(\n          new CustomEvent('user-login-state-changed', {\n            detail: { isLoggedIn: false, userData: null },\n          })\n        );\n      }\n    } catch (error) {\n      console.error('Error updating sidebar:', error);\n    }\n  }\n}\n\nexport default App;\n","import '../styles/styles.css';\nimport App from './pages/app';\nimport CONFIG from './config';\nimport { subscribeUserToPush } from './utils/notification-helper';\nimport './components/header';\nimport './components/sidebar';\nimport './components/footer';\nimport './components/loader';\nimport './components/card';\n\n// Splash screen\nfunction showSplashScreen() {\n  const splashScreen = document.createElement('div');\n  splashScreen.className = 'splash-screen';\n\n  const logo = document.createElement('img');\n  logo.src = '/images/logo.png';\n  logo.alt = 'Dicoding Story Logo';\n  logo.className = 'splash-logo';\n\n  const title = document.createElement('div');\n  title.className = 'splash-title';\n  title.textContent = 'Dicoding Story';\n\n  const dotsContainer = document.createElement('div');\n  dotsContainer.className = 'splash-dots';\n\n  for (let i = 0; i < 3; i++) {\n    const dot = document.createElement('div');\n    dot.className = 'splash-dot';\n    dotsContainer.appendChild(dot);\n  }\n\n  splashScreen.appendChild(logo);\n  splashScreen.appendChild(title);\n  splashScreen.appendChild(dotsContainer);\n\n  document.body.appendChild(splashScreen);\n\n  return splashScreen;\n}\n\nfunction hideSplashScreen(splashScreen) {\n  splashScreen.style.opacity = '0';\n  setTimeout(() => {\n    splashScreen.style.visibility = 'hidden';\n    if (document.body.contains(splashScreen)) {\n      document.body.removeChild(splashScreen);\n    }\n  }, 600);\n}\n\n// View Transition API polyfill\nconst supportsViewTransitions = () =>\n  'startViewTransition' in document &&\n  !window.matchMedia('(prefers-reduced-motion: reduce)').matches;\n\nif (!supportsViewTransitions()) {\n  document.startViewTransition = (callback) => {\n    try {\n      const updateCallbackDone = Promise.resolve(callback());\n      return {\n        ready: Promise.resolve(),\n        updateCallbackDone,\n        finished: updateCallbackDone,\n      };\n    } catch (error) {\n      console.error('Error in startViewTransition callback:', error);\n      return {\n        ready: Promise.reject(error),\n        updateCallbackDone: Promise.reject(error),\n        finished: Promise.reject(error),\n      };\n    }\n  };\n}\n\n// Theme initialization\nfunction initTheme() {\n  const savedTheme = localStorage.getItem('theme');\n  if (savedTheme) {\n    document.documentElement.setAttribute('data-theme', savedTheme);\n  } else if (\n    window.matchMedia &&\n    window.matchMedia('(prefers-color-scheme: dark)').matches\n  ) {\n    document.documentElement.setAttribute('data-theme', 'dark');\n    localStorage.setItem('theme', 'dark');\n  }\n}\ninitTheme();\n\n// Main app initialization\nasync function initializeApp() {\n  const splashScreen = showSplashScreen();\n\n  setTimeout(async () => {\n    const appElement = document.querySelector('#app');\n    if (!appElement) {\n      console.error('App element not found');\n      hideSplashScreen(splashScreen);\n      return;\n    }\n\n    const app = new App({ content: appElement });\n\n    try {\n      await app.renderPage();\n      hideSplashScreen(splashScreen);\n      setupHeaderScrollEffect();\n      setupThemeModeToggle();\n      setupScrollAnimations();\n    } catch (error) {\n      console.error('Error loading initial page:', error);\n      hideSplashScreen(splashScreen);\n      appElement.innerHTML = `\n        <section class=\"container\">\n          <h1 class=\"page-title\">Error</h1>\n          <p>Gagal memuat halaman. Silakan coba lagi.</p>\n          <a href=\"#/\" class=\"back-link\">\n            <i class=\"fas fa-home\"></i>\n            Kembali ke Beranda\n          </a>\n        </section>\n      `;\n      window.showToast &&\n        window.showToast('Gagal memuat halaman, silakan coba lagi', 'error');\n    }\n\n    // Page transition on hashchange\n    window.addEventListener('hashchange', async () => {\n      try {\n        const loadingSpinner = document.createElement('div');\n        loadingSpinner.className = 'loading-spinner';\n        loadingSpinner.innerHTML = `\n          <div class=\"spinner-container\">\n            <div class=\"spinner-pulse\"></div>\n            <div class=\"spinner\"></div>\n          </div>\n          <div class=\"spinner-text\">Loading...</div>\n        `;\n        document.body.appendChild(loadingSpinner);\n\n        await app.renderPage();\n        setupScrollAnimations();\n        document.body.removeChild(loadingSpinner);\n      } catch (error) {\n        console.error('Error loading page:', error);\n        window.showToast && window.showToast('Gagal memuat halaman', 'error');\n      }\n    });\n\n    // Skip link accessibility\n    const skipLinkHandler = () => {\n      const skipLink = document.querySelector('.skip-link');\n      if (skipLink) {\n        skipLink.addEventListener('click', function (event) {\n          event.preventDefault();\n          const mainContent = document.querySelector('#main-content');\n          if (mainContent) {\n            skipLink.blur();\n            mainContent.focus();\n            mainContent.scrollIntoView({ behavior: 'smooth' });\n          }\n        });\n      }\n    };\n    skipLinkHandler();\n    window.addEventListener('hashchange', () =>\n      setTimeout(skipLinkHandler, 100)\n    );\n\n    // Custom install prompt (improvisasi UX)\n    let deferredPrompt;\n    const installContainer = document.createElement('div');\n    installContainer.id = 'install-container';\n    installContainer.classList.add('install-prompt');\n    installContainer.innerHTML = `\n      <div class=\"install-content\">\n        <img src=\"/images/logo.png\" alt=\"App icon\" width=\"48\" height=\"48\">\n        <div class=\"install-text\">\n          <h3>Install Dicoding Story</h3>\n          <p>Install aplikasi ini untuk pengalaman offline yang lebih baik!</p>\n        </div>\n        <div class=\"install-actions\">\n          <button id=\"install-button\" class=\"primary-button\">Install</button>\n          <button id=\"dismiss-button\" class=\"secondary-button\">Nanti</button>\n        </div>\n      </div>\n    `;\n    document.body.appendChild(installContainer);\n\n    window.addEventListener('beforeinstallprompt', (e) => {\n      e.preventDefault();\n      deferredPrompt = e;\n      setTimeout(() => {\n        installContainer.classList.add('show');\n      }, 3000);\n\n      document.getElementById('install-button').onclick = () => {\n        installContainer.classList.remove('show');\n        deferredPrompt.prompt();\n        deferredPrompt.userChoice.then((choiceResult) => {\n          if (choiceResult.outcome === 'accepted') {\n            window.showToast &&\n              window.showToast('Aplikasi sedang diinstall!', 'success');\n          }\n          deferredPrompt = null;\n        });\n      };\n\n      document.getElementById('dismiss-button').onclick = () => {\n        installContainer.classList.remove('show');\n      };\n    });\n\n    // Welcome toast\n    window.showToast &&\n      setTimeout(() => {\n        window.showToast('Selamat datang di Dicoding Story!', 'info');\n      }, 1000);\n  }, 1800);\n}\n\n// Header scroll effect\nfunction setupHeaderScrollEffect() {\n  const header = document.querySelector('header');\n  if (!header) return;\n  const scrollHandler = () => {\n    if (window.scrollY > 30) {\n      header.classList.add('scrolled');\n    } else {\n      header.classList.remove('scrolled');\n    }\n  };\n  scrollHandler();\n  window.addEventListener('scroll', scrollHandler);\n}\n\n// Theme toggle\nfunction setupThemeModeToggle() {\n  const savedTheme = localStorage.getItem('theme');\n  if (savedTheme) {\n    document.documentElement.setAttribute('data-theme', savedTheme);\n  }\n  const navList = document.querySelector('.nav-list');\n  if (navList && !document.getElementById('theme-toggle-item')) {\n    const themeToggleItem = document.createElement('li');\n    themeToggleItem.id = 'theme-toggle-item';\n    const currentTheme =\n      savedTheme ||\n      (window.matchMedia('(prefers-color-scheme: dark)').matches\n        ? 'dark'\n        : 'light');\n    themeToggleItem.innerHTML = `\n      <button id=\"theme-toggle\" aria-label=\"Toggle dark/light mode\">\n        <i class=\"fas ${currentTheme === 'dark' ? 'fa-sun' : 'fa-moon'}\" aria-hidden=\"true\"></i>\n        <span>${currentTheme === 'dark' ? 'Light Mode' : 'Dark Mode'}</span>\n      </button>\n    `;\n    const secondItem = navList.children[1];\n    if (secondItem) {\n      navList.insertBefore(themeToggleItem, secondItem.nextSibling);\n    } else {\n      navList.appendChild(themeToggleItem);\n    }\n    const themeToggle = document.getElementById('theme-toggle');\n    if (themeToggle) themeToggle.addEventListener('click', toggleTheme);\n  }\n}\n\nfunction toggleTheme() {\n  const currentTheme =\n    document.documentElement.getAttribute('data-theme') ||\n    (window.matchMedia('(prefers-color-scheme: dark)').matches\n      ? 'dark'\n      : 'light');\n  const newTheme = currentTheme === 'dark' ? 'light' : 'dark';\n  document.documentElement.setAttribute('data-theme', newTheme);\n  localStorage.setItem('theme', newTheme);\n  const themeToggle = document.getElementById('theme-toggle');\n  if (themeToggle) {\n    const icon = themeToggle.querySelector('i');\n    const text = themeToggle.querySelector('span');\n    if (icon)\n      icon.className = `fas ${newTheme === 'dark' ? 'fa-sun' : 'fa-moon'}`;\n    if (text)\n      text.textContent = newTheme === 'dark' ? 'Light Mode' : 'Dark Mode';\n  }\n  window.showToast &&\n    window.showToast(\n      `Switched to ${newTheme === 'dark' ? 'dark' : 'light'} mode`,\n      'info'\n    );\n}\n\n// Scroll-triggered animations\nfunction setupScrollAnimations() {\n  const animateOnScroll = () => {\n    const elements = document.querySelectorAll(\n      '.story-item, .page-title, .story-form, .auth-container'\n    );\n    elements.forEach((element) => {\n      const rect = element.getBoundingClientRect();\n      const isInViewport =\n        rect.top <=\n          (window.innerHeight || document.documentElement.clientHeight) *\n            0.85 && rect.bottom >= 0;\n      if (isInViewport) {\n        element.classList.add('visible');\n        if (element.classList.contains('story-item')) {\n          element.classList.add('animate__animated', 'animate__fadeInUp');\n          const index = Array.from(element.parentNode.children).indexOf(\n            element\n          );\n          element.style.animationDelay = `${index * 0.1}s`;\n        } else if (element.classList.contains('page-title')) {\n          element.classList.add('animate__animated', 'animate__fadeInDown');\n        } else {\n          element.classList.add('animate__animated', 'animate__fadeIn');\n        }\n      }\n    });\n  };\n  setTimeout(animateOnScroll, 100);\n  let scrollTimeout;\n  window.addEventListener('scroll', () => {\n    clearTimeout(scrollTimeout);\n    scrollTimeout = setTimeout(animateOnScroll, 20);\n  });\n}\n\ndocument.addEventListener('DOMContentLoaded', initializeApp);\n"],"names":["message","source","lineno","colno","error","_a","_b","type","duration","toastContainer","container","toast","icon","textSpan","closeBtn","connectionStatus","connectionMessage","hideTimeout","showStatus","updateConnectionStatus","CONFIG","DicodingStoryApi","url","options","retryAttempt","controller","signal","mergedOptions","timeout","response","errorData","errorMessage","resolve","reject","xhr","key","event","percentComplete","name","email","password","result","token","page","size","location","id","data","onProgress","subscription","endpoint","_c","showFormattedDate","date","locale","defaultOptions","truncateText","text","maxLength","debounce","func","wait","immediate","args","context","later","callNow","formatFileSize","bytes","sizes","i","validateEmail","getInitials","part","isOnline","AppHeader","isLoggedIn","user","userData","drawerButton","navigationDrawer","e","isOpen","firstNavItem","userMenu","userInfo","dropdown","isExpanded","firstItem","logoutButton","notificationToggle","notificationStatus","statusIndicator","hasSubscription","originalText","permission","registration","existingSubscription","keys","AppSidebar","userInitials","colors","hash","toggleButton","sidebar","overlay","closeButton","link","savedLink","route","currentRoute","AppFooter","currentYear","yearElement","AppLoader","oldValue","newValue","withTimeout","messageElement","instanceOfAny","object","constructors","c","idbProxyableTypes","cursorAdvanceMethods","getIdbProxyableTypes","getCursorAdvanceMethods","transactionDoneMap","transformCache","reverseTransformCache","promisifyRequest","request","promise","unlisten","success","wrap","cacheDonePromiseForTransaction","tx","done","complete","idbProxyTraps","target","prop","receiver","value","replaceTraps","callback","wrapFunction","unwrap","transformCachableValue","openDB","version","blocked","upgrade","blocking","terminated","openPromise","db","readMethods","writeMethods","cachedMethods","getMethod","targetFuncName","useIndex","isWrite","method","storeName","oldTraps","advanceMethodProps","methodMap","advanceResults","ittrProxiedCursorToOriginalProxy","cursorIteratorTraps","cachedFunc","iterate","cursor","proxiedCursor","isIteratorProp","DB_NAME","DB_VERSION","STORE_NAME","FAVORITES_STORE","getDb","saveStories","stories","story","getAllStories","getStoryById","deleteStory","clearStories","addToFavorites","removeFromFavorites","getFavorites","isFavorite","clearFavorites","bulkSaveFavorites","favorites","fav","IdbHelper","AppCard","formattedDate","titleId","descId","userColor","getUserColor","isSaved","favoritesJson","saveBtn","_d","lat","lon","storyId","storyName","storyDescription","mapElement","map","customIcon","observer","entries","entry","acc","char","HomePresenter","view","__privateAdd","_HomePresenter_instances","_view","_page","_hasMoreData","_isLoading","_includeLocation","__privateSet","__privateGet","__privateMethod","setupEventListeners_fn","loadInitialStories_fn","loadMoreStories_fn","isChecked","cachedStories","HomePage","loadMoreButton","locationFilter","scrollY","visible","pageHeight","mainContent","skipLink","storiesList","index","card","validStories","hasMore","AboutPage","LoginPage","form","rememberMe","loader","emailInput","passwordInput","isEmailValid","isPasswordValid","errorElement","rememberedEmail","rememberCheckbox","RegisterPage","nameInput","isNameValid","StoryDetailPresenter","cachedStory","apiError","delay","mapContainer","baseMaps","description","popup","cacheData","updatedCache","item","limitedCache","cachedStoryJson","parsedStory","cachedStoriesJson","foundStory","shareData","StoryDetailPage","storyContent","storyPhoto","storyCreatedAt","storyTitleId","storyDescId","offlineNotice","match","initialState","favoriteButton","newState","shareButton","article","AddPresenter","__publicField","recentsJson","recents","draftId","draft","d","draftTimeout","descriptionInput","draftsJson","drafts","preview","newDraft","permissionStatus","cameraButton","track","stream","fallbackStream","dataUrl","filename","file","arr","mimeMatch","mime","bstr","n","u8arr","formData","progress","word","isDescriptionValid","isPhotoValid","photoInput","photoPreview","geocoder","lng","position","latitude","longitude","geocoderControl","searchButton","searchInput","query","locations","loc","opt","selectedOption","locationText","results","locationName","AddStoryPage","textarea","charCount","count","html","btn","openCameraButton","takePhotoButton","cameraContainer","videoElement","canvas","flash","reader","photoError","locationCheckbox","locateMeButton","searchLocationButton","latInput","lonInput","photoFile","useLocation","descriptionError","submitButton","percent","progressBar","confettiSettings","NotFoundPage","reloadBtn","extractPathnameSegments","path","splitUrl","getActivePathname","getActiveRoute","resource","isAddPage","parseActivePathname","ACCESS_TOKEN_KEY","getAccessToken","accessToken","SavedPage","favoritesContainer","idx","injectBadge","header","badge","removeBtn","favoritesArr","injectRemoveBtn","actions","errorContainer","dateString","routes","SavedStoriesPage","App","content","_App_instances","_content","_activePresenter","_previousRoute","updateSidebar_fn","cleanupPreviousPage_fn","setDocumentTitle_fn","renderWithTransition_fn","PageClass","renderFn","direction","showLoading_fn","showErrorPage_fn","hideLoading_fn","titles","defaultUserData","showSplashScreen","splashScreen","logo","title","dotsContainer","dot","hideSplashScreen","supportsViewTransitions","updateCallbackDone","initTheme","savedTheme","initializeApp","appElement","app","setupHeaderScrollEffect","setupThemeModeToggle","setupScrollAnimations","loadingSpinner","skipLinkHandler","deferredPrompt","installContainer","choiceResult","scrollHandler","navList","themeToggleItem","currentTheme","secondItem","themeToggle","toggleTheme","newTheme","animateOnScroll","element","rect","scrollTimeout"],"mappings":"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","x_google_ignoreList":[9]}