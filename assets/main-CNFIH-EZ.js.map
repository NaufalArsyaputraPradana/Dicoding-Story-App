{"version":3,"file":"main-CNFIH-EZ.js","sources":["../../src/scripts/error-handler.js","../../src/scripts/connection-monitor.js","../../src/scripts/config.js","../../src/scripts/data/api.js","../../src/scripts/components/header.js","../../src/scripts/utils/index.js","../../src/scripts/components/card.js","../../src/scripts/components/loader.js","../../src/scripts/components/footer.js","../../src/scripts/components/sidebar.js","../../node_modules/idb/build/index.js","../../src/scripts/idb.js","../../src/scripts/presenter/home-presenter.js","../../src/scripts/pages/home-page.js","../../src/scripts/pages/about-page.js","../../src/scripts/pages/login-page.js","../../src/scripts/pages/register-page.js","../../src/scripts/presenter/story-detail-presenter.js","../../src/scripts/pages/story-detail-page.js","../../src/scripts/presenter/add-story-presenter.js","../../src/scripts/pages/add-story-page.js","../../src/scripts/pages/not-found-page.js","../../src/scripts/pages/saved-stories-page.js","../../src/scripts/routes/routes.js","../../src/scripts/routes/url-parser.js","../../src/scripts/app.js","../../src/scripts/notification-helper.js","../../src/scripts/index.js"],"sourcesContent":["(function () {\n  window.onerror = function (message, source, lineno, colno, error) {\n    console.error('Global error caught:', {\n      message,\n      source,\n      lineno,\n      colno,\n      error,\n    });\n\n    if (message.includes('Cannot read properties of undefined')) {\n      console.error('Property access error detected. Details:', {\n        message,\n        source,\n        lineno,\n        colno,\n      });\n\n      if (!window.hasShownErrorMessage) {\n        window.hasShownErrorMessage = true;\n        setTimeout(() => {\n          window.hasShownErrorMessage = false;\n        }, 5000);\n\n        if (!window.location.hash.includes('error')) {\n          window.showToast(\n            'Terjadi kesalahan saat menampilkan konten. Kami akan mencoba memperbaikinya secara otomatis.',\n            'warning'\n          );\n        }\n      }\n      return true;\n    }\n    return false;\n  };\n\n  window.showToast = function (message, type = 'info') {\n    const toastContainer = document.getElementById('toast-container');\n    if (!toastContainer) return;\n\n    const toast = document.createElement('div');\n    toast.className = `toast toast-${type}`;\n    toast.setAttribute('role', 'alert');\n\n    const icon = document.createElement('i');\n    icon.className = `fas ${\n      type === 'success'\n        ? 'fa-check-circle'\n        : type === 'error'\n          ? 'fa-exclamation-circle'\n          : type === 'warning'\n            ? 'fa-exclamation-triangle'\n            : 'fa-info-circle'\n    }`;\n    icon.setAttribute('aria-hidden', 'true');\n\n    const textSpan = document.createElement('span');\n    textSpan.textContent = message;\n\n    toast.appendChild(icon);\n    toast.appendChild(textSpan);\n    toastContainer.appendChild(toast);\n\n    requestAnimationFrame(() => {\n      setTimeout(() => {\n        toast.classList.add('show');\n      }, 10);\n    });\n\n    setTimeout(() => {\n      toast.classList.remove('show');\n      setTimeout(() => {\n        if (toastContainer.contains(toast)) {\n          toastContainer.removeChild(toast);\n        }\n      }, 300);\n    }, 5000);\n  };\n})();\n","(function () {\n  const connectionStatus = document.getElementById('connection-status');\n  const connectionMessage = document.getElementById('connection-message');\n\n  if (!connectionStatus || !connectionMessage) return;\n\n  function updateConnectionStatus() {\n    if (navigator.onLine) {\n      connectionStatus.classList.add('online');\n      connectionStatus.classList.remove('offline');\n      connectionMessage.textContent = 'Koneksi telah pulih';\n      setTimeout(() => {\n        connectionStatus.classList.add('hidden');\n      }, 3000);\n    } else {\n      connectionStatus.classList.remove('online');\n      connectionStatus.classList.add('offline');\n      connectionStatus.classList.remove('hidden');\n      connectionMessage.textContent = 'Anda sedang offline';\n    }\n  }\n\n  updateConnectionStatus();\n\n  window.addEventListener('online', updateConnectionStatus);\n  window.addEventListener('offline', updateConnectionStatus);\n})();\n","const CONFIG = {\n  BASE_URL: 'https://story-api.dicoding.dev/v1',\n  DEFAULT_LANGUAGE: 'id-ID',\n  CACHE_NAME: 'DicodingStory-V5',\n  DATABASE_NAME: 'dicoding-story-database',\n  DATABASE_VERSION: 1,\n  OBJECT_STORE_NAME: 'stories',\n  DEFAULT_MAP_CENTER: [-6.1754, 106.8272], // Jakarta coordinates\n  DEFAULT_MAP_ZOOM: 13,\n  PAGE_SIZE: 10,\n  API_TIMEOUT: 30000,\n  API_RETRY_ATTEMPTS: 2,\n  API_RETRY_DELAY: 1000,\n  MAX_PHOTO_SIZE: 5 * 1024 * 1024, // 5MB\n  MAP_TILE_LAYERS: {\n    osm: {\n      url: 'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\n      attribution:\n        '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\n      name: 'OpenStreetMap',\n    },\n    satellite: {\n      url: 'https://api.maptiler.com/maps/hybrid/{z}/{x}/{y}.jpg?key=WlHVW3GmIbcYKHpoc75N',\n      attribution:\n        '<a href=\"https://www.maptiler.com/copyright/\" target=\"_blank\">&copy; MapTiler</a> <a href=\"https://www.openstreetmap.org/copyright\" target=\"_blank\">&copy; OpenStreetMap contributors</a>',\n      name: 'Satellite',\n    },\n    dark: {\n      url: 'https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png',\n      attribution:\n        '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors &copy; <a href=\"https://carto.com/attributions\">CARTO</a>',\n      name: 'Dark Mode',\n    },\n  },\n  VAPID_PUBLIC_KEY:\n    'BCCs2eonMI-6H2ctvFaWg-UYdDv387Vno_bzUzALpB442r2lCnsHmtrx8biyPi_E-1fSGABK_Qs_GlvPoJJqxbk',\n  SERVICE_WORKER_PATH: './sw.js',\n  OFFLINE_PAGE: './offline.html',\n};\n\nexport default CONFIG;\n","import CONFIG from '../config';\n\nclass DicodingStoryApi {\n  static async _fetchWithTimeout(url, options = {}, retryAttempt = 0) {\n    const controller = new AbortController();\n    const { signal } = controller;\n    const mergedOptions = {\n      ...options,\n      signal,\n      // Add mode 'cors' explicitly to handle CORS properly\n      mode: 'cors',\n      // Add credentials if needed for cross-origin requests\n      credentials: 'same-origin',\n    };\n\n    const timeout = setTimeout(() => {\n      controller.abort();\n    }, CONFIG.API_TIMEOUT);\n\n    try {\n      // Add progress tracking for uploads if body is FormData\n      if (\n        options.body instanceof FormData &&\n        options.onProgress &&\n        options.method === 'POST'\n      ) {\n        return await this._uploadWithProgress(url, options);\n      }\n\n      const response = await fetch(url, mergedOptions);\n\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({}));\n        let errorMessage =\n          errorData.message || `HTTP error! status: ${response.status}`;\n\n        // Provide more user-friendly messages for common HTTP errors\n        if (response.status === 400) {\n          errorMessage =\n            errorData.message ||\n            'Bad Request: The server could not process your request.';\n\n          // Create a custom error object with status code and message\n          const error = new Error(errorMessage);\n          error.status = response.status;\n          error.data = errorData;\n          throw error;\n        } else if (response.status === 401) {\n          errorMessage = 'Your session has expired. Please login again.';\n          // Redirect to login if unauthorized\n          setTimeout(() => {\n            window.location.hash = '#/login';\n          }, 2000);\n        } else if (response.status === 403) {\n          errorMessage = \"You don't have permission to perform this action.\";\n        } else if (response.status === 404) {\n          errorMessage = 'The requested resource was not found.';\n        } else if (response.status === 413) {\n          errorMessage = 'The file you are trying to upload is too large.';\n        } else if (response.status >= 500) {\n          errorMessage = 'Server error. Please try again later.';\n        }\n\n        throw new Error(errorMessage);\n      }\n\n      // Transform response to JSON\n      const result = await response.json();\n      return result;\n    } catch (error) {\n      if (error.name === 'AbortError') {\n        console.warn(`Request timed out: ${url}`);\n        if (retryAttempt < CONFIG.API_RETRY_ATTEMPTS) {\n          console.log(\n            `Retrying request (${retryAttempt + 1}/${CONFIG.API_RETRY_ATTEMPTS})...`\n          );\n          await new Promise((resolve) =>\n            setTimeout(resolve, CONFIG.API_RETRY_DELAY)\n          );\n          return this._fetchWithTimeout(url, options, retryAttempt + 1);\n        }\n        throw new Error(\n          'Request timed out. Please check your internet connection and try again.'\n        );\n      }\n\n      // Network errors or CORS errors\n      if (\n        error.message === 'Failed to fetch' ||\n        error.message.includes('NetworkError') ||\n        error.message.includes('CORS')\n      ) {\n        console.error('Network or CORS error:', error);\n\n        // For notification endpoints specifically, handle silently without showing error UI\n        if (url.includes('/notifications/')) {\n          console.warn(\n            'Notification API request failed - this is expected in development environment'\n          );\n          return { status: 'failed', error: error.message };\n        }\n\n        if (window.showToast) {\n          window.showToast(\n            'Network connection issue. Please check your internet connection.',\n            'warning'\n          );\n        }\n      }\n\n      throw error;\n    } finally {\n      clearTimeout(timeout);\n    }\n  }\n\n  static async _uploadWithProgress(url, options) {\n    return new Promise((resolve, reject) => {\n      const xhr = new XMLHttpRequest();\n      xhr.open(options.method || 'POST', url);\n\n      // Set headers\n      if (options.headers) {\n        Object.keys(options.headers).forEach((key) => {\n          xhr.setRequestHeader(key, options.headers[key]);\n        });\n      }\n\n      // Handle progress\n      xhr.upload.addEventListener('progress', (event) => {\n        if (event.lengthComputable && options.onProgress) {\n          const percentComplete = Math.round(\n            (event.loaded / event.total) * 100\n          );\n          options.onProgress(percentComplete);\n        }\n      });\n\n      // Handle completion\n      xhr.addEventListener('load', () => {\n        if (xhr.status >= 200 && xhr.status < 300) {\n          try {\n            const response = JSON.parse(xhr.responseText);\n            resolve(response);\n          } catch (e) {\n            reject(new Error('Invalid response format from server'));\n          }\n        } else {\n          try {\n            const errorData = JSON.parse(xhr.responseText);\n            reject(\n              new Error(\n                errorData.message || `HTTP error! status: ${xhr.status}`\n              )\n            );\n          } catch (e) {\n            reject(new Error(`HTTP error! status: ${xhr.status}`));\n          }\n        }\n      });\n\n      // Handle errors\n      xhr.addEventListener('error', () => {\n        reject(new Error('Network error occurred'));\n      });\n\n      xhr.addEventListener('abort', () => {\n        reject(new Error('Upload aborted'));\n      });\n\n      xhr.addEventListener('timeout', () => {\n        reject(new Error('Upload timed out'));\n      });\n\n      // Send the request\n      xhr.send(options.body);\n    });\n  }\n\n  static async register({ name, email, password }) {\n    this._validateEmail(email);\n    this._validatePassword(password);\n\n    try {\n      const result = await this._fetchWithTimeout(\n        `${CONFIG.BASE_URL}/register`,\n        {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({ name, email, password }),\n        }\n      );\n\n      if (window.showToast) {\n        window.showToast('Registrasi berhasil! Silakan login.', 'success');\n      }\n\n      return result;\n    } catch (error) {\n      // Registration-specific error handling\n      if (error.message.includes('email is already taken')) {\n        throw new Error('Email sudah digunakan. Silakan gunakan email lain.');\n      }\n      throw error;\n    }\n  }\n\n  static async login({ email, password }) {\n    this._validateEmail(email);\n\n    try {\n      const result = await this._fetchWithTimeout(`${CONFIG.BASE_URL}/login`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ email, password }),\n      });\n\n      if (window.showToast) {\n        window.showToast(\n          `Selamat datang kembali, ${result.loginResult.name}!`,\n          'success'\n        );\n      }\n\n      return result;\n    } catch (error) {\n      // Login-specific error handling\n      if (\n        error.message.includes('user not found') ||\n        error.message.includes('password')\n      ) {\n        throw new Error('Email atau password salah. Silakan coba lagi.');\n      }\n      throw error;\n    }\n  }\n\n  static async getAllStories({\n    token,\n    page = 1,\n    size = CONFIG.PAGE_SIZE,\n    location = 0,\n  }) {\n    this._validateToken(token);\n\n    try {\n      console.log(\n        `Fetching stories data: page=${page}, size=${size}, location=${location}`\n      );\n      const response = await this._fetchWithTimeout(\n        `${CONFIG.BASE_URL}/stories?page=${page}&size=${size}&location=${location}`,\n        {\n          headers: { Authorization: `Bearer ${token}` },\n        }\n      );\n\n      // Pastikan data valid dan berformat yang diharapkan\n      if (!response || !response.listStory) {\n        console.error('Invalid response format from API:', response);\n        throw new Error('Format respons dari server tidak valid');\n      }\n\n      console.log(`Successfully fetched ${response.listStory.length} stories`);\n      return response;\n    } catch (error) {\n      console.error('Error fetching stories:', error);\n      // Bila terjadi kesalahan, tampilkan toast pesan error\n      if (window.showToast) {\n        window.showToast('Gagal memuat cerita. ' + error.message, 'error');\n      }\n      throw error;\n    }\n  }\n\n  static async getStoryDetail({ token, id }) {\n    this._validateToken(token);\n\n    if (!id) {\n      throw new Error('ID cerita tidak valid');\n    }\n\n    return this._fetchWithTimeout(`${CONFIG.BASE_URL}/stories/${id}`, {\n      headers: { Authorization: `Bearer ${token}` },\n    });\n  }\n\n  static async addNewStory({ token, data, onProgress }) {\n    this._validateToken(token);\n\n    try {\n      // Validate that data contains required fields\n      if (!data.has('description')) {\n        throw new Error('Description is required');\n      }\n\n      if (!data.has('photo')) {\n        throw new Error('Photo is required');\n      }\n\n      // Create options with progress tracking\n      const options = {\n        method: 'POST',\n        headers: { Authorization: `Bearer ${token}` },\n        body: data,\n        onProgress: onProgress, // Pass the progress callback\n      };\n\n      const result = await this._fetchWithTimeout(\n        `${CONFIG.BASE_URL}/stories`,\n        options\n      );\n\n      if (window.showToast) {\n        window.showToast('Cerita berhasil ditambahkan!', 'success');\n      }\n\n      return result;\n    } catch (error) {\n      console.error('Error adding story:', error);\n\n      // Handle common errors with more user-friendly messages\n      if (error.message.includes('photo')) {\n        throw new Error(\n          'Gagal mengunggah foto. Pastikan ukuran foto tidak melebihi 5MB.'\n        );\n      } else if (error.status === 400) {\n        throw new Error(\n          'Bad request: Pastikan semua data yang dikirim valid (foto dan deskripsi wajib diisi).'\n        );\n      } else if (\n        error.message.includes('Network') ||\n        error.message.includes('timeout')\n      ) {\n        throw new Error(\n          'Koneksi gagal. Periksa koneksi internet Anda dan coba lagi.'\n        );\n      }\n\n      // If it's another error, rethrow it\n      throw error;\n    }\n  }\n\n  static async subscribeNotification({ token, subscription }) {\n    this._validateToken(token);\n\n    try {\n      const result = await this._fetchWithTimeout(\n        `${CONFIG.BASE_URL}/notifications/subscribe`,\n        {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n            Authorization: `Bearer ${token}`,\n          },\n          body: JSON.stringify(subscription),\n        }\n      );\n\n      if (window.showToast) {\n        window.showToast('Notifikasi berhasil diaktifkan!', 'success');\n      }\n\n      return result;\n    } catch (error) {\n      console.error('Error subscribing to notifications:', error);\n      window.showToast &&\n        window.showToast('Gagal mengaktifkan notifikasi', 'error');\n      throw error;\n    }\n  }\n\n  static async unsubscribeNotification({ token, endpoint }) {\n    this._validateToken(token);\n\n    if (!endpoint) {\n      throw new Error('Endpoint notifikasi tidak valid');\n    }\n\n    try {\n      // Check if we're in development environment\n      const isDev =\n        window.location.hostname === 'localhost' ||\n        window.location.hostname === '127.0.0.1';\n\n      if (isDev) {\n        console.log(\n          'Development environment detected - skipping actual notification unsubscribe request'\n        );\n\n        if (window.showToast) {\n          window.showToast(\n            'Notifikasi berhasil dinonaktifkan (dev mode)',\n            'info'\n          );\n        }\n\n        return {\n          success: true,\n          message: 'Unsubscribed from notifications (development mock)',\n        };\n      }\n\n      //  endpoint di sini:\n      const result = await this._fetchWithTimeout(\n        `${CONFIG.BASE_URL}/notifications/subscribe`,\n        {\n          method: 'DELETE',\n          headers: {\n            'Content-Type': 'application/json',\n            Authorization: `Bearer ${token}`,\n          },\n          body: JSON.stringify({ endpoint }),\n        }\n      );\n\n      if (window.showToast) {\n        window.showToast('Notifikasi berhasil dinonaktifkan', 'info');\n      }\n\n      return result;\n    } catch (error) {\n      console.error('Error unsubscribing from notifications:', error);\n\n      // In development environment, don't show error toast for expected CORS issues\n      if (\n        !(\n          window.location.hostname === 'localhost' ||\n          window.location.hostname === '127.0.0.1'\n        )\n      ) {\n        window.showToast &&\n          window.showToast('Gagal menonaktifkan notifikasi', 'error');\n      }\n\n      throw error;\n    }\n  }\n\n  static _validateToken(token) {\n    if (!token) {\n      throw new Error('Autentikasi diperlukan. Silakan login terlebih dahulu.');\n    }\n  }\n\n  static _validateEmail(email) {\n    const re = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n    if (!re.test(email)) {\n      throw new Error('Silakan masukkan alamat email yang valid');\n    }\n  }\n\n  static _validatePassword(password) {\n    if (password.length < 8) {\n      throw new Error('Password harus minimal 8 karakter');\n    }\n  }\n}\n\nexport default DicodingStoryApi;\n","import DicodingStoryApi from '../data/api';\nimport CONFIG from '../config';\n\nclass AppHeader extends HTMLElement {\n  connectedCallback() {\n    this.render();\n    this.setupEventListeners();\n    this.checkNotificationPermission();\n  }\n\n  render() {\n    const isLoggedIn = localStorage.getItem('token') !== null;\n    let user = null;\n\n    try {\n      const userData = localStorage.getItem('user');\n      if (userData && userData !== 'undefined') {\n        user = JSON.parse(userData);\n      }\n    } catch (error) {\n      console.error('Failed to parse user data:', error);\n      // Remove invalid data\n      localStorage.removeItem('user');\n    }\n\n    this.innerHTML = `\n      <header>\n        <div class=\"container main-header\">\n          <a class=\"brand-name\" href=\"#/\" aria-label=\"Home\">\n            <img src=\"/images/logo.png\" alt=\"Dicoding Story Logo\" width=\"32\" height=\"32\">\n            Dicoding Story\n          </a>\n          \n          <nav id=\"navigation-drawer\" class=\"navigation-drawer\" aria-label=\"Main navigation\">\n            <ul id=\"nav-list\" class=\"nav-list\">\n              <li>\n                <a href=\"#/\" class=\"${window.location.hash === '#/' ? 'active' : ''}\" aria-current=\"${window.location.hash === '#/' ? 'page' : 'false'}\">\n                  <i class=\"fas fa-home\" aria-hidden=\"true\"></i>\n                  Home\n                </a>\n              </li>\n              <li>\n                <a href=\"#/about\" class=\"${window.location.hash === '#/about' ? 'active' : ''}\" aria-current=\"${window.location.hash === '#/about' ? 'page' : 'false'}\">\n                  <i class=\"fas fa-info-circle\" aria-hidden=\"true\"></i>\n                  About\n                </a>\n              </li>\n              ${\n                isLoggedIn\n                  ? `\n                    <li>\n                      <a href=\"#/stories/add\" class=\"${window.location.hash === '#/stories/add' ? 'active' : ''}\" aria-current=\"${window.location.hash === '#/stories/add' ? 'page' : 'false'}\">\n                        <i class=\"fas fa-plus-circle\" aria-hidden=\"true\"></i>\n                        Add Story\n                      </a>\n                    </li>\n                    <li>\n                      <a href=\"#/saved\" class=\"${window.location.hash === '#/saved' ? 'active' : ''}\" aria-current=\"${window.location.hash === '#/saved' ? 'page' : 'false'}\">\n                        <i class=\"fas fa-database\" aria-hidden=\"true\"></i>\n                        Saved Stories\n                      </a>\n                    </li>\n                    <li class=\"user-menu\">\n                      <div class=\"user-info\" tabindex=\"0\" aria-haspopup=\"true\" aria-expanded=\"false\">\n                        <div class=\"user-avatar\" aria-hidden=\"true\">${getInitials(user?.name)}</div>\n                        <span>${user?.name || 'User'}</span>\n                        <i class=\"fas fa-chevron-down ml-1\" aria-hidden=\"true\"></i>\n                      </div>\n                      <ul class=\"user-dropdown\" role=\"menu\" style=\"display: none;\">\n                        <li role=\"none\">\n                          <button id=\"notification-toggle\" class=\"dropdown-button notification-toggle\" role=\"menuitem\">\n                            <i class=\"fas fa-bell\" aria-hidden=\"true\"></i>\n                            <span id=\"notification-status\">Enable Notifications</span>\n                            <span class=\"status-indicator\"></span>\n                          </button>\n                        </li>\n                        <li role=\"none\">\n                          <button id=\"logout-button\" class=\"dropdown-button logout-button\" role=\"menuitem\">\n                            <i class=\"fas fa-sign-out-alt\" aria-hidden=\"true\"></i>\n                            Logout\n                          </button>\n                        </li>\n                      </ul>\n                    </li>\n                  `\n                  : `\n                    <li>\n                      <a href=\"#/login\" class=\"${window.location.hash === '#/login' ? 'active' : ''}\" aria-current=\"${window.location.hash === '#/login' ? 'page' : 'false'}\">\n                        <i class=\"fas fa-sign-in-alt\" aria-hidden=\"true\"></i>\n                        Login\n                      </a>\n                    </li>\n                    <li>\n                      <a href=\"#/register\" class=\"${window.location.hash === '#/register' ? 'active' : ''}\" aria-current=\"${window.location.hash === '#/register' ? 'page' : 'false'}\">\n                        <i class=\"fas fa-user-plus\" aria-hidden=\"true\"></i>\n                        Register\n                      </a>\n                    </li>\n                  `\n              }\n            </ul>\n          </nav>\n          \n          <button id=\"drawer-button\" class=\"drawer-button\" aria-label=\"Toggle navigation\" aria-expanded=\"false\" aria-controls=\"navigation-drawer\">\n            <i class=\"fas fa-bars\" aria-hidden=\"true\"></i>\n          </button>\n        </div>\n      </header>\n    `;\n  }\n\n  setupEventListeners() {\n    this._setupDrawerToggle();\n    this._setupUserMenu();\n    this._setupLogoutButton();\n    this._setupNotificationToggle();\n    this._setupThemeToggle();\n  }\n\n  _setupDrawerToggle() {\n    const drawerButton = this.querySelector('#drawer-button');\n    const navigationDrawer = this.querySelector('#navigation-drawer');\n\n    if (!drawerButton || !navigationDrawer) return;\n\n    drawerButton.addEventListener('click', (e) => {\n      e.stopPropagation();\n      const isOpen = navigationDrawer.classList.toggle('open');\n      drawerButton.setAttribute('aria-expanded', isOpen);\n\n      if (isOpen) {\n        const firstNavItem = navigationDrawer.querySelector('a');\n        if (firstNavItem) firstNavItem.focus();\n      }\n    });\n\n    document.addEventListener('click', (event) => {\n      if (!navigationDrawer.contains(event.target)) {\n        navigationDrawer.classList.remove('open');\n        drawerButton.setAttribute('aria-expanded', 'false');\n      }\n    });\n\n    document.addEventListener('keydown', (event) => {\n      if (event.key === 'Escape') {\n        navigationDrawer.classList.remove('open');\n        drawerButton.setAttribute('aria-expanded', 'false');\n        drawerButton.focus();\n      }\n    });\n  }\n\n  _setupUserMenu() {\n    const userMenu = this.querySelector('.user-menu');\n    if (!userMenu) return;\n\n    const userInfo = userMenu.querySelector('.user-info');\n    const dropdown = userMenu.querySelector('.user-dropdown');\n\n    userInfo.addEventListener('click', (e) => {\n      e.stopPropagation();\n      const isExpanded = userInfo.getAttribute('aria-expanded') === 'true';\n      userInfo.setAttribute('aria-expanded', !isExpanded);\n      dropdown.style.display = isExpanded ? 'none' : 'block';\n    });\n\n    document.addEventListener('click', () => {\n      userInfo.setAttribute('aria-expanded', 'false');\n      dropdown.style.display = 'none';\n    });\n\n    userInfo.addEventListener('keydown', (e) => {\n      if (e.key === 'Enter' || e.key === ' ') {\n        e.preventDefault();\n        const isExpanded = userInfo.getAttribute('aria-expanded') === 'true';\n        userInfo.setAttribute('aria-expanded', !isExpanded);\n        dropdown.style.display = isExpanded ? 'none' : 'block';\n\n        if (!isExpanded) {\n          const firstItem = dropdown.querySelector('button');\n          if (firstItem) firstItem.focus();\n        }\n      }\n    });\n  }\n\n  _setupThemeToggle() {\n    const themeToggle = this.querySelector('#theme-toggle');\n    if (!themeToggle) return;\n\n    // Check current theme\n    const isDark =\n      document.documentElement.getAttribute('data-theme') === 'dark';\n    const themeIcon = themeToggle.querySelector('i');\n    const themeText = themeToggle.querySelector('span');\n\n    if (isDark) {\n      themeIcon.classList.replace('fa-moon', 'fa-sun');\n      themeText.textContent = 'Light Mode';\n    }\n\n    themeToggle.addEventListener('click', () => {\n      const isDarkMode =\n        document.documentElement.getAttribute('data-theme') === 'dark';\n      const newTheme = isDarkMode ? 'light' : 'dark';\n\n      document.documentElement.setAttribute('data-theme', newTheme);\n      localStorage.setItem('theme', newTheme);\n\n      // Update icon and text\n      const icon = themeToggle.querySelector('i');\n      const text = themeToggle.querySelector('span');\n\n      if (newTheme === 'dark') {\n        icon.classList.replace('fa-moon', 'fa-sun');\n        text.textContent = 'Light Mode';\n      } else {\n        icon.classList.replace('fa-sun', 'fa-moon');\n        text.textContent = 'Dark Mode';\n      }\n\n      // Show toast notification\n      if (window.showToast) {\n        window.showToast(\n          `${newTheme === 'dark' ? 'Dark' : 'Light'} mode activated`,\n          'info'\n        );\n      }\n    });\n  }\n\n  _setupLogoutButton() {\n    const logoutButton = this.querySelector('#logout-button');\n    if (!logoutButton) return;\n\n    logoutButton.addEventListener('click', () => {\n      Swal.fire({\n        title: 'Logout',\n        text: 'Are you sure you want to logout?',\n        icon: 'question',\n        showCancelButton: true,\n        confirmButtonColor: '#4361ee',\n        cancelButtonColor: '#f72585',\n        confirmButtonText: 'Yes, Logout',\n        cancelButtonText: 'Cancel',\n        focusCancel: true,\n      }).then((result) => {\n        if (result.isConfirmed) {\n          // Unsubscribe from notifications when logging out to clean up\n          this._cleanupNotifications();\n\n          localStorage.removeItem('token');\n          localStorage.removeItem('user');\n\n          if (window.showToast) {\n            window.showToast('Logout successful', 'success');\n          }\n\n          window.location.hash = '#/login';\n        }\n      });\n    });\n  }\n\n  async _cleanupNotifications() {\n    if (!('serviceWorker' in navigator) || !('PushManager' in window)) {\n      return;\n    }\n\n    try {\n      const registration = await navigator.serviceWorker.ready;\n      const subscription = await registration.pushManager.getSubscription();\n\n      if (subscription) {\n        await subscription.unsubscribe();\n        console.log('Cleaned up push subscription on logout');\n      }\n    } catch (error) {\n      console.error('Error cleaning up notifications on logout:', error);\n    }\n  }\n\n  async checkNotificationPermission() {\n    const notificationToggle = this.querySelector('#notification-toggle');\n    const notificationStatus = this.querySelector('#notification-status');\n    const statusIndicator = this.querySelector('.status-indicator');\n\n    if (!notificationToggle || !notificationStatus || !statusIndicator) return;\n\n    if (Notification.permission === 'granted') {\n      // Check if we actually have an active subscription\n      const hasSubscription = await this._checkActiveSubscription();\n\n      if (hasSubscription) {\n        notificationStatus.textContent = 'Disable Notifications';\n        statusIndicator.classList.add('active');\n        notificationToggle.classList.add('enabled');\n      } else {\n        notificationStatus.textContent = 'Enable Notifications';\n        statusIndicator.classList.remove('active');\n        notificationToggle.classList.remove('enabled');\n      }\n    } else if (Notification.permission === 'denied') {\n      notificationStatus.textContent = 'Notifications Blocked';\n      notificationToggle.disabled = true;\n      notificationToggle.classList.add('blocked');\n      statusIndicator.classList.add('blocked');\n    } else {\n      notificationStatus.textContent = 'Enable Notifications';\n      statusIndicator.classList.remove('active');\n      notificationToggle.classList.remove('enabled');\n    }\n  }\n\n  async _checkActiveSubscription() {\n    if (!('serviceWorker' in navigator) || !('PushManager' in window)) {\n      return false;\n    }\n\n    try {\n      const registration = await navigator.serviceWorker.ready;\n      const subscription = await registration.pushManager.getSubscription();\n      return !!subscription;\n    } catch (error) {\n      console.error('Error checking subscription:', error);\n      return false;\n    }\n  }\n\n  _setupNotificationToggle() {\n    const notificationToggle = this.querySelector('#notification-toggle');\n    const notificationStatus = this.querySelector('#notification-status');\n    const statusIndicator = this.querySelector('.status-indicator');\n\n    if (!notificationToggle || !notificationStatus || !statusIndicator) return;\n\n    notificationToggle.addEventListener('click', async () => {\n      if (notificationToggle.disabled) return;\n\n      // Add loading state\n      notificationToggle.disabled = true;\n      notificationToggle.classList.add('loading');\n      const originalText = notificationStatus.textContent;\n      notificationStatus.textContent = 'Processing...';\n\n      try {\n        const hasSubscription = await this._checkActiveSubscription();\n\n        if (hasSubscription) {\n          // User has an active subscription, unsubscribe them\n          await this._unsubscribeFromNotifications();\n          notificationStatus.textContent = 'Enable Notifications';\n          statusIndicator.classList.remove('active');\n          notificationToggle.classList.remove('enabled');\n        } else {\n          // User doesn't have an active subscription\n          if (Notification.permission === 'granted') {\n            // Already has permission, just subscribe\n            await this._subscribeToNotifications();\n            notificationStatus.textContent = 'Disable Notifications';\n            statusIndicator.classList.add('active');\n            notificationToggle.classList.add('enabled');\n          } else {\n            // Needs to request permission\n            const permission = await Notification.requestPermission();\n\n            if (permission === 'granted') {\n              await this._subscribeToNotifications();\n              notificationStatus.textContent = 'Disable Notifications';\n              statusIndicator.classList.add('active');\n              notificationToggle.classList.add('enabled');\n            } else if (permission === 'denied') {\n              notificationStatus.textContent = 'Notifications Blocked';\n              notificationToggle.disabled = true;\n              notificationToggle.classList.add('blocked');\n              statusIndicator.classList.add('blocked');\n\n              if (window.showToast) {\n                window.showToast(\n                  'Notification permission denied by browser',\n                  'warning'\n                );\n              }\n            }\n          }\n        }\n      } catch (error) {\n        console.error('Error toggling notifications:', error);\n        notificationStatus.textContent = originalText;\n\n        if (window.showToast) {\n          window.showToast('Failed to toggle notifications', 'error');\n        }\n      } finally {\n        // Remove loading state\n        notificationToggle.disabled = false;\n        notificationToggle.classList.remove('loading');\n      }\n    });\n  }\n\n  async _subscribeToNotifications() {\n    if (!('serviceWorker' in navigator) || !('PushManager' in window)) {\n      console.log('Push notifications are not supported');\n      return;\n    }\n\n    const token = localStorage.getItem('token');\n    if (!token) return;\n\n    try {\n      const registration = await navigator.serviceWorker.ready;\n\n      // First, unsubscribe from any existing subscriptions\n      // This ensures we start with a clean slate and fixes potential issues\n      const existingSubscription =\n        await registration.pushManager.getSubscription();\n      if (existingSubscription) {\n        await existingSubscription.unsubscribe();\n      }\n\n      // Create a new subscription\n      const subscription = await registration.pushManager.subscribe({\n        userVisibleOnly: true,\n        applicationServerKey: CONFIG.VAPID_PUBLIC_KEY,\n      });\n\n      const subscriptionData = subscription.toJSON();\n\n      // Create a new object without expirationTime to avoid Bad Request error\n      const { endpoint, keys } = subscriptionData;\n      const cleanSubscriptionData = {\n        endpoint,\n        keys,\n      };\n\n      await DicodingStoryApi.subscribeNotification({\n        token,\n        subscription: cleanSubscriptionData,\n      });\n\n      console.log('Successfully subscribed to notifications');\n      if (window.showToast) {\n        window.showToast('Notifications enabled successfully', 'success');\n      }\n\n      return true;\n    } catch (error) {\n      console.error('Error subscribing to notifications:', error);\n      if (window.showToast) {\n        window.showToast('Failed to enable notifications', 'error');\n      }\n      return false;\n    }\n  }\n\n  async _unsubscribeFromNotifications() {\n    const token = localStorage.getItem('token');\n    if (!token) return false;\n\n    try {\n      const registration = await navigator.serviceWorker.ready;\n      const subscription = await registration.pushManager.getSubscription();\n\n      if (subscription) {\n        // Try to unsubscribe from the API\n        try {\n          await DicodingStoryApi.unsubscribeNotification({\n            token,\n            endpoint: subscription.endpoint,\n          });\n        } catch (apiError) {\n          // Log but don't rethrow API errors - these are common in development environments due to CORS\n          console.warn(\n            'API unsubscribe notification failed (expected in development):',\n            apiError\n          );\n        }\n\n        // Always unsubscribe from the subscription regardless of API result\n        const result = await subscription.unsubscribe();\n        console.log('Successfully unsubscribed from push notification service');\n\n        if (window.showToast) {\n          window.showToast('Notifications disabled successfully', 'info');\n        }\n\n        return result;\n      }\n      return true; // Already no subscription\n    } catch (error) {\n      console.error('Error unsubscribing from notifications:', error);\n      // In development, suppress toast error for expected CORS failures\n      const isDev =\n        window.location.hostname === 'localhost' ||\n        window.location.hostname === '127.0.0.1';\n      if (!isDev && window.showToast) {\n        window.showToast('Failed to disable notifications', 'error');\n      }\n      return false;\n    }\n  }\n}\n\ncustomElements.define('app-header', AppHeader);\n\n// Helper function\nfunction getInitials(name) {\n  if (!name) return 'U';\n  return name\n    .split(' ')\n    .map((part) => part.charAt(0))\n    .join('')\n    .toUpperCase();\n}\n","export function showFormattedDate(date, locale = 'id-ID', options = {}) {\n  const defaultOptions = {\n    year: 'numeric',\n    month: 'long',\n    day: 'numeric',\n    ...options,\n  };\n\n  try {\n    return new Date(date).toLocaleDateString(locale, defaultOptions);\n  } catch (error) {\n    console.error('Error formatting date:', error);\n    return date || 'Unknown date';\n  }\n}\n\nexport function truncateText(text, maxLength = 100) {\n  if (!text) return '';\n  return text.length <= maxLength ? text : `${text.substring(0, maxLength)}...`;\n}\n\nexport function debounce(func, wait = 300, immediate = false) {\n  let timeout;\n  return function executedFunction(...args) {\n    const context = this;\n    const later = () => {\n      timeout = null;\n      if (!immediate) func.apply(context, args);\n    };\n    const callNow = immediate && !timeout;\n    clearTimeout(timeout);\n    timeout = setTimeout(later, wait);\n    if (callNow) func.apply(context, args);\n  };\n}\n\nexport async function sleep(ms = 1000) {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n}\n\nexport function formatFileSize(bytes) {\n  if (bytes === 0) return '0 Bytes';\n  const sizes = ['Bytes', 'KB', 'MB', 'GB'];\n  const i = Math.floor(Math.log(bytes) / Math.log(1024));\n  return parseFloat((bytes / Math.pow(1024, i)).toFixed(2)) + ' ' + sizes[i];\n}\n\nexport function validateEmail(email) {\n  const re = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n  return re.test(email);\n}\n\nexport function getInitials(name) {\n  if (!name) return 'U';\n  return name\n    .split(' ')\n    .map((part) => part.charAt(0))\n    .join('')\n    .toUpperCase();\n}\n\nexport function isMobileDevice() {\n  return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(\n    navigator.userAgent\n  );\n}\n\nexport function isOnline() {\n  return true;\n}\n\nexport function capitalizeFirstLetter(string) {\n  return string.charAt(0).toUpperCase() + string.slice(1);\n}\n\nexport function getRandomColor() {\n  const colors = [\n    '#4361ee',\n    '#3f37c9',\n    '#4895ef',\n    '#4cc9f0',\n    '#f72585',\n    '#b5179e',\n  ];\n  return colors[Math.floor(Math.random() * colors.length)];\n}\n\nexport function animateElement(element, animation, duration = 300) {\n  return new Promise((resolve) => {\n    const animationClass = `animate-${animation}`;\n    element.classList.add(animationClass);\n\n    setTimeout(() => {\n      element.classList.remove(animationClass);\n      resolve();\n    }, duration);\n  });\n}\n","import { showFormattedDate } from '../utils/index';\nimport CONFIG from '../config';\n\nclass AppCard extends HTMLElement {\n  set story(data) {\n    this._story = data;\n    this.render();\n  }\n\n  render() {\n    if (!this._story) return;\n\n    try {\n      // Ensure required properties exist\n      const story = {\n        id: this._story.id || `unknown-${Date.now()}`,\n        name: this._story.name || 'Unknown User',\n        description: this._story.description || 'No description provided',\n        photoUrl: this._story.photoUrl || './images/placeholder.jpg',\n        createdAt: this._story.createdAt || new Date().toISOString(),\n        lat: this._story.lat,\n        lon: this._story.lon,\n      };\n\n      const formattedDate = showFormattedDate(story.createdAt, 'id-ID', {\n        year: 'numeric',\n        month: 'long',\n        day: 'numeric',\n      });\n\n      // Generate unique IDs for accessibility\n      const titleId = `story-title-${story.id}`;\n      const descId = `story-desc-${story.id}`;\n\n      // Create a color for this card based on the user's name (consistent for same user)\n      const userColor = getUserColor(story.name);\n\n      this.innerHTML = `\n        <article class=\"story-item\" aria-labelledby=\"${titleId}\" aria-describedby=\"${descId}\">\n          <div class=\"story-image-container\">\n            <div class=\"story-badge\" style=\"background-color: ${userColor}\">\n              <i class=\"fas fa-camera\" aria-hidden=\"true\"></i>\n            </div>\n            <img \n              class=\"story-image\" \n              src=\"${story.photoUrl}\" \n              alt=\"Photo shared by ${story.name}\" \n              loading=\"lazy\"\n              onerror=\"this.src='./images/placeholder.jpg'\"\n            >\n          </div>\n          \n          <div class=\"story-content\">\n            <div class=\"story-header\">\n              <div class=\"story-user\">\n                <div class=\"user-avatar\" aria-hidden=\"true\" style=\"background-color: ${userColor}\">\n                  ${getInitials(story.name)}\n                </div>\n                <div>\n                  <h3 class=\"story-name\" id=\"${titleId}\">${story.name}</h3>\n                  <time class=\"story-date\" datetime=\"${story.createdAt}\">\n                    <i class=\"far fa-calendar-alt\" aria-hidden=\"true\"></i> ${formattedDate}\n                  </time>\n                </div>\n              </div>\n              ${\n                story.lat && story.lon\n                  ? `<div class=\"story-location-badge\" title=\"Has location data\">\n                      <i class=\"fas fa-map-marker-alt\" aria-hidden=\"true\"></i>\n                    </div>`\n                  : ''\n              }\n            </div>\n            \n            <p class=\"story-description\" id=\"${descId}\">${truncateText(story.description, 120)}</p>\n            \n            ${\n              story.lat && story.lon\n                ? `<div class=\"story-map\" id=\"map-${story.id}\" \n                        aria-label=\"Location of story by ${story.name}\" \n                        tabindex=\"0\"></div>`\n                : ''\n            }\n            \n            <div class=\"story-actions\">\n              <a href=\"#/stories/${story.id}\" class=\"story-link\" \n                 aria-label=\"Read full story by ${story.name}\">\n                <i class=\"fas fa-book-reader\" aria-hidden=\"true\"></i>\n                Read Full Story\n              </a>\n            </div>\n          </div>\n        </article>\n      `;\n\n      if (story.lat && story.lon) {\n        // Use requestAnimationFrame to ensure the map container is ready\n        requestAnimationFrame(() => this.renderMap());\n      }\n    } catch (error) {\n      console.error('Error rendering card:', error, { story: this._story });\n\n      // Render a fallback card\n      this.innerHTML = `\n        <article class=\"story-item\">\n          <div class=\"story-content\">\n            <div class=\"story-header\">\n              <div class=\"story-user\">\n                <div class=\"user-avatar\" style=\"background-color: #4361ee\">U</div>\n                <div>\n                  <h3 class=\"story-name\">Story data error</h3>\n                  <time class=\"story-date\">Unknown date</time>\n                </div>\n              </div>\n            </div>\n            <p class=\"story-description\">There was an error rendering this story. Please try refreshing the page.</p>\n            <div class=\"story-actions\">\n              <a href=\"#/\" class=\"story-link\">\n                <i class=\"fas fa-home\" aria-hidden=\"true\"></i>\n                Back to Home\n              </a>\n            </div>\n          </div>\n        </article>\n      `;\n    }\n  }\n\n  renderMap() {\n    try {\n      if (!this._story) {\n        console.error('Cannot render map: story data is missing');\n        return;\n      }\n\n      // Check if we have valid coordinates\n      const lat = parseFloat(this._story.lat);\n      const lon = parseFloat(this._story.lon);\n\n      if (isNaN(lat) || isNaN(lon)) {\n        console.error('Cannot render map: invalid coordinates', {\n          lat: this._story.lat,\n          lon: this._story.lon,\n        });\n        return;\n      }\n\n      // Ensure required story properties\n      const storyId = this._story.id || `unknown-${Date.now()}`;\n      const storyName = this._story.name || 'Unknown User';\n      const storyDescription = this._story.description || '';\n\n      const mapElement = this.querySelector(`#map-${storyId}`);\n      if (!mapElement || !window.L) {\n        console.error(\n          'Cannot render map: DOM element or Leaflet not available'\n        );\n        return;\n      }\n\n      const map = L.map(mapElement, {\n        zoomControl: false,\n        dragging: false,\n        touchZoom: false,\n        scrollWheelZoom: false,\n        doubleClickZoom: false,\n        boxZoom: false,\n        keyboard: false,\n        attributionControl: false,\n      }).setView([lat, lon], 13);\n\n      // Add base layer\n      L.tileLayer(CONFIG.MAP_TILE_LAYERS.osm.url, {\n        maxZoom: 19,\n      }).addTo(map);\n\n      // Add marker with custom icon based on user color\n      const userColor = getUserColor(storyName);\n      const customIcon = L.divIcon({\n        html: `<div style=\"background-color: ${userColor}; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; box-shadow: 0 2px 5px rgba(0,0,0,0.3);\">\n                <i class=\"fas fa-map-marker-alt\"></i>\n              </div>`,\n        className: '',\n        iconSize: [30, 30],\n        iconAnchor: [15, 30],\n      });\n\n      L.marker([lat, lon], { icon: customIcon })\n        .addTo(map)\n        .bindPopup(\n          `<div class=\"map-popup\">\n            <b>${storyName}</b>\n            <p>${truncateText(storyDescription, 50)}...</p>\n            <a href=\"#/stories/${storyId}\" class=\"popup-link\">View Details</a>\n          </div>`,\n          {\n            className: 'custom-popup',\n            closeButton: false,\n          }\n        )\n        .openPopup();\n\n      // Add map click handler that navigates to detail page\n      map.on('click', () => {\n        window.location.hash = `#/stories/${storyId}`;\n      });\n\n      // Add keyboard handler for accessibility\n      mapElement.addEventListener('keydown', (event) => {\n        if (event.key === 'Enter' || event.key === ' ') {\n          window.location.hash = `#/stories/${storyId}`;\n        }\n      });\n    } catch (error) {\n      console.error('Error rendering map:', error, { story: this._story });\n    }\n  }\n\n  connectedCallback() {\n    // Add intersection observer to animate cards when they enter viewport\n    try {\n      if (\n        'IntersectionObserver' in window &&\n        window.matchMedia('(prefers-reduced-motion: no-preference)').matches\n      ) {\n        const observer = new IntersectionObserver(\n          (entries) => {\n            entries.forEach((entry) => {\n              if (entry.isIntersecting) {\n                this.classList.add('visible');\n                observer.unobserve(this);\n              }\n            });\n          },\n          { threshold: 0.2 }\n        );\n\n        observer.observe(this);\n      } else {\n        // Add visible class immediately if IntersectionObserver not supported\n        this.classList.add('visible');\n      }\n    } catch (error) {\n      console.error('Error in connectedCallback:', error);\n      // Ensure the card is visible even if observer fails\n      this.classList.add('visible');\n    }\n  }\n}\n\ncustomElements.define('app-card', AppCard);\n\n// Helper functions\nfunction getInitials(name) {\n  if (!name || typeof name !== 'string') return 'U';\n\n  try {\n    return name\n      .split(' ')\n      .map((part) => part.charAt(0))\n      .join('')\n      .toUpperCase()\n      .substring(0, 2); // Limit to 2 characters\n  } catch (error) {\n    console.error('Error getting initials:', error, { name });\n    return 'U';\n  }\n}\n\nfunction getUserColor(name) {\n  // Generate consistent color based on user name\n  const colors = [\n    '#4361ee', // primary\n    '#3f37c9', // secondary\n    '#4895ef', // accent\n    '#4cc9f0', // success\n    '#f72585', // danger\n    '#7209b7', // purple\n    '#3a0ca3', // indigo\n    '#4cc9f0', // blue\n    '#f72585', // pink\n    '#f8961e', // orange\n  ];\n\n  // Safety check - if name is undefined or null, return default color\n  if (!name || typeof name !== 'string') {\n    return colors[0]; // Return primary color as default\n  }\n\n  // Simple hash function to get consistent color for same name\n  const hash = name.split('').reduce((acc, char) => {\n    return char.charCodeAt(0) + ((acc << 5) - acc);\n  }, 0);\n\n  return colors[Math.abs(hash) % colors.length];\n}\n\nfunction truncateText(text, maxLength = 100) {\n  if (!text || typeof text !== 'string') return '';\n\n  try {\n    return text.length <= maxLength\n      ? text\n      : `${text.substring(0, maxLength)}...`;\n  } catch (error) {\n    console.error('Error truncating text:', error, { text });\n    return '';\n  }\n}\n","class AppLoader extends HTMLElement {\n  constructor() {\n    super();\n    this.message = 'Loading...';\n  }\n\n  static get observedAttributes() {\n    return ['message'];\n  }\n\n  attributeChangedCallback(name, oldValue, newValue) {\n    if (name === 'message' && oldValue !== newValue) {\n      this.message = newValue;\n      this.renderMessage();\n    }\n  }\n\n  connectedCallback() {\n    this.render();\n    this.hide();\n  }\n\n  show(message = '') {\n    if (message) {\n      this.message = message;\n      this.renderMessage();\n    }\n    this.style.display = 'flex';\n  }\n\n  hide() {\n    this.style.display = 'none';\n  }\n\n  render() {\n    this.innerHTML = `\n      <div class=\"loading-spinner\">\n        <div class=\"spinner\"></div>\n        <p class=\"loading-message\">${this.message}</p>\n      </div>\n    `;\n  }\n\n  renderMessage() {\n    const messageElement = this.querySelector('.loading-message');\n    if (messageElement) {\n      messageElement.textContent = this.message;\n    }\n  }\n}\n\ncustomElements.define('app-loader', AppLoader);\n","class AppFooter extends HTMLElement {\n  connectedCallback() {\n    this.render();\n    this.setupEventListeners();\n  }\n\n  render() {\n    const currentYear = new Date().getFullYear();\n\n    this.innerHTML = `\n      <footer class=\"app-footer\">\n        <div class=\"container footer-content\">\n          <div class=\"social-links\">\n            <a href=\"https://github.com/NaufalArsyaputraPradana/\" aria-label=\"GitHub\" target=\"_blank\" rel=\"noopener noreferrer\">\n              <i class=\"fab fa-github\"></i>\n            </a>\n            <a href=\"https://www.linkedin.com/in/naufalarsyaputrapradana/\" aria-label=\"LinkedIn\" target=\"_blank\" rel=\"noopener noreferrer\">\n              <i class=\"fab fa-linkedin\"></i>\n            </a>\n            <a href=\"https://www.instagram.com/arsya.pradana_/\" aria-label=\"Instagram\" target=\"_blank\" rel=\"noopener noreferrer\">\n              <i class=\"fab fa-instagram\"></i>\n            </a>\n          </div>\n          <p>&copy; ${currentYear} Dicoding Story. All rights reserved.</p>\n          <p class=\"copyright\">\n            Made with Naufal Arsyaputra Pradana <i class=\"fas fa-code\" style=\"color: var(--danger)\"></i> for Dicoding Submission\n          </p>\n        </div>\n      </footer>\n    `;\n  }\n\n  setupEventListeners() {\n    const yearElement = this.querySelector('p:first-of-type');\n    if (yearElement) {\n      yearElement.addEventListener('click', () => {\n        window.scrollTo({\n          top: 0,\n          behavior: 'smooth',\n        });\n      });\n    }\n  }\n}\n\ncustomElements.define('app-footer', AppFooter);\n","class AppSidebar extends HTMLElement {\n  constructor() {\n    super();\n    this._isInitialized = false;\n    this._isLoggedIn = false;\n    this._userData = null;\n\n    // Check login status from localStorage\n    this._checkLoginStatus();\n  }\n\n  connectedCallback() {\n    this._render();\n    this._isInitialized = true;\n    this._bindEvents();\n\n    // Add hash change listener to update active link\n    window.addEventListener('hashchange', () => {\n      this._render();\n    });\n\n    // Listen for login state changes\n    window.addEventListener('user-login-state-changed', (event) => {\n      this._isLoggedIn = event.detail.isLoggedIn;\n      this._userData = event.detail.userData;\n      this._render();\n    });\n  }\n\n  disconnectedCallback() {\n    // Remove event listeners\n    const toggleButton = this.querySelector('#sidebar-toggle');\n    if (toggleButton) {\n      toggleButton.removeEventListener('click', this._toggleSidebar);\n    }\n\n    window.removeEventListener('hashchange', this._render);\n    window.removeEventListener('user-login-state-changed', this._render);\n  }\n\n  _checkLoginStatus() {\n    try {\n      // Check for user data in localStorage\n      const token = localStorage.getItem('token');\n      const userData = localStorage.getItem('user');\n\n      if (token && userData) {\n        try {\n          this._isLoggedIn = true;\n          this._userData = JSON.parse(userData);\n        } catch (jsonError) {\n          console.error('Invalid user data format in localStorage:', jsonError);\n          // Clear invalid data\n          localStorage.removeItem('user');\n          this._isLoggedIn = !!token; // Still logged in if token exists\n          this._userData = null;\n        }\n      } else {\n        this._isLoggedIn = false;\n        this._userData = null;\n      }\n    } catch (error) {\n      console.error('Error checking login status', error);\n      this._isLoggedIn = false;\n      this._userData = null;\n    }\n  }\n\n  _render() {\n    this.innerHTML = `\n      <div class=\"sidebar-container\">\n        <div id=\"sidebar\" class=\"sidebar position-fixed\">\n          <div class=\"sidebar-header\">\n            <img src=\"./images/logo.png\" alt=\"Dicoding Story Logo\" class=\"sidebar-logo\">\n            <h2 class=\"sidebar-title\">Dicoding Story</h2>\n            <button id=\"sidebar-close\" class=\"sidebar-close\" aria-label=\"Close sidebar\">\n              <i class=\"fas fa-times\" aria-hidden=\"true\"></i>\n            </button>\n          </div>\n          \n          <div class=\"sidebar-content\">\n            ${this._renderUserSection()}\n            \n            <nav class=\"sidebar-nav\">\n              <ul>\n                <li>\n                  <a href=\"#/\" class=\"sidebar-link ${this._isActiveRoute('#/') ? 'active' : ''}\">\n                    <i class=\"fas fa-home\" aria-hidden=\"true\"></i>\n                    <span>Home</span>\n                  </a>\n                </li>\n                \n                ${\n                  this._isLoggedIn\n                    ? `\n                <li>\n                  <a href=\"#/stories/add\" class=\"sidebar-link ${this._isActiveRoute('#/stories/add') ? 'active' : ''}\">\n                    <i class=\"fas fa-plus-circle\" aria-hidden=\"true\"></i>\n                    <span>Add Story</span>\n                  </a>\n                </li>\n                `\n                    : ''\n                }\n                \n                <li>\n                  <a href=\"#/about\" class=\"sidebar-link ${this._isActiveRoute('#/about') ? 'active' : ''}\">\n                    <i class=\"fas fa-info-circle\" aria-hidden=\"true\"></i>\n                    <span>About</span>\n                  </a>\n                </li>\n                <li>\n                  <a href=\"#/saved\" class=\"sidebar-link ${this._isActiveRoute('#/saved') ? 'active' : ''}\">\n                    <i class=\"fas fa-database\" aria-hidden=\"true\"></i>\n                    <span>Saved Stories</span>\n                  </a>\n                </li>\n              </ul>\n            </nav>\n          </div>\n          \n          <div class=\"sidebar-footer\">\n            ${\n              this._isLoggedIn\n                ? `\n              <button id=\"logout-button\" class=\"sidebar-logout-button\">\n                <i class=\"fas fa-sign-out-alt\" aria-hidden=\"true\"></i>\n                <span>Log Out</span>\n              </button>\n            `\n                : `\n              <div class=\"sidebar-auth-buttons\">\n                <a href=\"#/login\" class=\"sidebar-auth-button login\">\n                  <i class=\"fas fa-sign-in-alt\" aria-hidden=\"true\"></i>\n                  <span>Login</span>\n                </a>\n                <a href=\"#/register\" class=\"sidebar-auth-button register\">\n                  <i class=\"fas fa-user-plus\" aria-hidden=\"true\"></i>\n                  <span>Register</span>\n                </a>\n              </div>\n            `\n            }\n          </div>\n        </div>\n        \n        <div id=\"sidebar-overlay\" class=\"sidebar-overlay\"></div>\n      </div>\n    `;\n  }\n\n  _renderUserSection() {\n    if (!this._isLoggedIn || !this._userData) {\n      return `\n        <div class=\"sidebar-guest\">\n          <i class=\"fas fa-user-circle sidebar-guest-icon\" aria-hidden=\"true\"></i>\n          <p>Welcome, Guest!</p>\n          <small>Login to share your story</small>\n        </div>\n      `;\n    }\n\n    // Create a colorful avatar background based on name\n    const userInitials = this._getInitials(this._userData.name);\n    const avatarColor = this._getAvatarColor(this._userData.name);\n\n    return `\n      <div class=\"sidebar-user\">\n        <div class=\"sidebar-user-avatar\" style=\"background-color: ${avatarColor}\">\n          ${\n            this._userData.photoUrl\n              ? `<img src=\"${this._userData.photoUrl}\" alt=\"${this._userData.name}'s avatar\">`\n              : `<span class=\"avatar-initials\">${userInitials}</span>`\n          }\n        </div>\n        <div class=\"sidebar-user-info\">\n          <h3 class=\"sidebar-user-name\">${this._userData.name}</h3>\n          <p class=\"sidebar-user-email\">${this._userData.email}</p>\n        </div>\n      </div>\n    `;\n  }\n\n  _getInitials(name) {\n    if (!name || typeof name !== 'string') return '?';\n\n    return name\n      .split(' ')\n      .map((part) => part.charAt(0))\n      .join('')\n      .toUpperCase()\n      .substring(0, 2);\n  }\n\n  _getAvatarColor(name) {\n    if (!name) return '#4361ee';\n\n    const colors = [\n      '#4361ee',\n      '#3a0ca3',\n      '#f72585',\n      '#4cc9f0',\n      '#4895ef',\n      '#560bad',\n      '#f8961e',\n      '#fb5607',\n      '#80b918',\n    ];\n\n    // Simple hash function\n    let hash = 0;\n    for (let i = 0; i < name.length; i++) {\n      hash = name.charCodeAt(i) + ((hash << 5) - hash);\n    }\n\n    // Use the hash to pick a color\n    return colors[Math.abs(hash) % colors.length];\n  }\n\n  _bindEvents() {\n    // Toggle sidebar visibility\n    const toggleButton = this.querySelector('#sidebar-toggle');\n    const sidebar = this.querySelector('#sidebar');\n    const overlay = this.querySelector('#sidebar-overlay');\n    const closeButton = this.querySelector('#sidebar-close');\n\n    if (toggleButton) {\n      toggleButton.addEventListener('click', () => this._toggleSidebar());\n    }\n\n    if (closeButton) {\n      closeButton.addEventListener('click', () => this._closeSidebar());\n    }\n\n    if (overlay) {\n      overlay.addEventListener('click', () => this._closeSidebar());\n    }\n\n    // Logout button\n    const logoutButton = this.querySelector('#logout-button');\n    if (logoutButton) {\n      logoutButton.addEventListener('click', () => {\n        // Dispatch logout event\n        this.dispatchEvent(\n          new CustomEvent('user-logout', {\n            bubbles: true,\n            composed: true,\n          })\n        );\n\n        // Close sidebar after logout click\n        this._closeSidebar();\n      });\n    }\n\n    // Make sidebar links close the sidebar when clicked\n    const sidebarLinks = this.querySelectorAll('.sidebar-link');\n    sidebarLinks.forEach((link) => {\n      link.addEventListener('click', () => this._closeSidebar());\n    });\n  }\n\n  _toggleSidebar() {\n    try {\n      const sidebar = this.querySelector('#sidebar');\n      const overlay = this.querySelector('#sidebar-overlay');\n\n      if (!sidebar || !overlay) return;\n\n      if (sidebar.classList.contains('open')) {\n        this._closeSidebar();\n      } else {\n        sidebar.classList.add('open');\n        overlay.classList.add('visible');\n        document.body.classList.add('sidebar-open');\n      }\n    } catch (error) {\n      console.error('Error toggling sidebar:', error);\n    }\n  }\n\n  _closeSidebar() {\n    try {\n      const sidebar = this.querySelector('#sidebar');\n      const overlay = this.querySelector('#sidebar-overlay');\n\n      if (!sidebar || !overlay) return;\n\n      sidebar.classList.remove('open');\n      overlay.classList.remove('visible');\n      document.body.classList.remove('sidebar-open');\n    } catch (error) {\n      console.error('Error closing sidebar:', error);\n    }\n  }\n\n  _isActiveRoute(route) {\n    // Handle special cases for better highlighting\n    const currentRoute = window.location.hash || '#/';\n\n    // Exact match\n    if (currentRoute === route) return true;\n\n    // For stories/add match\n    if (route === '#/stories/add' && currentRoute.includes('#/stories/add'))\n      return true;\n\n    // For story details, match the parent route\n    if (\n      route === '#/stories' &&\n      currentRoute.includes('#/stories/') &&\n      !currentRoute.includes('#/stories/add')\n    )\n      return true;\n\n    return false;\n  }\n}\n\ncustomElements.define('app-sidebar', AppSidebar);\nexport default AppSidebar;\n","const instanceOfAny = (object, constructors) => constructors.some((c) => object instanceof c);\n\nlet idbProxyableTypes;\nlet cursorAdvanceMethods;\n// This is a function to prevent it throwing up in node environments.\nfunction getIdbProxyableTypes() {\n    return (idbProxyableTypes ||\n        (idbProxyableTypes = [\n            IDBDatabase,\n            IDBObjectStore,\n            IDBIndex,\n            IDBCursor,\n            IDBTransaction,\n        ]));\n}\n// This is a function to prevent it throwing up in node environments.\nfunction getCursorAdvanceMethods() {\n    return (cursorAdvanceMethods ||\n        (cursorAdvanceMethods = [\n            IDBCursor.prototype.advance,\n            IDBCursor.prototype.continue,\n            IDBCursor.prototype.continuePrimaryKey,\n        ]));\n}\nconst transactionDoneMap = new WeakMap();\nconst transformCache = new WeakMap();\nconst reverseTransformCache = new WeakMap();\nfunction promisifyRequest(request) {\n    const promise = new Promise((resolve, reject) => {\n        const unlisten = () => {\n            request.removeEventListener('success', success);\n            request.removeEventListener('error', error);\n        };\n        const success = () => {\n            resolve(wrap(request.result));\n            unlisten();\n        };\n        const error = () => {\n            reject(request.error);\n            unlisten();\n        };\n        request.addEventListener('success', success);\n        request.addEventListener('error', error);\n    });\n    // This mapping exists in reverseTransformCache but doesn't exist in transformCache. This\n    // is because we create many promises from a single IDBRequest.\n    reverseTransformCache.set(promise, request);\n    return promise;\n}\nfunction cacheDonePromiseForTransaction(tx) {\n    // Early bail if we've already created a done promise for this transaction.\n    if (transactionDoneMap.has(tx))\n        return;\n    const done = new Promise((resolve, reject) => {\n        const unlisten = () => {\n            tx.removeEventListener('complete', complete);\n            tx.removeEventListener('error', error);\n            tx.removeEventListener('abort', error);\n        };\n        const complete = () => {\n            resolve();\n            unlisten();\n        };\n        const error = () => {\n            reject(tx.error || new DOMException('AbortError', 'AbortError'));\n            unlisten();\n        };\n        tx.addEventListener('complete', complete);\n        tx.addEventListener('error', error);\n        tx.addEventListener('abort', error);\n    });\n    // Cache it for later retrieval.\n    transactionDoneMap.set(tx, done);\n}\nlet idbProxyTraps = {\n    get(target, prop, receiver) {\n        if (target instanceof IDBTransaction) {\n            // Special handling for transaction.done.\n            if (prop === 'done')\n                return transactionDoneMap.get(target);\n            // Make tx.store return the only store in the transaction, or undefined if there are many.\n            if (prop === 'store') {\n                return receiver.objectStoreNames[1]\n                    ? undefined\n                    : receiver.objectStore(receiver.objectStoreNames[0]);\n            }\n        }\n        // Else transform whatever we get back.\n        return wrap(target[prop]);\n    },\n    set(target, prop, value) {\n        target[prop] = value;\n        return true;\n    },\n    has(target, prop) {\n        if (target instanceof IDBTransaction &&\n            (prop === 'done' || prop === 'store')) {\n            return true;\n        }\n        return prop in target;\n    },\n};\nfunction replaceTraps(callback) {\n    idbProxyTraps = callback(idbProxyTraps);\n}\nfunction wrapFunction(func) {\n    // Due to expected object equality (which is enforced by the caching in `wrap`), we\n    // only create one new func per func.\n    // Cursor methods are special, as the behaviour is a little more different to standard IDB. In\n    // IDB, you advance the cursor and wait for a new 'success' on the IDBRequest that gave you the\n    // cursor. It's kinda like a promise that can resolve with many values. That doesn't make sense\n    // with real promises, so each advance methods returns a new promise for the cursor object, or\n    // undefined if the end of the cursor has been reached.\n    if (getCursorAdvanceMethods().includes(func)) {\n        return function (...args) {\n            // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use\n            // the original object.\n            func.apply(unwrap(this), args);\n            return wrap(this.request);\n        };\n    }\n    return function (...args) {\n        // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use\n        // the original object.\n        return wrap(func.apply(unwrap(this), args));\n    };\n}\nfunction transformCachableValue(value) {\n    if (typeof value === 'function')\n        return wrapFunction(value);\n    // This doesn't return, it just creates a 'done' promise for the transaction,\n    // which is later returned for transaction.done (see idbObjectHandler).\n    if (value instanceof IDBTransaction)\n        cacheDonePromiseForTransaction(value);\n    if (instanceOfAny(value, getIdbProxyableTypes()))\n        return new Proxy(value, idbProxyTraps);\n    // Return the same value back if we're not going to transform it.\n    return value;\n}\nfunction wrap(value) {\n    // We sometimes generate multiple promises from a single IDBRequest (eg when cursoring), because\n    // IDB is weird and a single IDBRequest can yield many responses, so these can't be cached.\n    if (value instanceof IDBRequest)\n        return promisifyRequest(value);\n    // If we've already transformed this value before, reuse the transformed value.\n    // This is faster, but it also provides object equality.\n    if (transformCache.has(value))\n        return transformCache.get(value);\n    const newValue = transformCachableValue(value);\n    // Not all types are transformed.\n    // These may be primitive types, so they can't be WeakMap keys.\n    if (newValue !== value) {\n        transformCache.set(value, newValue);\n        reverseTransformCache.set(newValue, value);\n    }\n    return newValue;\n}\nconst unwrap = (value) => reverseTransformCache.get(value);\n\n/**\n * Open a database.\n *\n * @param name Name of the database.\n * @param version Schema version.\n * @param callbacks Additional callbacks.\n */\nfunction openDB(name, version, { blocked, upgrade, blocking, terminated } = {}) {\n    const request = indexedDB.open(name, version);\n    const openPromise = wrap(request);\n    if (upgrade) {\n        request.addEventListener('upgradeneeded', (event) => {\n            upgrade(wrap(request.result), event.oldVersion, event.newVersion, wrap(request.transaction), event);\n        });\n    }\n    if (blocked) {\n        request.addEventListener('blocked', (event) => blocked(\n        // Casting due to https://github.com/microsoft/TypeScript-DOM-lib-generator/pull/1405\n        event.oldVersion, event.newVersion, event));\n    }\n    openPromise\n        .then((db) => {\n        if (terminated)\n            db.addEventListener('close', () => terminated());\n        if (blocking) {\n            db.addEventListener('versionchange', (event) => blocking(event.oldVersion, event.newVersion, event));\n        }\n    })\n        .catch(() => { });\n    return openPromise;\n}\n/**\n * Delete a database.\n *\n * @param name Name of the database.\n */\nfunction deleteDB(name, { blocked } = {}) {\n    const request = indexedDB.deleteDatabase(name);\n    if (blocked) {\n        request.addEventListener('blocked', (event) => blocked(\n        // Casting due to https://github.com/microsoft/TypeScript-DOM-lib-generator/pull/1405\n        event.oldVersion, event));\n    }\n    return wrap(request).then(() => undefined);\n}\n\nconst readMethods = ['get', 'getKey', 'getAll', 'getAllKeys', 'count'];\nconst writeMethods = ['put', 'add', 'delete', 'clear'];\nconst cachedMethods = new Map();\nfunction getMethod(target, prop) {\n    if (!(target instanceof IDBDatabase &&\n        !(prop in target) &&\n        typeof prop === 'string')) {\n        return;\n    }\n    if (cachedMethods.get(prop))\n        return cachedMethods.get(prop);\n    const targetFuncName = prop.replace(/FromIndex$/, '');\n    const useIndex = prop !== targetFuncName;\n    const isWrite = writeMethods.includes(targetFuncName);\n    if (\n    // Bail if the target doesn't exist on the target. Eg, getAll isn't in Edge.\n    !(targetFuncName in (useIndex ? IDBIndex : IDBObjectStore).prototype) ||\n        !(isWrite || readMethods.includes(targetFuncName))) {\n        return;\n    }\n    const method = async function (storeName, ...args) {\n        // isWrite ? 'readwrite' : undefined gzipps better, but fails in Edge :(\n        const tx = this.transaction(storeName, isWrite ? 'readwrite' : 'readonly');\n        let target = tx.store;\n        if (useIndex)\n            target = target.index(args.shift());\n        // Must reject if op rejects.\n        // If it's a write operation, must reject if tx.done rejects.\n        // Must reject with op rejection first.\n        // Must resolve with op value.\n        // Must handle both promises (no unhandled rejections)\n        return (await Promise.all([\n            target[targetFuncName](...args),\n            isWrite && tx.done,\n        ]))[0];\n    };\n    cachedMethods.set(prop, method);\n    return method;\n}\nreplaceTraps((oldTraps) => ({\n    ...oldTraps,\n    get: (target, prop, receiver) => getMethod(target, prop) || oldTraps.get(target, prop, receiver),\n    has: (target, prop) => !!getMethod(target, prop) || oldTraps.has(target, prop),\n}));\n\nconst advanceMethodProps = ['continue', 'continuePrimaryKey', 'advance'];\nconst methodMap = {};\nconst advanceResults = new WeakMap();\nconst ittrProxiedCursorToOriginalProxy = new WeakMap();\nconst cursorIteratorTraps = {\n    get(target, prop) {\n        if (!advanceMethodProps.includes(prop))\n            return target[prop];\n        let cachedFunc = methodMap[prop];\n        if (!cachedFunc) {\n            cachedFunc = methodMap[prop] = function (...args) {\n                advanceResults.set(this, ittrProxiedCursorToOriginalProxy.get(this)[prop](...args));\n            };\n        }\n        return cachedFunc;\n    },\n};\nasync function* iterate(...args) {\n    // tslint:disable-next-line:no-this-assignment\n    let cursor = this;\n    if (!(cursor instanceof IDBCursor)) {\n        cursor = await cursor.openCursor(...args);\n    }\n    if (!cursor)\n        return;\n    cursor = cursor;\n    const proxiedCursor = new Proxy(cursor, cursorIteratorTraps);\n    ittrProxiedCursorToOriginalProxy.set(proxiedCursor, cursor);\n    // Map this double-proxy back to the original, so other cursor methods work.\n    reverseTransformCache.set(proxiedCursor, unwrap(cursor));\n    while (cursor) {\n        yield proxiedCursor;\n        // If one of the advancing methods was not called, call continue().\n        cursor = await (advanceResults.get(proxiedCursor) || cursor.continue());\n        advanceResults.delete(proxiedCursor);\n    }\n}\nfunction isIteratorProp(target, prop) {\n    return ((prop === Symbol.asyncIterator &&\n        instanceOfAny(target, [IDBIndex, IDBObjectStore, IDBCursor])) ||\n        (prop === 'iterate' && instanceOfAny(target, [IDBIndex, IDBObjectStore])));\n}\nreplaceTraps((oldTraps) => ({\n    ...oldTraps,\n    get(target, prop, receiver) {\n        if (isIteratorProp(target, prop))\n            return iterate;\n        return oldTraps.get(target, prop, receiver);\n    },\n    has(target, prop) {\n        return isIteratorProp(target, prop) || oldTraps.has(target, prop);\n    },\n}));\n\nexport { deleteDB, openDB, unwrap, wrap };\n","import { openDB } from 'idb';\nimport CONFIG from './config';\n\nconst dbPromise = openDB(CONFIG.DATABASE_NAME, CONFIG.DATABASE_VERSION, {\n  upgrade(db) {\n    if (!db.objectStoreNames.contains(CONFIG.OBJECT_STORE_NAME)) {\n      db.createObjectStore(CONFIG.OBJECT_STORE_NAME, { keyPath: 'id' });\n    }\n  },\n});\n\nexport async function saveStories(stories) {\n  if (!Array.isArray(stories) || stories.length === 0) return;\n  const db = await dbPromise;\n  const tx = db.transaction(CONFIG.OBJECT_STORE_NAME, 'readwrite');\n  for (const story of stories) {\n    tx.store.put(story);\n  }\n  await tx.done;\n}\n\nexport async function getAllStories() {\n  const db = await dbPromise;\n  return (await db.getAll(CONFIG.OBJECT_STORE_NAME)) || [];\n}\n\nexport async function deleteStory(id) {\n  const db = await dbPromise;\n  const tx = db.transaction(CONFIG.OBJECT_STORE_NAME, 'readwrite');\n  await tx.store.delete(id);\n  await tx.done;\n}\n","import DicodingStoryApi from '../data/api';\nimport { saveStories, getAllStories } from '../idb';\n\nclass HomePresenter {\n  constructor({ view }) {\n    this._view = view;\n    this._page = 1;\n    this._hasMoreData = true;\n    this._isLoading = false;\n    this._includeLocation = false;\n  }\n\n  async init() {\n    try {\n      this._view.renderPage();\n      this._setupEventListeners();\n      await this._loadInitialStories();\n    } catch (error) {\n      console.error('Error in HomePresenter.init:', error);\n      this._view.showError('Error initializing page. Please try refreshing.');\n    }\n  }\n\n  _setupEventListeners() {\n    try {\n      this._view.setLoadMoreCallback(async () => {\n        await this._loadMoreStories();\n      });\n\n      this._view.setLocationFilterCallback((isChecked) => {\n        this._includeLocation = isChecked;\n        this._page = 1;\n        this._hasMoreData = true;\n        this._loadInitialStories();\n      });\n    } catch (error) {\n      console.error('Error setting up event listeners:', error);\n    }\n  }\n\n  async _loadInitialStories() {\n    if (this._isLoading) return;\n\n    this._isLoading = true;\n    this._page = 1;\n\n    try {\n      this._view.clearStories();\n      this._view.showLoading();\n\n      const token = localStorage.getItem('token');\n      if (!token) {\n        this._view.showLoginRequired();\n        return;\n      }\n\n      console.log(\n        'Fetching initial stories, page:',\n        this._page,\n        'location:',\n        this._includeLocation ? 1 : 0\n      );\n      const response = await DicodingStoryApi.getAllStories({\n        token,\n        page: this._page,\n        location: this._includeLocation ? 1 : 0,\n      });\n\n      if (response.error) {\n        this._view.showError(response.message || 'Gagal memuat cerita');\n        return;\n      }\n\n      // Validate response structure\n      if (!response || typeof response !== 'object') {\n        console.error('Invalid response format:', response);\n        this._view.showError('Format respons server tidak valid');\n        return;\n      }\n\n      const stories = response.listStory || [];\n      const size = response.size || 10;\n\n      console.log('Received stories:', stories.length);\n\n      // Ensure stories is an array\n      if (!Array.isArray(stories)) {\n        console.error('Stories is not an array:', stories);\n        this._view.showError('Format data cerita tidak valid');\n        return;\n      }\n\n      if (stories.length === 0) {\n        this._view.showEmptyState();\n        this._hasMoreData = false;\n      } else {\n        // Persist stories to IndexedDB for offline use\n        await saveStories(stories);\n        this._view.renderStories(stories);\n        this._hasMoreData = stories.length === size;\n        this._view.updateLoadMoreButton(this._hasMoreData);\n      }\n    } catch (error) {\n      console.error('Error loading initial stories:', error);\n      // Try to load from cache if online fetch fails\n      const cachedStories = await getAllStories();\n      if (cachedStories && cachedStories.length > 0) {\n        this._view.renderStories(cachedStories);\n        this._view.showOfflineMessage();\n      } else {\n        this._view.showError(error.message || 'Gagal memuat cerita');\n      }\n    } finally {\n      this._isLoading = false;\n      this._view.hideLoading();\n    }\n  }\n\n  async _loadMoreStories() {\n    if (this._isLoading || !this._hasMoreData) return;\n\n    this._isLoading = true;\n    this._page += 1;\n\n    try {\n      this._view.showLoadingMore();\n\n      const token = localStorage.getItem('token');\n      if (!token) {\n        this._view.showLoginRequired();\n        return;\n      }\n\n      console.log(\n        'Fetching more stories, page:',\n        this._page,\n        'location:',\n        this._includeLocation ? 1 : 0\n      );\n      const response = await DicodingStoryApi.getAllStories({\n        token,\n        page: this._page,\n        location: this._includeLocation ? 1 : 0,\n      });\n\n      if (response.error) {\n        this._view.showError(\n          response.message || 'Gagal memuat cerita tambahan'\n        );\n        return;\n      }\n\n      // Validate response structure\n      if (!response || typeof response !== 'object') {\n        console.error('Invalid response format:', response);\n        this._view.showError('Format respons server tidak valid');\n        return;\n      }\n\n      const stories = response.listStory || [];\n      const size = response.size || 10;\n\n      console.log('Received more stories:', stories.length);\n\n      // Ensure stories is an array\n      if (!Array.isArray(stories)) {\n        console.error('Stories is not an array:', stories);\n        this._view.showError('Format data cerita tidak valid');\n        return;\n      }\n\n      if (stories.length > 0) {\n        // Persist stories to IndexedDB\n        await saveStories(stories);\n        this._view.appendStories(stories);\n        this._hasMoreData = stories.length === size;\n      } else {\n        this._hasMoreData = false;\n      }\n\n      this._view.updateLoadMoreButton(this._hasMoreData);\n    } catch (error) {\n      console.error('Error loading more stories:', error);\n      this._view.showError(error.message || 'Gagal memuat cerita tambahan');\n    } finally {\n      this._isLoading = false;\n      this._view.hideLoadingMore();\n    }\n  }\n}\n\nexport default HomePresenter;\n","import '../components/header';\nimport '../components/card';\nimport '../components/loader';\nimport '../components/footer';\nimport '../components/sidebar';\nimport { debounce } from '../utils/index';\nimport HomePresenter from '../presenter/home-presenter';\n\nexport default class HomePage {\n  constructor() {\n    this._presenter = new HomePresenter({ view: this });\n    this._debouncedScroll = debounce(this._handleScroll.bind(this), 200);\n  }\n\n  renderPage() {\n    this._setupInfiniteScroll();\n    this._setupOfflineListener();\n  }\n\n  async render() {\n    return `\n      <app-sidebar></app-sidebar>\n      <app-header></app-header>\n      <main id=\"main-content\" class=\"main-content\" tabindex=\"-1\">\n        <section class=\"container\">\n          <h1 class=\"page-title\">\n            <i class=\"fas fa-book-open\" aria-hidden=\"true\"></i>\n            Latest Stories\n          </h1>\n          \n          <div class=\"filter-container mb-2\">\n            <label for=\"include-location\" class=\"filter-label\">\n              <input type=\"checkbox\" id=\"include-location\" name=\"include-location\">\n              <span class=\"ml-1\">Show stories with location only</span>\n            </label>\n          </div>\n          \n          <div id=\"stories-list\" class=\"stories-list\"></div>\n          \n          <div id=\"loading-more\" class=\"hidden\">\n            <div class=\"spinner\" style=\"width: 30px; height: 30px; margin: 0 auto;\"></div>\n          </div>\n          \n          <button id=\"load-more\" class=\"load-more\" aria-label=\"Load more stories\">\n            <i class=\"fas fa-arrow-down\" aria-hidden=\"true\"></i>\n            Load More\n          </button>\n          \n          <div id=\"empty-state\" class=\"empty-state hidden\">\n            <i class=\"fas fa-inbox fa-3x\"></i>\n            <p>No stories found. Be the first to share your experience!</p>\n          </div>\n        </section>\n      </main>\n      <app-footer></app-footer>\n      <app-loader></app-loader>\n    `;\n  }\n\n  async afterRender() {\n    this._presenter.init();\n  }\n\n  setLoadMoreCallback(callback) {\n    const loadMoreButton = document.querySelector('#load-more');\n    if (loadMoreButton) {\n      loadMoreButton.addEventListener('click', callback);\n    }\n  }\n\n  setLocationFilterCallback(callback) {\n    const locationFilter = document.querySelector('#include-location');\n    if (locationFilter) {\n      locationFilter.addEventListener('change', (event) => {\n        callback(event.target.checked);\n      });\n    }\n  }\n\n  _setupInfiniteScroll() {\n    window.addEventListener('scroll', this._debouncedScroll);\n  }\n\n  _handleScroll() {\n    const loadMoreButton = document.querySelector('#load-more');\n    if (\n      !loadMoreButton ||\n      loadMoreButton.style.display === 'none' ||\n      loadMoreButton.disabled\n    ) {\n      return;\n    }\n\n    const scrollY = window.scrollY;\n    const visible = document.documentElement.clientHeight;\n    const pageHeight = document.documentElement.scrollHeight;\n    const bottomOfPage = visible + scrollY >= pageHeight - 100;\n\n    if (bottomOfPage) {\n      loadMoreButton.click();\n    }\n  }\n\n  _setupOfflineListener() {\n    window.addEventListener('online', () => {\n      this._presenter.init();\n    });\n  }\n\n  showLoading() {\n    const loader = document.querySelector('app-loader');\n    if (loader) loader.show('Loading stories...');\n  }\n\n  hideLoading() {\n    const loader = document.querySelector('app-loader');\n    if (loader) loader.hide();\n  }\n\n  showLoadingMore() {\n    const loadingMore = document.querySelector('#loading-more');\n    if (loadingMore) loadingMore.classList.remove('hidden');\n  }\n\n  hideLoadingMore() {\n    const loadingMore = document.querySelector('#loading-more');\n    if (loadingMore) loadingMore.classList.add('hidden');\n  }\n\n  clearStories() {\n    const storiesList = document.querySelector('#stories-list');\n    if (storiesList) storiesList.innerHTML = '';\n\n    // Hide empty state\n    const emptyState = document.querySelector('#empty-state');\n    if (emptyState) emptyState.classList.add('hidden');\n  }\n\n  renderStories(stories) {\n    const storiesList = document.querySelector('#stories-list');\n    if (!storiesList) return;\n\n    // Safety check - ensure stories is an array\n    if (!stories || !Array.isArray(stories)) {\n      console.error('Invalid stories data:', stories);\n      return;\n    }\n\n    // Filter out any invalid story objects\n    const validStories = stories.filter(\n      (story) => story && typeof story === 'object'\n    );\n\n    validStories.forEach((story, index) => {\n      try {\n        const card = document.createElement('app-card');\n        card.story = story;\n        storiesList.appendChild(card);\n\n        // Add animation to new cards\n        if (\n          window.matchMedia('(prefers-reduced-motion: no-preference)').matches\n        ) {\n          card.animate(\n            [\n              { opacity: 0, transform: 'translateY(20px)' },\n              { opacity: 1, transform: 'translateY(0)' },\n            ],\n            {\n              duration: 300,\n              easing: 'ease-out',\n              delay: index * 50,\n            }\n          );\n        }\n      } catch (error) {\n        console.error('Error rendering story card:', error, { story });\n      }\n    });\n  }\n\n  appendStories(stories) {\n    const storiesList = document.querySelector('#stories-list');\n    if (!storiesList) return;\n\n    // Safety check - ensure stories is an array\n    if (!stories || !Array.isArray(stories)) {\n      console.error('Invalid stories data:', stories);\n      return;\n    }\n\n    // Filter out any invalid story objects\n    const validStories = stories.filter(\n      (story) => story && typeof story === 'object'\n    );\n\n    if (validStories.length === 0) {\n      console.warn('No valid stories to append');\n      return;\n    }\n\n    const startIndex = storiesList.childElementCount;\n\n    validStories.forEach((story, index) => {\n      try {\n        const card = document.createElement('app-card');\n        card.story = story;\n        storiesList.appendChild(card);\n\n        // Add animation to new cards\n        if (\n          window.matchMedia('(prefers-reduced-motion: no-preference)').matches\n        ) {\n          card.animate(\n            [\n              { opacity: 0, transform: 'translateY(20px)' },\n              { opacity: 1, transform: 'translateY(0)' },\n            ],\n            {\n              duration: 300,\n              easing: 'ease-out',\n              delay: index * 50,\n            }\n          );\n        }\n      } catch (error) {\n        console.error('Error appending story card:', error, { story });\n      }\n    });\n  }\n\n  updateLoadMoreButton(hasMore) {\n    const loadMoreButton = document.querySelector('#load-more');\n    if (!loadMoreButton) return;\n\n    if (hasMore) {\n      loadMoreButton.style.display = 'flex';\n      loadMoreButton.disabled = false;\n    } else {\n      loadMoreButton.style.display = 'none';\n      loadMoreButton.disabled = true;\n    }\n  }\n\n  showEmptyState() {\n    const emptyState = document.querySelector('#empty-state');\n    if (emptyState) emptyState.classList.remove('hidden');\n\n    const loadMoreButton = document.querySelector('#load-more');\n    if (loadMoreButton) loadMoreButton.style.display = 'none';\n  }\n\n  showLoginRequired() {\n    Swal.fire({\n      icon: 'warning',\n      title: 'Login Required',\n      text: 'You need to login to view stories',\n      confirmButtonText: 'Login Now',\n      confirmButtonColor: '#4361ee',\n    }).then((result) => {\n      if (result.isConfirmed) {\n        window.location.hash = '#/login';\n      }\n    });\n  }\n\n  showOfflineMessage() {\n    window.showToast &&\n      window.showToast(\n        'Anda sedang offline. Menampilkan data tersimpan.',\n        'info'\n      );\n  }\n\n  showError(message) {\n    Swal.fire({\n      icon: 'error',\n      title: 'Error',\n      text: message || 'Failed to load stories',\n      confirmButtonColor: '#4361ee',\n    });\n  }\n}\n","import '../components/header';\nimport '../components/footer';\nimport '../components/loader';\nimport '../components/sidebar';\n\nexport default class AboutPage {\n  async render() {\n    return `\n      <app-sidebar></app-sidebar>\n      <app-header></app-header>\n      <main id=\"main-content\" class=\"main-content\" tabindex=\"-1\">\n        <section class=\"container\">\n          <h1 class=\"page-title\">\n            <i class=\"fas fa-info-circle\"></i>\n            About the App\n          </h1>\n          \n          <div class=\"about-content\">\n            <div class=\"about-card\" id=\"about-app\">\n              <h2><i class=\"fas fa-book-open\"></i> Dicoding Story</h2>\n              <p>\n                Dicoding Story is a platform for sharing programming and technology \n                learning experiences. This app was created as a submission project \n                for Dicoding's \"Menjadi Front-End Web Developer Expert\" class.\n              </p>\n              <p class=\"mt-2\">\n                The application allows users to share their learning journey with others,\n                add location to their stories, and explore stories from other learners.\n              </p>\n            </div>\n            \n            <div class=\"about-card\" id=\"about-features\">\n              <h2><i class=\"fas fa-feather-alt\"></i> Features</h2>\n              <ul class=\"feature-list\">\n                <li><i class=\"fas fa-check-circle\"></i> Share stories with images</li>\n                <li><i class=\"fas fa-check-circle\"></i> Add location to stories with interactive maps</li>\n                <li><i class=\"fas fa-check-circle\"></i> View stories from other users</li>\n                <li><i class=\"fas fa-check-circle\"></i> Responsive design for all devices</li>\n                <li><i class=\"fas fa-check-circle\"></i> Offline capability with cached data</li>\n                <li><i class=\"fas fa-check-circle\"></i> Push notifications for new features</li>\n              </ul>\n            </div>\n            \n            <div class=\"about-card\" id=\"about-tech\">\n              <h2><i class=\"fas fa-code\"></i> Technology Stack</h2>\n              <div class=\"tech-stack\">\n                <div class=\"tech-item\">\n                  <i class=\"fab fa-html5\"></i>\n                  <span>HTML5</span>\n                </div>\n                <div class=\"tech-item\">\n                  <i class=\"fab fa-css3-alt\"></i>\n                  <span>CSS3</span>\n                </div>\n                <div class=\"tech-item\">\n                  <i class=\"fab fa-js\"></i>\n                  <span>JavaScript</span>\n                </div>\n                <div class=\"tech-item\">\n                  <i class=\"fas fa-map-marked-alt\"></i>\n                  <span>Leaflet.js</span>\n                </div>\n                <div class=\"tech-item\">\n                  <i class=\"fas fa-mobile-alt\"></i>\n                  <span>PWA</span>\n                </div>\n                <div class=\"tech-item\">\n                  <i class=\"fas fa-server\"></i>\n                  <span>REST API</span>\n                </div>\n              </div>\n            </div>\n            \n            <div class=\"about-card\" id=\"about-developer\">\n              <h2><i class=\"fas fa-user-tie\"></i> About Developer</h2>\n              <p>\n                This application was developed by <strong>Naufal Arsyaputra Pradana</strong> \n                as part of the submission for Dicoding's Front-End Web Developer Expert class.\n              </p>\n              <div class=\"tech-stack mt-2\">\n                <div class=\"tech-item\">\n                  <a href=\"https://github.com/NaufalArsyaputraPradana/\" target=\"_blank\" rel=\"noopener noreferrer\">\n                    <i class=\"fab fa-github\"></i>\n                    <span>GitHub</span>\n                  </a>\n                </div>\n                <div class=\"tech-item\">\n                  <a href=\"https://www.linkedin.com/in/naufalarsyaputrapradana/\" target=\"_blank\" rel=\"noopener noreferrer\">\n                    <i class=\"fab fa-linkedin\"></i>\n                    <span>LinkedIn</span>\n                  </a>\n                </div>\n                <div class=\"tech-item\">\n                  <a href=\"https://www.instagram.com/arsya.pradana_/\" target=\"_blank\" rel=\"noopener noreferrer\">\n                    <i class=\"fab fa-instagram\"></i>\n                    <span>Instagram</span>\n                  </a>\n                </div>\n              </div>\n            </div>\n          </div>\n        </section>\n      </main>\n      <app-footer></app-footer>\n    `;\n  }\n\n  async afterRender() {\n    // Add animations to about cards\n    if (window.matchMedia('(prefers-reduced-motion: no-preference)').matches) {\n      const cards = [\n        document.getElementById('about-app'),\n        document.getElementById('about-features'),\n        document.getElementById('about-tech'),\n        document.getElementById('about-developer'),\n      ];\n\n      cards.forEach((card, index) => {\n        if (card) {\n          card.style.opacity = '0';\n          card.style.transform = 'translateY(20px)';\n          card.style.transition = 'opacity 0.3s ease, transform 0.3s ease';\n\n          setTimeout(\n            () => {\n              card.style.opacity = '1';\n              card.style.transform = 'translateY(0)';\n            },\n            index * 100 + 300\n          );\n        }\n      });\n    }\n  }\n}\n","import DicodingStoryApi from '../data/api';\nimport '../components/header';\nimport '../components/loader';\nimport '../components/footer';\nimport '../components/sidebar';\nimport { validateEmail, isOnline } from '../utils/index';\n\nexport default class LoginPage {\n  async render() {\n    return `\n      <app-sidebar></app-sidebar>\n      <app-header></app-header>\n      <main id=\"main-content\" class=\"main-content\" tabindex=\"-1\">\n        <section class=\"auth-container\">\n          <h1 class=\"auth-title\">\n            <i class=\"fas fa-sign-in-alt\"></i>\n            Login\n          </h1>\n          \n          <form id=\"login-form\" class=\"auth-form\" novalidate>\n            <div class=\"auth-form-group\">\n              <label for=\"email\">Email</label>\n              <input \n                type=\"email\" \n                id=\"email\" \n                name=\"email\" \n                required\n                placeholder=\"Enter your email\"\n                aria-describedby=\"email-help\"\n                autocomplete=\"username\"\n              >\n              <small id=\"email-help\" class=\"text-muted\">Enter a valid email address</small>\n              <div class=\"error-message\" id=\"email-error\"></div>\n            </div>\n            \n            <div class=\"auth-form-group\">\n              <label for=\"password\">Password</label>\n              <input \n                type=\"password\" \n                id=\"password\" \n                name=\"password\" \n                required \n                minlength=\"8\"\n                placeholder=\"Enter your password\"\n                aria-describedby=\"password-help\"\n                autocomplete=\"current-password\"\n              >\n              <small id=\"password-help\" class=\"text-muted\">Minimum 8 characters</small>\n              <div class=\"error-message\" id=\"password-error\"></div>\n            </div>\n            \n            <button type=\"submit\" class=\"auth-submit-button\">\n              <i class=\"fas fa-sign-in-alt\"></i>\n              Login\n            </button>\n            \n            <div class=\"flex items-center mt-2\">\n              <input type=\"checkbox\" id=\"remember-me\" name=\"remember-me\">\n              <label for=\"remember-me\" class=\"ml-2\">Remember me</label>\n            </div>\n          </form>\n          \n          <div class=\"auth-link\">\n            Don't have an account? <a href=\"#/register\">Register here</a>\n          </div>\n          \n          ${\n            !isOnline()\n              ? `\n            <div class=\"offline-notice mt-2\">\n              <i class=\"fas fa-wifi-slash\"></i> You are currently offline. \n              Login is not available without internet connection.\n            </div>\n          `\n              : ''\n          }\n        </section>\n      </main>\n      <app-footer></app-footer>\n      <app-loader></app-loader>\n    `;\n  }\n\n  async afterRender() {\n    this._setupForm();\n    this._setupInputValidation();\n    this._checkRememberedUser();\n  }\n\n  _setupForm() {\n    const form = document.querySelector('#login-form');\n    if (!form) return;\n\n    form.addEventListener('submit', async (event) => {\n      event.preventDefault();\n\n      if (!this._validateForm()) return;\n      if (!isOnline()) {\n        Swal.fire({\n          icon: 'error',\n          title: 'Offline Mode',\n          text: 'Login is not available without internet connection.',\n          confirmButtonColor: '#4361ee',\n        });\n        return;\n      }\n\n      const email = form.querySelector('#email').value.trim();\n      const password = form.querySelector('#password').value.trim();\n      const rememberMe = form.querySelector('#remember-me').checked;\n\n      const loader = document.querySelector('app-loader');\n      if (loader) loader.show('Authenticating...');\n\n      try {\n        const response = await DicodingStoryApi.login({ email, password });\n\n        localStorage.setItem('token', response.loginResult.token);\n        localStorage.setItem('user', JSON.stringify(response.loginResult.user));\n\n        if (rememberMe) {\n          localStorage.setItem('rememberedEmail', email);\n        } else {\n          localStorage.removeItem('rememberedEmail');\n        }\n\n        await Swal.fire({\n          icon: 'success',\n          title: 'Login successful!',\n          showConfirmButton: false,\n          timer: 1500,\n        });\n\n        window.location.hash = '#/';\n      } catch (error) {\n        console.error('Login failed:', error);\n        Swal.fire({\n          icon: 'error',\n          title: 'Login failed',\n          text: error.message || 'Invalid email or password',\n          confirmButtonColor: '#4361ee',\n        });\n      } finally {\n        if (loader) loader.hide();\n      }\n    });\n  }\n\n  _setupInputValidation() {\n    const emailInput = document.querySelector('#email');\n    const passwordInput = document.querySelector('#password');\n\n    if (emailInput) {\n      emailInput.addEventListener('input', () => {\n        this._validateEmail();\n      });\n    }\n\n    if (passwordInput) {\n      passwordInput.addEventListener('input', () => {\n        this._validatePassword();\n      });\n    }\n  }\n\n  _validateForm() {\n    const isEmailValid = this._validateEmail();\n    const isPasswordValid = this._validatePassword();\n    return isEmailValid && isPasswordValid;\n  }\n\n  _validateEmail() {\n    const emailInput = document.querySelector('#email');\n    const errorElement = document.querySelector('#email-error');\n\n    if (!emailInput || !errorElement) return false;\n\n    const email = emailInput.value.trim();\n\n    if (!email) {\n      errorElement.textContent = 'Email is required';\n      return false;\n    }\n\n    if (!validateEmail(email)) {\n      errorElement.textContent = 'Please enter a valid email address';\n      return false;\n    }\n\n    errorElement.textContent = '';\n    return true;\n  }\n\n  _validatePassword() {\n    const passwordInput = document.querySelector('#password');\n    const errorElement = document.querySelector('#password-error');\n\n    if (!passwordInput || !errorElement) return false;\n\n    const password = passwordInput.value.trim();\n\n    if (!password) {\n      errorElement.textContent = 'Password is required';\n      return false;\n    }\n\n    if (password.length < 8) {\n      errorElement.textContent = 'Password must be at least 8 characters';\n      return false;\n    }\n\n    errorElement.textContent = '';\n    return true;\n  }\n\n  _checkRememberedUser() {\n    const rememberedEmail = localStorage.getItem('rememberedEmail');\n    const emailInput = document.querySelector('#email');\n    const rememberCheckbox = document.querySelector('#remember-me');\n\n    if (rememberedEmail && emailInput) {\n      emailInput.value = rememberedEmail;\n      if (rememberCheckbox) {\n        rememberCheckbox.checked = true;\n      }\n      document.querySelector('#password').focus();\n    }\n  }\n}\n","import DicodingStoryApi from '../data/api';\nimport '../components/header';\nimport '../components/loader';\nimport '../components/footer';\nimport '../components/sidebar';\nimport { validateEmail, isOnline } from '../utils/index';\n\nexport default class RegisterPage {\n  async render() {\n    return `\n      <app-sidebar></app-sidebar>\n      <app-header></app-header>\n      <main id=\"main-content\" class=\"main-content\" tabindex=\"-1\">\n        <section class=\"auth-container\">\n          <h1 class=\"auth-title\">\n            <i class=\"fas fa-user-plus\"></i>\n            Register\n          </h1>\n          \n          <form id=\"register-form\" class=\"auth-form\" novalidate>\n            <div class=\"auth-form-group\">\n              <label for=\"name\">Full Name</label>\n              <input \n                type=\"text\" \n                id=\"name\" \n                name=\"name\" \n                required\n                minlength=\"3\"\n                placeholder=\"Enter your full name\"\n                aria-describedby=\"name-help\"\n                autocomplete=\"name\"\n              >\n              <small id=\"name-help\" class=\"text-muted\">Minimum 3 characters</small>\n              <div class=\"error-message\" id=\"name-error\"></div>\n            </div>\n            \n            <div class=\"auth-form-group\">\n              <label for=\"email\">Email</label>\n              <input \n                type=\"email\" \n                id=\"email\" \n                name=\"email\" \n                required\n                placeholder=\"Enter your email\"\n                aria-describedby=\"email-help\"\n                autocomplete=\"username\"\n              >\n              <small id=\"email-help\" class=\"text-muted\">Enter a valid email address</small>\n              <div class=\"error-message\" id=\"email-error\"></div>\n            </div>\n            \n            <div class=\"auth-form-group\">\n              <label for=\"password\">Password</label>\n              <input \n                type=\"password\" \n                id=\"password\" \n                name=\"password\" \n                required \n                minlength=\"8\"\n                placeholder=\"Enter password (min 8 characters)\"\n                aria-describedby=\"password-help\"\n                autocomplete=\"new-password\"\n              >\n              <small id=\"password-help\" class=\"text-muted\">Minimum 8 characters</small>\n              <div class=\"error-message\" id=\"password-error\"></div>\n            </div>\n            \n            <button type=\"submit\" class=\"auth-submit-button\">\n              <i class=\"fas fa-user-plus\"></i>\n              Register\n            </button>\n          </form>\n          \n          <div class=\"auth-link\">\n            Already have an account? <a href=\"#/login\">Login here</a>\n          </div>\n          \n          ${\n            !isOnline()\n              ? `\n            <div class=\"offline-notice mt-2\">\n              <i class=\"fas fa-wifi-slash\"></i> You are currently offline. \n              Registration is not available without internet connection.\n            </div>\n          `\n              : ''\n          }\n        </section>\n      </main>\n      <app-footer></app-footer>\n      <app-loader></app-loader>\n    `;\n  }\n\n  async afterRender() {\n    this._setupForm();\n    this._setupInputValidation();\n  }\n\n  _setupForm() {\n    const form = document.querySelector('#register-form');\n    if (!form) return;\n\n    form.addEventListener('submit', async (event) => {\n      event.preventDefault();\n\n      if (!this._validateForm()) return;\n      if (!isOnline()) {\n        Swal.fire({\n          icon: 'error',\n          title: 'Offline Mode',\n          text: 'Registration is not available without internet connection.',\n          confirmButtonColor: '#4361ee',\n        });\n        return;\n      }\n\n      const name = form.querySelector('#name').value.trim();\n      const email = form.querySelector('#email').value.trim();\n      const password = form.querySelector('#password').value.trim();\n\n      const loader = document.querySelector('app-loader');\n      if (loader) loader.show('Creating account...');\n\n      try {\n        await DicodingStoryApi.register({ name, email, password });\n\n        await Swal.fire({\n          icon: 'success',\n          title: 'Registration successful!',\n          text: 'Please login with your new account',\n          confirmButtonColor: '#4361ee',\n        });\n\n        window.location.hash = '#/login';\n        form.reset();\n      } catch (error) {\n        console.error('Registration failed:', error);\n        Swal.fire({\n          icon: 'error',\n          title: 'Registration failed',\n          text: error.message || 'Email may already be registered',\n          confirmButtonColor: '#4361ee',\n        });\n      } finally {\n        if (loader) loader.hide();\n      }\n    });\n  }\n\n  _setupInputValidation() {\n    const nameInput = document.querySelector('#name');\n    const emailInput = document.querySelector('#email');\n    const passwordInput = document.querySelector('#password');\n\n    if (nameInput) {\n      nameInput.addEventListener('input', () => {\n        this._validateName();\n      });\n    }\n\n    if (emailInput) {\n      emailInput.addEventListener('input', () => {\n        this._validateEmail();\n      });\n    }\n\n    if (passwordInput) {\n      passwordInput.addEventListener('input', () => {\n        this._validatePassword();\n      });\n    }\n  }\n\n  _validateForm() {\n    const isNameValid = this._validateName();\n    const isEmailValid = this._validateEmail();\n    const isPasswordValid = this._validatePassword();\n    return isNameValid && isEmailValid && isPasswordValid;\n  }\n\n  _validateName() {\n    const nameInput = document.querySelector('#name');\n    const errorElement = document.querySelector('#name-error');\n\n    if (!nameInput || !errorElement) return false;\n\n    const name = nameInput.value.trim();\n\n    if (!name) {\n      errorElement.textContent = 'Name is required';\n      return false;\n    }\n\n    if (name.length < 3) {\n      errorElement.textContent = 'Name must be at least 3 characters';\n      return false;\n    }\n\n    errorElement.textContent = '';\n    return true;\n  }\n\n  _validateEmail() {\n    const emailInput = document.querySelector('#email');\n    const errorElement = document.querySelector('#email-error');\n\n    if (!emailInput || !errorElement) return false;\n\n    const email = emailInput.value.trim();\n\n    if (!email) {\n      errorElement.textContent = 'Email is required';\n      return false;\n    }\n\n    if (!validateEmail(email)) {\n      errorElement.textContent = 'Please enter a valid email address';\n      return false;\n    }\n\n    errorElement.textContent = '';\n    return true;\n  }\n\n  _validatePassword() {\n    const passwordInput = document.querySelector('#password');\n    const errorElement = document.querySelector('#password-error');\n\n    if (!passwordInput || !errorElement) return false;\n\n    const password = passwordInput.value.trim();\n\n    if (!password) {\n      errorElement.textContent = 'Password is required';\n      return false;\n    }\n\n    if (password.length < 8) {\n      errorElement.textContent = 'Password must be at least 8 characters';\n      return false;\n    }\n\n    errorElement.textContent = '';\n    return true;\n  }\n}\n","import DicodingStoryApi from '../data/api';\nimport { isOnline } from '../utils/index';\n\nclass StoryDetailPresenter {\n  constructor({ view, id }) {\n    this._view = view;\n    this._id = id;\n    this._map = null;\n    this._story = null;\n    this._mapInitialized = false;\n  }\n\n  async init() {\n    this._view.renderPage();\n    await this._loadStoryDetail();\n    this._setupOnlineListener();\n    this._setupActions();\n  }\n\n  async _loadStoryDetail() {\n    try {\n      this._view.showLoading();\n\n      const token = localStorage.getItem('token');\n      if (!token) {\n        this._view.showLoginRequired();\n        return;\n      }\n\n      // Coba mendapatkan data dari cache terlebih dahulu\n      const cachedStory = this._getCachedStory();\n\n      // Selalu coba untuk mendapatkan data dari server terlebih dahulu\n      // tanpa memperdulikan status koneksi\n      try {\n        const response = await DicodingStoryApi.getStoryDetail({\n          token,\n          id: this._id,\n        });\n\n        if (response.error) {\n          throw new Error(response.message || 'Gagal memuat cerita');\n        }\n\n        this._story = response.story;\n        this._cacheStory(response.story);\n        this._view.renderStoryDetail(response.story);\n        this._view.hideOfflineMessage();\n\n        if (this._story.lat && this._story.lon) {\n          this._initMapWithDelay(300);\n        }\n      } catch (apiError) {\n        console.error('API error:', apiError);\n\n        // Jika ada data cache, tampilkan data cache\n        if (cachedStory) {\n          console.log('Loading from cache instead');\n          this._story = cachedStory;\n          this._view.renderStoryDetail(cachedStory);\n          this._view.showOfflineMessage();\n\n          if (cachedStory.lat && cachedStory.lon && !this._mapInitialized) {\n            this._initMapWithDelay(300);\n          }\n        } else {\n          // Jika tidak ada data cache, tampilkan pesan error\n          this._view.showError(apiError.message);\n        }\n      }\n    } catch (error) {\n      console.error('Unexpected error:', error);\n\n      // Coba ambil dari cache sebagai fallback\n      const cachedStory = this._getCachedStory();\n      if (cachedStory) {\n        this._story = cachedStory;\n        this._view.renderStoryDetail(cachedStory);\n        this._view.showOfflineMessage();\n\n        if (cachedStory.lat && cachedStory.lon && !this._mapInitialized) {\n          this._initMapWithDelay(300);\n        }\n      } else {\n        this._view.showError('Terjadi kesalahan. Silakan coba lagi.');\n      }\n    } finally {\n      this._view.hideLoading();\n    }\n  }\n\n  _setupOnlineListener() {\n    window.addEventListener('online', () => {\n      if (!this._story) {\n        this._loadStoryDetail();\n      } else {\n        this._view.hideOfflineMessage();\n      }\n    });\n\n    window.addEventListener('offline', () => {\n      if (this._story) {\n        this._view.showOfflineMessage();\n      }\n    });\n  }\n\n  _initMapWithDelay(delay = 100) {\n    if (!window.L) {\n      console.error('Leaflet library not available');\n      return;\n    }\n\n    setTimeout(() => {\n      this._initMap();\n    }, delay);\n  }\n\n  _initMap() {\n    if (this._mapInitialized) return;\n\n    // Make sure story exists and has valid coordinates\n    if (!this._story) {\n      console.error('Cannot initialize map: story is undefined');\n      return;\n    }\n\n    // Check if coordinates are valid numbers\n    const lat = parseFloat(this._story.lat);\n    const lon = parseFloat(this._story.lon);\n\n    if (isNaN(lat) || isNaN(lon)) {\n      console.error('Cannot initialize map: invalid coordinates', {\n        lat: this._story.lat,\n        lon: this._story.lon,\n      });\n      return;\n    }\n\n    const mapContainer = this._view.getMapContainer();\n    if (!mapContainer) {\n      console.error('Cannot initialize map: container not found');\n      return;\n    }\n\n    try {\n      console.log('Initializing map with coordinates:', lat, lon);\n\n      // Create map instance\n      this._map = L.map(mapContainer).setView([lat, lon], 13);\n\n      // Add tile layers\n      const baseMaps = this._createBaseMaps();\n\n      // Add default layer\n      baseMaps['Street'].addTo(this._map);\n\n      // Add layer control\n      L.control.layers(baseMaps, {}, { position: 'topright' }).addTo(this._map);\n\n      // Add marker\n      this._addStoryMarker();\n\n      // Add locate control\n      this._addLocateControl();\n\n      // Update map size after container is fully visible\n      this._updateMapSize();\n\n      this._mapInitialized = true;\n      console.log('Map initialization complete');\n    } catch (error) {\n      console.error('Error initializing map:', error);\n      this._view.showMapError();\n    }\n  }\n\n  _createBaseMaps() {\n    const baseMaps = {};\n\n    // Basic OpenStreetMap\n    baseMaps['Street'] = L.tileLayer(\n      'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\n      {\n        attribution:\n          '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\n        maxZoom: 19,\n      }\n    );\n\n    // Satellite view\n    baseMaps['Satellite'] = L.tileLayer(\n      'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}',\n      {\n        attribution:\n          'Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community',\n        maxZoom: 19,\n      }\n    );\n\n    // Dark mode\n    baseMaps['Dark'] = L.tileLayer(\n      'https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png',\n      {\n        attribution:\n          '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors &copy; <a href=\"https://carto.com/attributions\">CARTO</a>',\n        maxZoom: 19,\n      }\n    );\n\n    // Topographic map\n    baseMaps['Topographic'] = L.tileLayer(\n      'https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png',\n      {\n        attribution:\n          'Map data: &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors, <a href=\"http://viewfinderpanoramas.org\">SRTM</a> | Map style: &copy; <a href=\"https://opentopomap.org\">OpenTopoMap</a> (<a href=\"https://creativecommons.org/licenses/by-sa/3.0/\">CC-BY-SA</a>)',\n        maxZoom: 17,\n      }\n    );\n\n    return baseMaps;\n  }\n\n  _addStoryMarker() {\n    if (!this._map) {\n      console.error('Cannot add marker: map is not initialized');\n      return;\n    }\n\n    if (!this._story) {\n      console.error('Cannot add marker: story is undefined');\n      return;\n    }\n\n    try {\n      // Check if coordinates are valid numbers\n      const lat = parseFloat(this._story.lat);\n      const lon = parseFloat(this._story.lon);\n\n      if (isNaN(lat) || isNaN(lon)) {\n        console.error('Cannot add marker: invalid coordinates', {\n          lat: this._story.lat,\n          lon: this._story.lon,\n        });\n        return;\n      }\n\n      // Safely handle missing data\n      const name = this._story.name || 'Untitled Story';\n      const description = this._story.description || '';\n\n      const popup = `\n        <div class=\"custom-popup\">\n          <h3>${name}</h3>\n          <p>${description.substring(0, 100)}${description.length > 100 ? '...' : ''}</p>\n        </div>\n      `;\n\n      L.marker([lat, lon]).addTo(this._map).bindPopup(popup).openPopup();\n\n      console.log('Marker added successfully');\n    } catch (error) {\n      console.error('Error adding marker:', error);\n    }\n  }\n\n  _addLocateControl() {\n    if (!this._map) return;\n\n    L.control\n      .locate({\n        position: 'topright',\n        strings: {\n          title: 'Show my location',\n        },\n        locateOptions: {\n          enableHighAccuracy: true,\n        },\n      })\n      .addTo(this._map);\n  }\n\n  _updateMapSize() {\n    if (!this._map) return;\n\n    // Resize map after a delay to ensure the container is fully rendered\n    setTimeout(() => {\n      this._map.invalidateSize();\n    }, 300);\n\n    // Also resize map on window resize\n    window.addEventListener('resize', () => {\n      if (this._map) {\n        this._map.invalidateSize();\n      }\n    });\n  }\n\n  _cacheStory(story) {\n    try {\n      // Cache the individual story with timestamp\n      const cacheData = {\n        ...story,\n        cachedAt: new Date().toISOString(),\n      };\n\n      localStorage.setItem(`story_${story.id}`, JSON.stringify(cacheData));\n\n      // Also update the story in the stories cache if it exists\n      const cachedStories = JSON.parse(\n        localStorage.getItem('cachedStories') || '[]'\n      );\n\n      const updatedCache = cachedStories.map((item) =>\n        item.id === story.id ? cacheData : item\n      );\n\n      // If story wasn't in the cache, add it\n      if (!cachedStories.some((item) => item.id === story.id)) {\n        updatedCache.push(cacheData);\n      }\n\n      // Limit cache size to prevent storage issues\n      const limitedCache = updatedCache.slice(0, 50);\n      localStorage.setItem('cachedStories', JSON.stringify(limitedCache));\n    } catch (error) {\n      console.error('Error caching story:', error);\n    }\n  }\n\n  _getCachedStory() {\n    try {\n      // Try to get the individual cached story first\n      const cachedStoryJson = localStorage.getItem(`story_${this._id}`);\n      if (cachedStoryJson) {\n        try {\n          const parsedStory = JSON.parse(cachedStoryJson);\n\n          // Validate that we have required fields\n          if (!parsedStory || typeof parsedStory !== 'object') {\n            console.error('Invalid cached story format:', parsedStory);\n            return null;\n          }\n\n          // Ensure required properties exist\n          parsedStory.name = parsedStory.name || 'Unknown User';\n          parsedStory.description = parsedStory.description || '';\n          parsedStory.photoUrl =\n            parsedStory.photoUrl || './images/placeholder.jpg';\n          parsedStory.createdAt =\n            parsedStory.createdAt || new Date().toISOString();\n\n          return parsedStory;\n        } catch (parseError) {\n          console.error('Error parsing cached story:', parseError);\n          // Remove invalid cache entry\n          localStorage.removeItem(`story_${this._id}`);\n          return null;\n        }\n      }\n\n      // If not found, check in the stories cache\n      const cachedStoriesJson = localStorage.getItem('cachedStories');\n      if (!cachedStoriesJson) return null;\n\n      try {\n        const cachedStories = JSON.parse(cachedStoriesJson);\n        if (!Array.isArray(cachedStories)) {\n          console.error('Cached stories is not an array:', cachedStories);\n          return null;\n        }\n\n        const foundStory = cachedStories.find(\n          (story) => story && story.id === this._id\n        );\n        if (!foundStory) return null;\n\n        // Ensure required properties exist\n        foundStory.name = foundStory.name || 'Unknown User';\n        foundStory.description = foundStory.description || '';\n        foundStory.photoUrl = foundStory.photoUrl || './images/placeholder.jpg';\n        foundStory.createdAt = foundStory.createdAt || new Date().toISOString();\n\n        return foundStory;\n      } catch (parseError) {\n        console.error('Error parsing cached stories:', parseError);\n        return null;\n      }\n    } catch (error) {\n      console.error('Error reading cached story:', error);\n      return null;\n    }\n  }\n\n  _setupActions() {\n    // Setup share button if supported\n    if (navigator.share) {\n      this._view.showShareButton();\n      this._view.setShareButtonCallback(() => this._shareStory());\n    }\n\n    // Setup favorite button callback\n    this._view.setFavoriteButtonCallback((isFavorite) => {\n      this._toggleFavorite(isFavorite);\n    });\n  }\n\n  async _shareStory() {\n    if (!this._story) return;\n\n    try {\n      const shareData = {\n        title: `Cerita dari ${this._story.name}`,\n        text: this._story.description,\n        url: window.location.href,\n      };\n\n      await navigator.share(shareData);\n      if (window.showToast) {\n        window.showToast('Cerita berhasil dibagikan!', 'success');\n      }\n    } catch (error) {\n      console.error('Error sharing story:', error);\n      // Don't show error for user cancellation\n      if (error.name !== 'AbortError') {\n        window.showToast &&\n          window.showToast('Gagal membagikan cerita', 'error');\n      }\n    }\n  }\n\n  _toggleFavorite(isFavorite) {\n    if (!this._story) return;\n\n    try {\n      // Get current favorites from localStorage\n      const favoritesJson = localStorage.getItem('favoriteStories');\n      let favorites = favoritesJson ? JSON.parse(favoritesJson) : [];\n\n      if (isFavorite) {\n        // Add to favorites if not already there\n        if (!favorites.includes(this._story.id)) {\n          favorites.push(this._story.id);\n          window.showToast &&\n            window.showToast('Ditambahkan ke favorit!', 'success');\n        }\n      } else {\n        // Remove from favorites\n        favorites = favorites.filter((id) => id !== this._story.id);\n        window.showToast && window.showToast('Dihapus dari favorit', 'info');\n      }\n\n      // Save updated favorites\n      localStorage.setItem('favoriteStories', JSON.stringify(favorites));\n    } catch (error) {\n      console.error('Error toggling favorite:', error);\n    }\n  }\n\n  async saveCurrentStoryToOffline() {\n    if (this._story) {\n      await saveStories([this._story]);\n      window.showToast &&\n        window.showToast('Cerita disimpan untuk offline', 'success');\n    }\n  }\n}\n\nexport default StoryDetailPresenter;\n","import '../components/header';\nimport '../components/loader';\nimport '../components/footer';\nimport '../components/sidebar';\nimport { showFormattedDate } from '../utils/index';\nimport StoryDetailPresenter from '../presenter/story-detail-presenter';\nimport { isOnline } from '../utils/index';\n\nexport default class StoryDetailPage {\n  constructor() {\n    const { id } = this._getUrlParams();\n    this._id = id;\n    this._presenter = new StoryDetailPresenter({\n      view: this,\n      id: this._id,\n    });\n    this._mapContainer = null;\n  }\n\n  renderPage() {\n    if (!this._id) {\n      this.showInvalidIdError();\n      return;\n    }\n  }\n\n  async render() {\n    return `\n      <app-sidebar></app-sidebar>\n      <app-header></app-header>\n      <main id=\"main-content\" class=\"main-content\" tabindex=\"-1\">\n        <section class=\"container\">\n          <div id=\"story-content\">\n            <div class=\"loading-placeholder\">\n              <div class=\"ph-item\">\n                <div class=\"ph-col-12\">\n                  <div class=\"ph-picture\"></div>\n                  <div class=\"ph-row\">\n                    <div class=\"ph-col-4\"></div>\n                    <div class=\"ph-col-8 empty\"></div>\n                    <div class=\"ph-col-6\"></div>\n                    <div class=\"ph-col-6 empty\"></div>\n                    <div class=\"ph-col-12\"></div>\n                    <div class=\"ph-col-12\"></div>\n                    <div class=\"ph-col-12\"></div>\n                    <div class=\"ph-col-8\"></div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n          \n          <div id=\"offline-notice\" class=\"offline-notice mt-2 hidden\">\n              <i class=\"fas fa-wifi-slash\"></i> You are currently offline. \n              Some features may be limited.\n            </div>\n        </section>\n      </main>\n      <app-footer></app-footer>\n      <app-loader></app-loader>\n    `;\n  }\n\n  async afterRender() {\n    this._presenter.init();\n  }\n\n  renderStoryDetail(story) {\n    const storyContent = document.querySelector('#story-content');\n    if (!story || !storyContent) return;\n\n    // Ensure story properties exist or use defaults\n    const storyName = story.name || 'Unknown User';\n    const storyDescription = story.description || 'No description provided';\n    const storyPhoto = story.photoUrl || './images/placeholder.jpg';\n    const storyCreatedAt = story.createdAt || new Date().toISOString();\n\n    const formattedDate = showFormattedDate(storyCreatedAt, 'id-ID', {\n      weekday: 'long',\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit',\n    });\n\n    // Generate consistent color from story name\n    const userColor = this._getUserColor(storyName);\n    const storyTitleId = `story-title-${story.id}`;\n    const storyDescId = `story-desc-${story.id}`;\n\n    // Check if the story is in favorites\n    const isFavorite = this._isInFavorites(story.id);\n\n    storyContent.innerHTML = `\n      <article class=\"story-detail-item\" id=\"story-article\" aria-labelledby=\"${storyTitleId}\">\n        <div class=\"story-image-wrapper\">\n        <img \n          class=\"story-detail-image\" \n            src=\"${storyPhoto}\" \n            alt=\"Photo shared by ${storyName}\" \n          loading=\"lazy\"\n            onerror=\"this.src='./images/placeholder.jpg'\"\n          >\n          <div class=\"story-image-overlay\">\n            <div class=\"story-image-badge\" style=\"background-color: ${userColor}\">\n              <i class=\"fas fa-camera-retro\" aria-hidden=\"true\"></i>\n            </div>\n          </div>\n        </div>\n        \n        <div class=\"story-detail-content\">\n          <div class=\"story-header\">\n            <div class=\"story-user\">\n              <div class=\"user-avatar\" aria-hidden=\"true\" style=\"background-color: ${userColor}\">\n                ${this._getInitials(storyName)}\n              </div>\n              <div>\n                <h1 class=\"story-name\" id=\"${storyTitleId}\">${storyName}</h1>\n                <time class=\"story-date\" datetime=\"${storyCreatedAt}\">\n                  <i class=\"far fa-calendar-alt\" aria-hidden=\"true\"></i> ${formattedDate}\n                </time>\n              </div>\n            </div>\n            \n            <div class=\"story-actions-top\">\n              <button id=\"favorite-button\" class=\"icon-button ${isFavorite ? 'active' : ''}\" aria-label=\"${isFavorite ? 'Remove from favorites' : 'Add to favorites'}\">\n                <i class=\"fas ${isFavorite ? 'fa-heart' : 'fa-heart'}\" aria-hidden=\"true\"></i>\n              </button>\n              \n              <button id=\"share-button\" class=\"icon-button hidden\" aria-label=\"Share this story\">\n                <i class=\"fas fa-share-alt\" aria-hidden=\"true\"></i>\n              </button>\n            </div>\n          </div>\n          \n          <div class=\"story-body\">\n            <p class=\"story-description\" id=\"${storyDescId}\">${storyDescription}</p>\n          </div>\n          \n          ${\n            story.lat && story.lon\n              ? `\n                <div class=\"story-location\">\n                  <h2 class=\"section-title\">\n                  <i class=\"fas fa-map-marker-alt\" aria-hidden=\"true\"></i>\n                  Location\n                </h2>\n                  <div class=\"story-map-container\">\n                    <div class=\"story-map-large\" id=\"detail-map\" tabindex=\"0\" \n                         aria-label=\"Map showing the location of ${storyName}'s story\"></div>\n                  </div>\n                  <p class=\"map-instructions\">\n                    <i class=\"fas fa-info-circle\" aria-hidden=\"true\"></i>\n                    You can switch between different map styles using the layer control in the top right.\n                  </p>\n                </div>\n              `\n              : ''\n          }\n          \n          <div class=\"story-actions mt-3\">\n            <a href=\"#/\" class=\"back-link\" aria-label=\"Back to stories list\">\n            <i class=\"fas fa-arrow-left\" aria-hidden=\"true\"></i>\n              Back to Stories\n            </a>\n            \n           \n            \n            <a href=\"#/stories/add\" class=\"action-button\" aria-label=\"Share your own story\">\n              <i class=\"fas fa-plus-circle\" aria-hidden=\"true\"></i>\n              Share Your Story\n            </a>\n          </div>\n        </div>\n      </article>\n    `;\n\n    if (story.lat && story.lon) {\n      this._mapContainer = document.getElementById('detail-map');\n    }\n\n    // Setup favorite button\n    this._setupFavoriteButton(isFavorite);\n  }\n\n  getMapContainer() {\n    return this._mapContainer;\n  }\n\n  showLoading() {\n    const loader = document.querySelector('app-loader');\n    if (loader) loader.show('Loading story...');\n  }\n\n  hideLoading() {\n    const loader = document.querySelector('app-loader');\n    if (loader) loader.hide();\n  }\n\n  showOfflineMessage() {\n    const offlineNotice = document.getElementById('offline-notice');\n    if (offlineNotice) {\n      offlineNotice.classList.remove('hidden');\n    }\n  }\n\n  hideOfflineMessage() {\n    const offlineNotice = document.getElementById('offline-notice');\n    if (offlineNotice) {\n      offlineNotice.classList.add('hidden');\n    }\n  }\n\n  showOfflineNoDataMessage() {\n    Swal.fire({\n      icon: 'warning',\n      title: 'Offline',\n      text: 'This story is not available offline. Please connect to the internet and try again.',\n      confirmButtonColor: '#4361ee',\n    }).then(() => {\n      window.location.hash = '#/';\n    });\n  }\n\n  showLoginRequired() {\n    Swal.fire({\n      icon: 'warning',\n      title: 'Login Required',\n      text: 'Please login to view story details',\n      confirmButtonText: 'Login Now',\n      confirmButtonColor: '#4361ee',\n    }).then(() => {\n      window.location.hash = '#/login';\n    });\n  }\n\n  showInvalidIdError() {\n    Swal.fire({\n      icon: 'error',\n      title: 'Invalid Story ID',\n      text: 'The story ID is missing or invalid',\n      confirmButtonColor: '#4361ee',\n    }).then(() => {\n      window.location.hash = '#/';\n    });\n  }\n\n  showError(message) {\n    Swal.fire({\n      icon: 'error',\n      title: 'Error',\n      text: message || 'Failed to load story',\n      confirmButtonColor: '#4361ee',\n    }).then(() => {\n      window.location.hash = '#/';\n    });\n  }\n\n  showTimeoutError() {\n    const offlineNotice = document.getElementById('offline-notice');\n    if (offlineNotice) {\n      offlineNotice.innerHTML = `\n        <i class=\"fas fa-exclamation-triangle\"></i> \n        Server response is slow. Showing cached data if available.\n      `;\n      offlineNotice.classList.remove('hidden');\n      offlineNotice.style.backgroundColor = '#f8961e'; // warning color\n    }\n\n    Swal.fire({\n      icon: 'warning',\n      title: 'Connection Issue',\n      text: \"The server is taking too long to respond. We'll try to show cached data if available.\",\n      confirmButtonColor: '#4361ee',\n      showCancelButton: true,\n      cancelButtonText: 'Back to Home',\n      confirmButtonText: 'Continue with Cache',\n    }).then((result) => {\n      if (!result.isConfirmed) {\n        window.location.hash = '#/';\n      }\n    });\n  }\n\n  showMapError() {\n    const mapContainer = document.querySelector('.story-map-container');\n    if (mapContainer) {\n      mapContainer.innerHTML = `\n        <div class=\"map-error-container\">\n          <div class=\"map-error-message\">\n            <i class=\"fas fa-map-marked-alt\"></i>\n            <p>Failed to load map. Please try refreshing the page.</p>\n          </div>\n        </div>\n      `;\n    }\n  }\n\n  _getUrlParams() {\n    const hash = window.location.hash;\n    // Gunakan regex untuk mengekstrak ID dari URL\n    const match = hash.match(/#\\/stories\\/([^/]+)$/);\n    return { id: match ? match[1] : null };\n  }\n\n  _getInitials(name) {\n    if (!name || typeof name !== 'string') return 'U';\n\n    return name\n      .split(' ')\n      .map((part) => part.charAt(0))\n      .join('')\n      .toUpperCase()\n      .substring(0, 2); // Limit to 2 characters\n  }\n\n  _getUserColor(name) {\n    // Generate consistent color based on user name\n    const colors = [\n      '#4361ee', // primary\n      '#3f37c9', // secondary\n      '#4895ef', // accent\n      '#4cc9f0', // success\n      '#f72585', // danger\n      '#7209b7', // purple\n      '#3a0ca3', // indigo\n      '#4cc9f0', // blue\n      '#f72585', // pink\n      '#f8961e', // orange\n    ];\n\n    // Simple hash function to get consistent color for same name\n    const hash = name.split('').reduce((acc, char) => {\n      return char.charCodeAt(0) + ((acc << 5) - acc);\n    }, 0);\n\n    return colors[Math.abs(hash) % colors.length];\n  }\n\n  _isInFavorites(storyId) {\n    try {\n      const favoritesJson = localStorage.getItem('favoriteStories');\n      if (!favoritesJson) return false;\n\n      const favorites = JSON.parse(favoritesJson);\n      return Array.isArray(favorites) && favorites.includes(storyId);\n    } catch (error) {\n      console.error('Error checking favorites:', error);\n      return false;\n    }\n  }\n\n  _setupFavoriteButton(initialState) {\n    const favoriteButton = document.getElementById('favorite-button');\n    if (!favoriteButton) return;\n\n    favoriteButton.addEventListener('click', () => {\n      // Toggle state\n      const currentState = favoriteButton.classList.contains('active');\n      const newState = !currentState;\n\n      // Update UI\n      if (newState) {\n        favoriteButton.classList.add('active');\n        favoriteButton.setAttribute('aria-label', 'Remove from favorites');\n      } else {\n        favoriteButton.classList.remove('active');\n        favoriteButton.setAttribute('aria-label', 'Add to favorites');\n      }\n\n      // Notify presenter\n      if (this._favoriteCallback) {\n        this._favoriteCallback(newState);\n      }\n    });\n  }\n\n  setFavoriteButtonCallback(callback) {\n    this._favoriteCallback = callback;\n  }\n\n  showShareButton() {\n    const shareButton = document.getElementById('share-button');\n    if (shareButton) {\n      shareButton.classList.remove('hidden');\n    }\n  }\n\n  setShareButtonCallback(callback) {\n    const shareButton = document.getElementById('share-button');\n    if (shareButton) {\n      shareButton.addEventListener('click', callback);\n    }\n  }\n\n  animateRemoval(callback) {\n    const article = document.getElementById('story-article');\n    if (!article) {\n      if (callback) callback();\n      return;\n    }\n\n    // Add animation\n    article.style.transition = 'all 0.5s ease-out';\n    article.style.opacity = '0';\n    article.style.transform = 'scale(0.9)';\n\n    // Call callback after animation completes\n    setTimeout(() => {\n      if (callback) callback();\n    }, 500);\n  }\n\n  cancelRemovalAnimation() {\n    const article = document.getElementById('story-article');\n    if (!article) return;\n\n    // Restore visibility\n    article.style.opacity = '1';\n    article.style.transform = 'scale(1)';\n  }\n}\n","import DicodingStoryApi from '../data/api';\nimport CONFIG from '../config';\nimport { formatFileSize, isOnline } from '../utils/index';\n\nclass AddStoryPresenter {\n  constructor({ view }) {\n    this._view = view;\n    this._photoFile = null;\n    this._map = null;\n    this._marker = null;\n    this._cameraStream = null;\n    this._mapInitialized = false;\n\n    // Set up navigation event handling to ensure camera is stopped when navigating away\n    window.addEventListener('hashchange', () => {\n      this.stopCamera();\n    });\n\n    // Also stop camera when the page is unloaded\n    window.addEventListener('beforeunload', () => {\n      this.stopCamera();\n    });\n  }\n\n  init() {\n    this._setupForm();\n    this._setupPhotoPreview();\n    this._setupCamera();\n    this._setupLocationCheckbox();\n    this._setupInputValidation();\n    this._setupAutoSaveDraft();\n\n    // Check permissions ahead of time\n    this._checkMediaPermissions();\n  }\n\n  loadRecentDrafts() {\n    try {\n      const recentsJson = localStorage.getItem('recentDrafts');\n      if (!recentsJson) {\n        this._view.displayRecentDrafts([]);\n        return;\n      }\n\n      const recents = JSON.parse(recentsJson);\n      this._view.displayRecentDrafts(recents);\n    } catch (error) {\n      console.error('Error loading recent drafts:', error);\n      this._view.displayRecentDrafts([]);\n    }\n  }\n\n  useDraft(draftId) {\n    try {\n      const recentsJson = localStorage.getItem('recentDrafts');\n      if (!recentsJson) return;\n\n      const recents = JSON.parse(recentsJson);\n      const draft = recents.find((d) => d.id === draftId);\n\n      if (draft) {\n        // Extract full description if available\n        let description = draft.fullDescription || draft.description;\n        this._view.applyDraftToForm(description);\n      }\n    } catch (error) {\n      console.error('Error using draft:', error);\n    }\n  }\n\n  _checkMediaPermissions() {\n    // Check if browser supports permissions API\n    if (navigator.permissions && navigator.permissions.query) {\n      navigator.permissions\n        .query({ name: 'camera' })\n        .then((permissionStatus) => {\n          console.log('Camera permission status:', permissionStatus.state);\n          // We could update the UI based on permission state\n          if (permissionStatus.state === 'denied') {\n            const cameraButton = document.querySelector('#camera-button');\n            if (cameraButton) {\n              cameraButton.classList.add('permission-denied');\n              cameraButton.title =\n                'Camera permission denied. Please update your browser settings.';\n            }\n          }\n\n          // Listen for changes in permission state\n          permissionStatus.onchange = () => {\n            console.log(\n              'Camera permission status changed to:',\n              permissionStatus.state\n            );\n            const cameraButton = document.querySelector('#camera-button');\n            if (cameraButton) {\n              if (permissionStatus.state === 'denied') {\n                cameraButton.classList.add('permission-denied');\n                cameraButton.title =\n                  'Camera permission denied. Please update your browser settings.';\n              } else {\n                cameraButton.classList.remove('permission-denied');\n                cameraButton.title = '';\n              }\n            }\n          };\n        })\n        .catch((error) => {\n          console.log('Error checking camera permission:', error);\n        });\n    }\n  }\n\n  stopCamera() {\n    if (this._cameraStream) {\n      try {\n        const tracks = this._cameraStream.getTracks();\n        tracks.forEach((track) => track.stop());\n      } catch (error) {\n        console.error('Error stopping camera tracks:', error);\n      }\n      this._cameraStream = null;\n\n      // Also reset the camera UI\n      if (this._view) {\n        this._view.resetCameraUI();\n      }\n    }\n  }\n\n  _setupAutoSaveDraft() {\n    // Autosave draft every 30 seconds\n    let draftTimeout;\n    const descriptionInput = document.querySelector('#description');\n\n    if (descriptionInput) {\n      descriptionInput.addEventListener('input', () => {\n        clearTimeout(draftTimeout);\n        draftTimeout = setTimeout(() => {\n          this._saveDraft(descriptionInput.value);\n        }, 30000); // Save after 30 seconds of inactivity\n      });\n    }\n  }\n\n  _saveDraft(text) {\n    if (!text || text.trim().length < 5) return; // Don't save very short drafts\n\n    try {\n      // Get existing drafts\n      const draftsJson = localStorage.getItem('recentDrafts');\n      let drafts = draftsJson ? JSON.parse(draftsJson) : [];\n\n      // Create a new draft\n      const preview = text.substring(0, 50) + (text.length > 50 ? '...' : '');\n      const newDraft = {\n        id: Date.now().toString(),\n        description: preview,\n        fullDescription: text,\n        timestamp: new Date().toISOString(),\n      };\n\n      // Add to beginning of array\n      drafts.unshift(newDraft);\n\n      // Limit to 5 drafts\n      drafts = drafts.slice(0, 5);\n\n      // Save back to localStorage\n      localStorage.setItem('recentDrafts', JSON.stringify(drafts));\n\n      // Show toast notification\n      window.showToast && window.showToast('Draft saved automatically', 'info');\n    } catch (error) {\n      console.error('Error saving draft:', error);\n    }\n  }\n\n  _setupForm() {\n    this._view.setSubmitCallback(async (formData) => {\n      const token = localStorage.getItem('token');\n      if (!token) {\n        await this._view.showLoginRequiredAlert();\n        window.location.hash = '#/login';\n        return;\n      }\n\n      // Validate form before submission\n      if (!this._validateForm()) {\n        this._view.showFormValidationError();\n        return;\n      }\n\n      // Double-check that formData has required fields\n      if (!formData.has('description') || !formData.get('description').trim()) {\n        this._view.showDescriptionError('Description is required');\n        this._view.showFormValidationError();\n        return;\n      }\n\n      // Ensure photo is included in formData\n      if (!formData.has('photo') || !formData.get('photo')) {\n        // If we have a photo in memory but it's not in formData, add it\n        if (this._photoFile) {\n          formData.set('photo', this._photoFile);\n        } else {\n          this._view.showPhotoError('Please select or take a photo');\n          this._view.showFormValidationError();\n          return;\n        }\n      }\n\n      this._view.showLoader('Saving your story...');\n      this._view.showProgressBar();\n\n      try {\n        await DicodingStoryApi.addNewStory({\n          token,\n          data: formData,\n          onProgress: (progress) => {\n            this._view.updateProgressBar(progress);\n          },\n        });\n\n        // Reset progress bar after completion\n        this._view.updateProgressBar(100);\n\n        setTimeout(() => {\n          this._view.hideProgressBar();\n        }, 500);\n\n        await this._view.showSuccessAlert();\n\n        // Apply confetti animation for success\n        this._view.showConfetti();\n\n        // Add story to recents\n        this._addToRecents(formData.get('description'));\n\n        // Navigate home after a short delay for better UX\n        setTimeout(() => {\n          window.location.hash = '#/';\n          this._view.resetForm();\n\n          // Make sure camera is stopped\n          this.stopCamera();\n        }, 1000);\n      } catch (error) {\n        this._view.hideProgressBar();\n        this._view.showErrorAlert(error.message);\n      } finally {\n        this._view.hideLoader();\n      }\n    });\n  }\n\n  _setupPhotoPreview() {\n    this._view.setPhotoInputCallback((file) => {\n      if (!file) return;\n\n      // Validate file size\n      if (file.size > CONFIG.MAX_PHOTO_SIZE) {\n        this._view.showPhotoError(\n          `File too large. Maximum size is ${formatFileSize(CONFIG.MAX_PHOTO_SIZE)}`\n        );\n        return;\n      }\n\n      // Validate file type\n      if (!['image/jpeg', 'image/png', 'image/jpg'].includes(file.type)) {\n        this._view.showPhotoError('Only JPEG and PNG images are allowed');\n        return;\n      }\n\n      this._photoFile = file;\n      this._view.clearPhotoError();\n      this._view.showPhotoPreview(file);\n    });\n  }\n\n  _setupCamera() {\n    this._view.setOpenCameraCallback(async () => {\n      try {\n        // Check if browser supports mediaDevices\n        if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {\n          throw new Error('Your browser does not support camera access');\n        }\n\n        // First attempt to stop any existing streams\n        this.stopCamera();\n\n        // Try accessing the camera with environment (back camera) preference\n        const stream = await navigator.mediaDevices.getUserMedia({\n          video: {\n            facingMode: 'environment',\n            width: { ideal: 1280 },\n            height: { ideal: 720 },\n          },\n          audio: false,\n        });\n\n        this._cameraStream = stream;\n        this._view.showCameraStream(stream);\n\n        // Make sure we clean up the camera stream when page unloads\n        window.addEventListener(\n          'beforeunload',\n          () => {\n            this.stopCamera();\n          },\n          { once: true }\n        );\n      } catch (error) {\n        console.error('Error accessing camera:', error);\n\n        // Provide more specific error messages based on error type\n        if (error.name === 'NotAllowedError') {\n          this._view.showCameraError(\n            'Camera access denied. Please allow camera access in your browser settings.'\n          );\n        } else if (error.name === 'NotFoundError') {\n          this._view.showCameraError(\n            'No camera found on your device or camera is in use by another application.'\n          );\n        } else if (error.name === 'NotReadableError') {\n          this._view.showCameraError(\n            'Could not access camera. Your camera might be in use by another application.'\n          );\n        } else if (error.name === 'OverconstrainedError') {\n          // Try again with less constraints\n          try {\n            const fallbackStream = await navigator.mediaDevices.getUserMedia({\n              video: true,\n              audio: false,\n            });\n            this._cameraStream = fallbackStream;\n            this._view.showCameraStream(fallbackStream);\n          } catch (fallbackError) {\n            this._view.showCameraError(\n              'Could not access camera with requested settings. Please try a different device.'\n            );\n          }\n        } else {\n          this._view.showCameraError(\n            'Could not access camera: ' + (error.message || 'Unknown error')\n          );\n        }\n      }\n    });\n\n    this._view.setTakePhotoCallback(() => {\n      if (!this._cameraStream) {\n        console.error('Cannot take photo: Camera stream is not available');\n        this._view.showCameraError('Camera is not ready. Please try again.');\n        return;\n      }\n\n      try {\n        const dataUrl = this._view.capturePhoto();\n        if (!dataUrl) {\n          console.error('Failed to capture photo: null data URL');\n          this._view.showCameraError('Failed to capture photo');\n          return;\n        }\n\n        // Add flash effect\n        this._view.showCameraFlash();\n\n        // Convert data URL to file object\n        const filename = 'camera-photo-' + new Date().getTime() + '.jpg';\n        const file = this._dataURLToFile(dataUrl, filename);\n\n        if (!file) {\n          console.error('Failed to convert data URL to file');\n          this._view.showCameraError('Failed to process captured photo');\n          return;\n        }\n\n        // Check file size for camera capture (same as photo upload validation)\n        if (file.size > CONFIG.MAX_PHOTO_SIZE) {\n          this._view.showPhotoError(\n            `File too large. Maximum size is ${formatFileSize(CONFIG.MAX_PHOTO_SIZE)}`\n          );\n          return;\n        }\n\n        this._photoFile = file;\n        this._view.showPhotoPreview(file);\n\n        // Provide feedback that photo was captured successfully\n        window.showToast &&\n          window.showToast('Photo captured successfully!', 'success');\n\n        // Stop camera after successful capture\n        setTimeout(() => {\n          this.stopCamera();\n        }, 500);\n      } catch (error) {\n        console.error('Error taking photo:', error);\n        this._view.showCameraError('Error capturing photo: ' + error.message);\n      }\n    });\n\n    // Setup close camera button\n    this._view.setCloseCameraCallback(() => {\n      this.stopCamera();\n    });\n  }\n\n  _dataURLToFile(dataUrl, filename) {\n    try {\n      if (\n        !dataUrl ||\n        typeof dataUrl !== 'string' ||\n        !dataUrl.startsWith('data:image/')\n      ) {\n        console.error('Invalid data URL format');\n        return null;\n      }\n\n      const arr = dataUrl.split(',');\n      if (arr.length !== 2) {\n        console.error('Invalid data URL structure');\n        return null;\n      }\n\n      const mimeMatch = arr[0].match(/:(.*?);/);\n      if (!mimeMatch || mimeMatch.length < 2) {\n        console.error('Could not extract MIME type from data URL');\n        return null;\n      }\n\n      const mime = mimeMatch[1];\n      const bstr = atob(arr[1]);\n      let n = bstr.length;\n      const u8arr = new Uint8Array(n);\n\n      while (n--) {\n        u8arr[n] = bstr.charCodeAt(n);\n      }\n\n      return new File([u8arr], filename, { type: mime });\n    } catch (error) {\n      console.error('Error converting data URL to file:', error);\n      return null;\n    }\n  }\n\n  _setupLocationCheckbox() {\n    this._view.setLocationCheckboxCallback((isChecked) => {\n      if (isChecked) {\n        this._view.showMapContainer();\n        if (!this._mapInitialized) {\n          // Initialize map with a small delay to ensure DOM is ready\n          setTimeout(() => {\n            this._initMap();\n          }, 300);\n        } else if (this._map) {\n          // If map was already initialized, just invalidate the size\n          this._map.invalidateSize();\n        }\n      } else {\n        this._view.hideMapContainer();\n      }\n    });\n  }\n\n  _setupInputValidation() {\n    this._view.setDescriptionInputCallback((value) => {\n      this._validateDescription(value);\n    });\n  }\n\n  _validateDescription(description) {\n    if (!description) {\n      this._view.showDescriptionError('Please enter a description');\n      return false;\n    }\n\n    if (description.length < 10) {\n      this._view.showDescriptionError(\n        'Description must be at least 10 characters'\n      );\n      return false;\n    }\n\n    // Check for potentially inappropriate content\n    const sensitiveWords = ['judi', 'poker', 'togel', 'seks', 'adult', 'xxx'];\n    const containsSensitiveContent = sensitiveWords.some((word) =>\n      description.toLowerCase().includes(word)\n    );\n\n    if (containsSensitiveContent) {\n      this._view.showDescriptionError(\n        'Your story may contain inappropriate content. Please revise.'\n      );\n      return false;\n    }\n\n    this._view.clearDescriptionError();\n    return true;\n  }\n\n  _validateForm() {\n    const isDescriptionValid = this._validateDescription(\n      this._view.getDescription()\n    );\n    const isPhotoValid = this._validatePhoto();\n\n    return isDescriptionValid && isPhotoValid;\n  }\n\n  _validatePhoto() {\n    // Photo input bisa dari file input atau dari kamera\n    if (!this._photoFile) {\n      const photoInput = document.querySelector('#photo');\n      // Coba cek apakah ada photo file yang dipilih\n      if (photoInput && photoInput.files.length > 0) {\n        this._photoFile = photoInput.files[0];\n      } else {\n        // Cek apakah ada preview image yang sudah diambil dari kamera\n        const photoPreview = document.querySelector('#photo-preview img');\n        if (!photoPreview || photoPreview.classList.contains('hidden')) {\n          this._view.showPhotoError('Please select or take a photo');\n          return false;\n        }\n      }\n    }\n\n    // Validate file size if we have a photo file\n    if (this._photoFile && this._photoFile.size > CONFIG.MAX_PHOTO_SIZE) {\n      this._view.showPhotoError(\n        `File too large. Maximum size is ${formatFileSize(CONFIG.MAX_PHOTO_SIZE)}`\n      );\n      return false;\n    }\n\n    return true;\n  }\n\n  _initMap() {\n    if (!window.L) {\n      console.error('Leaflet library not loaded!');\n      this._view.showMapError(\n        'Map library not loaded. Please check your internet connection and reload the page.'\n      );\n      return;\n    }\n\n    try {\n      // Pastikan elemen map ada\n      const mapElement = document.getElementById('map');\n      if (!mapElement) {\n        console.error('Map container element not found');\n        return;\n      }\n\n      console.log('Initializing map...');\n\n      // Buat instance peta dengan koordinat default Indonesia\n      this._map = L.map('map', {\n        zoomControl: true,\n        attributionControl: true,\n      }).setView(CONFIG.DEFAULT_MAP_CENTER, CONFIG.DEFAULT_MAP_ZOOM);\n\n      // Tambahkan tile layer\n      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n        attribution:\n          '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\n        maxZoom: 19,\n      }).addTo(this._map);\n\n      //  tampilan peta setelah dirender\n      setTimeout(() => {\n        if (this._map) {\n          console.log('Invalidating map size');\n          this._map.invalidateSize();\n        }\n      }, 100);\n\n      // Mark that map has been initialized\n      this._mapInitialized = true;\n\n      // Tambahkan geocoder jika tersedia\n      if (window.L.Control && window.L.Control.Geocoder) {\n        const geocoder = L.Control.Geocoder.nominatim({\n          geocodingQueryParams: {\n            countrycodes: 'id', // Default to Indonesia\n            limit: 5,\n          },\n        });\n\n        const control = L.Control.geocoder({\n          defaultMarkGeocode: false,\n          geocoder: geocoder,\n          placeholder: 'Search for places...',\n          errorMessage: 'Nothing found.',\n          suggestMinLength: 3,\n          suggestTimeout: 250,\n          queryMinLength: 1,\n        }).addTo(this._map);\n\n        control.on('markgeocode', (e) => {\n          const { lat, lng } = e.geocode.center;\n          this._updateLocation(lat, lng);\n\n          // Zoom to location\n          this._map.setView([lat, lng], 15);\n        });\n      } else {\n        console.warn('Geocoder control not available');\n      }\n\n      // Tambahkan locate control for finding user's location\n      if (window.L.control && window.L.control.locate) {\n        L.control\n          .locate({\n            position: 'topright',\n            strings: {\n              title: 'Temukan lokasi saya',\n            },\n            locateOptions: {\n              enableHighAccuracy: true,\n              maxZoom: 15,\n            },\n            flyTo: true,\n          })\n          .addTo(this._map);\n      } else {\n        console.warn('Locate control not available');\n      }\n\n      // Handle map click\n      this._map.on('click', (e) => {\n        this._updateLocation(e.latlng.lat, e.latlng.lng);\n      });\n\n      // Setup locate me button\n      this._view.setLocateMeCallback(() => {\n        if ('geolocation' in navigator) {\n          // Show loader while waiting for location\n          this._view.showLoader('Finding your location...');\n\n          navigator.geolocation.getCurrentPosition(\n            (position) => {\n              this._view.hideLoader();\n              const { latitude, longitude } = position.coords;\n              this._updateLocation(latitude, longitude);\n              this._map.setView([latitude, longitude], 15);\n              window.showToast &&\n                window.showToast('Location found!', 'success');\n            },\n            (error) => {\n              this._view.hideLoader();\n              console.error('Geolocation error:', error);\n              let errorMessage = 'Could not get your location.';\n\n              switch (error.code) {\n                case error.PERMISSION_DENIED:\n                  errorMessage =\n                    'Location access denied. Please check your browser settings.';\n                  break;\n                case error.POSITION_UNAVAILABLE:\n                  errorMessage = 'Location information is unavailable.';\n                  break;\n                case error.TIMEOUT:\n                  errorMessage = 'Location request timed out.';\n                  break;\n              }\n\n              this._view.showMapError(errorMessage);\n            },\n            { enableHighAccuracy: true, timeout: 10000, maximumAge: 0 }\n          );\n        } else {\n          this._view.showMapError(\n            'Geolocation is not supported by your browser'\n          );\n        }\n      });\n\n      // Setup search location button\n      this._view.setSearchLocationCallback(() => {\n        const geocoderControl = document.querySelector(\n          '.leaflet-control-geocoder'\n        );\n\n        if (geocoderControl) {\n          try {\n            // Try to expand the geocoder control\n            const searchButton = geocoderControl.querySelector(\n              '.leaflet-control-geocoder-icon'\n            );\n            const searchInput = geocoderControl.querySelector('input');\n\n            if (searchButton) {\n              searchButton.click();\n            }\n\n            if (searchInput) {\n              searchInput.focus();\n            }\n          } catch (error) {\n            console.error('Error expanding geocoder:', error);\n\n            // Fallback - show a simple prompt\n            this._showLocationSearchPrompt();\n          }\n        } else {\n          // Geocoder not available, show custom search prompt\n          this._showLocationSearchPrompt();\n        }\n      });\n\n      console.log('Map initialization complete');\n    } catch (error) {\n      console.error('Error initializing map:', error);\n      this._view.showMapError('Failed to initialize map: ' + error.message);\n    }\n  }\n\n  _showLocationSearchPrompt() {\n    Swal.fire({\n      title: 'Search Location',\n      input: 'text',\n      inputPlaceholder: 'Enter a place or address',\n      showCancelButton: true,\n      confirmButtonColor: '#4361ee',\n      cancelButtonColor: '#6c757d',\n      confirmButtonText: 'Search',\n      showLoaderOnConfirm: true,\n      preConfirm: (query) => {\n        if (!query) {\n          Swal.showValidationMessage('Please enter a location');\n          return;\n        }\n\n        // Try to find location using Nominatim API\n        return fetch(\n          `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(query)}&limit=5`\n        )\n          .then((response) => {\n            if (!response.ok) {\n              throw new Error('Network response was not ok');\n            }\n            return response.json();\n          })\n          .catch((error) => {\n            Swal.showValidationMessage(`Search failed: ${error.message}`);\n          });\n      },\n      allowOutsideClick: () => !Swal.isLoading(),\n    }).then((result) => {\n      if (result.isConfirmed && result.value && result.value.length > 0) {\n        const locations = result.value;\n\n        if (locations.length === 1) {\n          // Only one result, use it immediately\n          const location = locations[0];\n          const lat = parseFloat(location.lat);\n          const lon = parseFloat(location.lon);\n\n          this._updateLocation(lat, lon);\n          if (this._map) {\n            this._map.setView([lat, lon], 15);\n          }\n        } else if (locations.length > 1) {\n          // Multiple results, let user pick one\n          const options = locations.map((loc) => {\n            return {\n              text: loc.display_name,\n              value: loc.place_id,\n              lat: parseFloat(loc.lat),\n              lon: parseFloat(loc.lon),\n            };\n          });\n\n          Swal.fire({\n            title: 'Select Location',\n            input: 'radio',\n            inputOptions: options.reduce((acc, opt, idx) => {\n              acc[opt.value] = opt.text;\n              return acc;\n            }, {}),\n            showCancelButton: true,\n            confirmButtonColor: '#4361ee',\n            confirmButtonText: 'Select',\n          }).then((result) => {\n            if (result.isConfirmed) {\n              const selectedOption = options.find(\n                (opt) => opt.value.toString() === result.value\n              );\n              if (selectedOption) {\n                this._updateLocation(selectedOption.lat, selectedOption.lon);\n                if (this._map) {\n                  this._map.setView(\n                    [selectedOption.lat, selectedOption.lon],\n                    15\n                  );\n                }\n              }\n            }\n          });\n        } else {\n          Swal.fire({\n            icon: 'info',\n            title: 'No Results',\n            text: 'No locations found for your search.',\n          });\n        }\n      }\n    });\n  }\n\n  _updateLocation(lat, lng) {\n    // Update form values\n    this._view.updateLocationCoordinates(lat, lng);\n\n    // Update marker\n    if (this._marker) {\n      this._marker.setLatLng([lat, lng]);\n    } else if (this._map) {\n      this._marker = L.marker([lat, lng], {\n        draggable: true,\n        autoPan: true,\n      }).addTo(this._map);\n\n      // Allow marker to be dragged to adjust location\n      this._marker.on('dragend', (event) => {\n        const marker = event.target;\n        const position = marker.getLatLng();\n        this._updateLocation(position.lat, position.lng);\n      });\n    }\n\n    // Center map\n    if (this._map) {\n      this._map.setView([lat, lng], this._map.getZoom() || 15);\n\n      // Update location text in UI with loading state\n      const locationText = document.getElementById('location-text');\n      if (locationText) {\n        locationText.innerHTML = `\n          <span class=\"loading-dots\">Getting location name</span>\n          <br>Coordinates: ${lat.toFixed(6)}, ${lng.toFixed(6)}\n        `;\n      }\n\n      // Get location name via reverse geocoding if available\n      this._reverseGeocode(lat, lng);\n    }\n  }\n\n  _reverseGeocode(lat, lng) {\n    // First check if Leaflet's built-in geocoder is available\n    if (window.L && window.L.Control && window.L.Control.Geocoder) {\n      try {\n        const geocoder = L.Control.Geocoder.nominatim();\n        if (geocoder) {\n          geocoder.reverse({ lat, lng }, this._map.getZoom(), (results) => {\n            if (results && results.length > 0) {\n              const locationName = results[0].name;\n              const locationText = document.getElementById('location-text');\n              if (locationText && locationName) {\n                locationText.innerHTML = `\n                  <strong>${locationName}</strong>\n                  <br>Coordinates: ${lat.toFixed(6)}, ${lng.toFixed(6)}\n                `;\n              }\n            }\n          });\n          return;\n        }\n      } catch (error) {\n        console.warn('Leaflet reverse geocoding failed:', error);\n      }\n    }\n\n    // Fallback to direct Nominatim API if Leaflet geocoder is not available\n    try {\n      fetch(\n        `https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lng}&zoom=18&addressdetails=1`\n      )\n        .then((response) => response.json())\n        .then((data) => {\n          if (data && data.display_name) {\n            const locationText = document.getElementById('location-text');\n            if (locationText) {\n              locationText.innerHTML = `\n                <strong>${data.display_name}</strong>\n                <br>Coordinates: ${lat.toFixed(6)}, ${lng.toFixed(6)}\n              `;\n            }\n          }\n        })\n        .catch((error) => {\n          console.warn('Nominatim reverse geocoding failed:', error);\n          // Use coordinates as fallback\n          const locationText = document.getElementById('location-text');\n          if (locationText) {\n            locationText.textContent = `Coordinates: ${lat.toFixed(6)}, ${lng.toFixed(6)}`;\n          }\n        });\n    } catch (error) {\n      console.warn('External reverse geocoding failed:', error);\n    }\n  }\n\n  _addToRecents(description) {\n    try {\n      // Get existing recents\n      const recentsJson = localStorage.getItem('recentDrafts');\n      let recents = recentsJson ? JSON.parse(recentsJson) : [];\n\n      // Add new draft at the beginning (limited preview)\n      const preview =\n        description.substring(0, 50) + (description.length > 50 ? '...' : '');\n      recents.unshift({\n        description: preview,\n        timestamp: new Date().toISOString(),\n        id: Date.now().toString(),\n      });\n\n      // Limit to 5 recent drafts\n      recents = recents.slice(0, 5);\n\n      // Save back to localStorage\n      localStorage.setItem('recentDrafts', JSON.stringify(recents));\n    } catch (error) {\n      console.error('Error saving to recents:', error);\n    }\n  }\n}\n\nexport default AddStoryPresenter;\n","import '../components/header';\nimport '../components/loader';\nimport '../components/footer';\nimport '../components/sidebar';\nimport AddStoryPresenter from '../presenter/add-story-presenter';\n\nexport default class AddStoryPage {\n  constructor() {\n    this._presenter = new AddStoryPresenter({ view: this });\n  }\n\n  async render() {\n    return `\n      <app-sidebar></app-sidebar>\n      <app-header></app-header>\n      <main id=\"main-content\" class=\"main-content\" tabindex=\"-1\">\n        <section class=\"container\">\n          <div class=\"add-story-container\">\n            <h1 class=\"page-title\">Share Your Story</h1>\n            \n            <div class=\"recent-drafts-container\" id=\"recent-drafts\">\n              <!-- Recent drafts will be loaded here if available -->\n            </div>\n            \n            <form id=\"add-story-form\" class=\"story-form\">\n              <div class=\"form-group\">\n                <label for=\"description\" class=\"form-label\">Story Description</label>\n                <textarea\n                  id=\"description\"\n                  class=\"form-control\"\n                  placeholder=\"Share your learning experience...\"\n                  rows=\"4\"\n                  required\n                ></textarea>\n                <small id=\"description-error\" class=\"error-text\"></small>\n                <div class=\"character-counter\">\n                  <span id=\"char-count\">0</span> / 280 characters\n                </div>\n              </div>\n              \n              <div class=\"form-group\">\n                <label class=\"form-label\">Photo</label>\n                <div class=\"photo-upload-container\">\n                  <div class=\"photo-preview-container\">\n                    <div class=\"photo-preview\" id=\"photo-preview\">\n                      <i class=\"fas fa-image preview-placeholder\"></i>\n                      <img id=\"preview-image\" class=\"hidden\" alt=\"Preview of your photo\">\n                    </div>\n                  </div>\n                  \n                  <div class=\"photo-actions\">\n                    <div class=\"photo-upload\">\n                      <label for=\"photo\" class=\"custom-file-upload\">\n                        <i class=\"fas fa-upload\"></i> Select Photo\n                      </label>\n                      <input type=\"file\" id=\"photo\" name=\"photo\" accept=\"image/jpeg, image/png\" hidden>\n                    </div>\n                    \n                    <div class=\"or-divider\">or</div>\n                    \n                    <button type=\"button\" id=\"camera-button\" class=\"camera-button\">\n                      <i class=\"fas fa-camera\"></i> Take Photo\n                    </button>\n                  </div>\n                </div>\n                <small id=\"photo-error\" class=\"error-text\"></small>\n              </div>\n              \n              <div class=\"camera-container hidden\" id=\"camera-container\">\n                <div class=\"camera-view-container\">\n                  <video id=\"camera-view\" autoplay playsinline></video>\n                  <canvas id=\"camera-canvas\" class=\"hidden\"></canvas>\n                </div>\n                \n                <div class=\"camera-controls\">\n                  <button type=\"button\" id=\"take-photo\" class=\"camera-control-button\">\n                    <i class=\"fas fa-circle\"></i>\n                  </button>\n                  <button type=\"button\" id=\"close-camera\" class=\"camera-control-button\">\n                    <i class=\"fas fa-times\"></i>\n                  </button>\n                </div>\n                \n                <small id=\"camera-error\" class=\"error-text\"></small>\n              </div>\n              \n              <div class=\"form-group\">\n                <div class=\"custom-checkbox\">\n                  <input type=\"checkbox\" id=\"location-enabled\" name=\"location-enabled\">\n                  <label for=\"location-enabled\">\n                    <i class=\"fas fa-map-marker-alt\"></i> Include location\n                  </label>\n                </div>\n              </div>\n              \n              <div id=\"map-container\" class=\"map-container hidden\">\n                <div id=\"map\" class=\"add-story-map\"></div>\n                \n                <input type=\"hidden\" id=\"lat\" name=\"lat\">\n                <input type=\"hidden\" id=\"lon\" name=\"lon\">\n                \n                <small id=\"map-error\" class=\"error-text\"></small>\n                \n                <div class=\"location-info\" id=\"location-info\">\n                  <i class=\"fas fa-map-pin\"></i>\n                  <span id=\"location-text\">No location selected</span>\n                </div>\n              </div>\n              \n              <!-- Progress bar container -->\n              <div class=\"progress-container hidden\" id=\"progress-container\">\n                <div class=\"progress-bar\" id=\"progress-bar\" style=\"width: 0%\"></div>\n              </div>\n              \n              <div class=\"form-actions\">\n                <a href=\"#/\" class=\"cancel-button\">Cancel</a>\n                <button type=\"submit\" class=\"submit-button\">\n                  <i class=\"fas fa-paper-plane\"></i> Share Story\n                </button>\n              </div>\n            </form>\n          </div>\n        </section>\n      </main>\n      <app-footer></app-footer>\n      <app-loader></app-loader>\n      \n      <!-- Confetti canvas for success animation -->\n      <canvas id=\"confetti-canvas\" class=\"confetti-canvas\"></canvas>\n    `;\n  }\n\n  async afterRender() {\n    this._presenter.init();\n    this._presenter.loadRecentDrafts();\n    this._setupCharCounter();\n  }\n\n  _setupCharCounter() {\n    const textarea = document.getElementById('description');\n    const charCount = document.getElementById('char-count');\n\n    if (textarea && charCount) {\n      textarea.addEventListener('input', () => {\n        const count = textarea.value.length;\n        charCount.textContent = count;\n\n        // Add visual indicator when approaching limit\n        if (count > 240) {\n          charCount.classList.add('text-warning');\n        } else if (count > 270) {\n          charCount.classList.remove('text-warning');\n          charCount.classList.add('text-danger');\n        } else {\n          charCount.classList.remove('text-warning', 'text-danger');\n        }\n      });\n    }\n  }\n\n  displayRecentDrafts(drafts) {\n    const container = document.getElementById('recent-drafts');\n    if (!container) return;\n\n    if (!drafts || !Array.isArray(drafts) || drafts.length === 0) {\n      container.classList.add('hidden');\n      return;\n    }\n\n    // Show recent drafts section\n    container.classList.remove('hidden');\n\n    let html =\n      '<h2 class=\"recent-drafts-title\">Recent Drafts</h2><div class=\"recent-drafts-list\">';\n\n    drafts.forEach((draft) => {\n      const date = new Date(draft.timestamp);\n      const formattedDate = date.toLocaleDateString('id-ID', {\n        day: 'numeric',\n        month: 'short',\n      });\n\n      html += `\n        <div class=\"recent-draft-item\" data-id=\"${draft.id}\">\n          <div class=\"draft-content\">\n            <p class=\"draft-text\">${draft.description}</p>\n            <span class=\"draft-date\">${formattedDate}</span>\n          </div>\n          <button class=\"use-draft-btn\" data-id=\"${draft.id}\">\n            <i class=\"fas fa-arrow-right\"></i>\n          </button>\n        </div>\n      `;\n    });\n\n    html += '</div>';\n    container.innerHTML = html;\n\n    // Add event listeners\n    document.querySelectorAll('.use-draft-btn').forEach((btn) => {\n      btn.addEventListener('click', () => {\n        const draftId = btn.getAttribute('data-id');\n        this._presenter.useDraft(draftId);\n      });\n    });\n  }\n\n  applyDraftToForm(description) {\n    // Update the textarea\n    const textarea = document.getElementById('description');\n    if (textarea) {\n      textarea.value = description;\n      // Trigger input event to update character counter\n      textarea.dispatchEvent(new Event('input'));\n      // Focus and scroll to form\n      textarea.focus();\n      document\n        .querySelector('.story-form')\n        .scrollIntoView({ behavior: 'smooth' });\n    }\n  }\n\n  // Camera methods\n  setOpenCameraCallback(callback) {\n    const openCameraButton = document.querySelector('#camera-button');\n    if (openCameraButton) {\n      openCameraButton.addEventListener('click', callback);\n    }\n  }\n\n  setTakePhotoCallback(callback) {\n    const takePhotoButton = document.querySelector('#take-photo');\n    if (takePhotoButton) {\n      takePhotoButton.addEventListener('click', callback);\n    }\n  }\n\n  showCameraStream(stream) {\n    const cameraContainer = document.querySelector('#camera-container');\n    const videoElement = document.querySelector('#camera-view');\n\n    if (!cameraContainer || !videoElement) {\n      console.error('Camera container or video element not found');\n      return;\n    }\n\n    try {\n      cameraContainer.classList.remove('hidden');\n      videoElement.srcObject = stream;\n\n      // Start playing the video when it's loaded\n      videoElement.onloadedmetadata = () => {\n        videoElement.play().catch((error) => {\n          console.error('Error playing video:', error);\n        });\n      };\n    } catch (error) {\n      console.error('Error showing camera stream:', error);\n    }\n  }\n\n  capturePhoto() {\n    const videoElement = document.querySelector('#camera-view');\n    const canvas = document.querySelector('#camera-canvas');\n\n    if (!videoElement || !canvas) {\n      console.error('Video element or canvas not found');\n      return null;\n    }\n\n    try {\n      // Ensure video is playing and has dimensions\n      if (videoElement.videoWidth === 0 || videoElement.videoHeight === 0) {\n        console.error('Video dimensions are zero, cannot capture photo');\n        return null;\n      }\n\n      // Set canvas dimensions to match video\n      canvas.width = videoElement.videoWidth;\n      canvas.height = videoElement.videoHeight;\n\n      // Draw the video frame to the canvas\n      const context = canvas.getContext('2d');\n      context.drawImage(videoElement, 0, 0, canvas.width, canvas.height);\n\n      // Convert canvas to data URL\n      return canvas.toDataURL('image/jpeg', 0.9);\n    } catch (error) {\n      console.error('Error capturing photo:', error);\n      return null;\n    }\n  }\n\n  showCameraFlash() {\n    // Create camera flash effect\n    const flash = document.createElement('div');\n    flash.className = 'camera-flash';\n    document.body.appendChild(flash);\n\n    // Trigger the flash effect\n    setTimeout(() => {\n      flash.style.opacity = '0.8';\n\n      // Remove the flash after animation\n      setTimeout(() => {\n        flash.style.opacity = '0';\n        setTimeout(() => {\n          document.body.removeChild(flash);\n        }, 300);\n      }, 100);\n    }, 10);\n  }\n\n  resetCameraUI() {\n    const cameraContainer = document.querySelector('#camera-container');\n    const videoElement = document.querySelector('#camera-view');\n\n    if (cameraContainer) {\n      cameraContainer.classList.add('hidden');\n    }\n\n    if (videoElement) {\n      videoElement.srcObject = null;\n    }\n  }\n\n  showCameraError(message) {\n    Swal.fire({\n      icon: 'error',\n      title: 'Camera Error',\n      text: message,\n      confirmButtonColor: '#4361ee',\n    });\n  }\n\n  // Photo preview methods\n  setPhotoInputCallback(callback) {\n    const photoInput = document.querySelector('#photo');\n    if (photoInput) {\n      photoInput.addEventListener('change', (event) => {\n        callback(event.target.files[0]);\n      });\n    }\n  }\n\n  showPhotoPreview(file) {\n    const photoPreview = document.querySelector('#photo-preview');\n    if (!photoPreview) return;\n\n    const reader = new FileReader();\n    reader.onload = (e) => {\n      photoPreview.innerHTML = `\n        <img \n          src=\"${e.target.result}\" \n          alt=\"Selected photo preview\" \n          style=\"max-width: 100%; border-radius: 8px; max-height: 300px;\"\n        >\n      `;\n    };\n    reader.readAsDataURL(file);\n  }\n\n  showPhotoError(message) {\n    const photoError = document.querySelector('#photo-error');\n    if (photoError) {\n      photoError.textContent = message;\n      photoError.style.display = 'block';\n    }\n  }\n\n  clearPhotoError() {\n    const photoError = document.querySelector('#photo-error');\n    if (photoError) {\n      photoError.textContent = '';\n      photoError.style.display = 'none';\n    }\n  }\n\n  // Location methods\n  setLocationCheckboxCallback(callback) {\n    const locationCheckbox = document.querySelector('#location-enabled');\n    if (locationCheckbox) {\n      locationCheckbox.addEventListener('change', () => {\n        callback(locationCheckbox.checked);\n      });\n    }\n  }\n\n  showMapContainer() {\n    const mapContainer = document.querySelector('#map-container');\n    if (mapContainer) {\n      mapContainer.classList.remove('hidden');\n      // Fix map rendering\n      setTimeout(() => {\n        if (window.L && window.L.map) {\n          const map = window.L.map._instances?.[0];\n          if (map) {\n            map.invalidateSize();\n          }\n        }\n      }, 100);\n    }\n  }\n\n  hideMapContainer() {\n    const mapContainer = document.querySelector('#map-container');\n    if (mapContainer) {\n      mapContainer.classList.add('hidden');\n    }\n  }\n\n  setLocateMeCallback(callback) {\n    const locateMeButton = document.querySelector('#locate-me');\n    if (locateMeButton) {\n      locateMeButton.addEventListener('click', callback);\n    }\n  }\n\n  setSearchLocationCallback(callback) {\n    const searchLocationButton = document.querySelector('#search-location');\n    if (searchLocationButton) {\n      searchLocationButton.addEventListener('click', callback);\n    }\n  }\n\n  updateLocationCoordinates(lat, lng) {\n    const latInput = document.querySelector('#lat');\n    const lonInput = document.querySelector('#lon');\n    const locationText = document.querySelector('#location-text');\n\n    if (latInput && lonInput) {\n      latInput.value = lat;\n      lonInput.value = lng;\n    }\n\n    // Update location text if available\n    if (locationText) {\n      locationText.textContent = `Coordinates: ${lat.toFixed(6)}, ${lng.toFixed(6)}`;\n    }\n  }\n\n  showMapError(message) {\n    Swal.fire({\n      icon: 'error',\n      title: 'Map Error',\n      text: message,\n      confirmButtonColor: '#4361ee',\n    });\n  }\n\n  // Form methods\n  setSubmitCallback(callback) {\n    const form = document.querySelector('#add-story-form');\n    if (!form) {\n      console.error('Form not found: #add-story-form');\n      return;\n    }\n\n    form.addEventListener('submit', async (event) => {\n      event.preventDefault();\n\n      const description = this.getDescription();\n      const photoInput = document.querySelector('#photo');\n      const photoFile = photoInput.files[0];\n      const useLocation = document.querySelector('#location-enabled').checked;\n      const lat = document.querySelector('#lat').value;\n      const lon = document.querySelector('#lon').value;\n\n      const formData = new FormData();\n      formData.append('description', description);\n\n      if (photoFile) {\n        formData.append('photo', photoFile);\n      }\n\n      if (useLocation && lat && lon) {\n        formData.append('lat', lat);\n        formData.append('lon', lon);\n      }\n\n      callback(formData);\n    });\n  }\n\n  getDescription() {\n    const descriptionInput = document.querySelector('#description');\n    return descriptionInput ? descriptionInput.value.trim() : '';\n  }\n\n  setDescriptionInputCallback(callback) {\n    const descriptionInput = document.querySelector('#description');\n    if (descriptionInput) {\n      descriptionInput.addEventListener('input', () => {\n        // Ensure the input value is properly trimmed\n        const trimmedValue = descriptionInput.value.trim();\n        callback(trimmedValue);\n      });\n    }\n  }\n\n  showDescriptionError(message) {\n    const descriptionError = document.querySelector('#description-error');\n    if (descriptionError) {\n      descriptionError.textContent = message;\n      descriptionError.style.display = 'block';\n\n      // Highlight the description field\n      const descriptionInput = document.querySelector('#description');\n      if (descriptionInput) {\n        descriptionInput.classList.add('error');\n        descriptionInput.setAttribute('aria-invalid', 'true');\n      }\n    }\n  }\n\n  clearDescriptionError() {\n    const descriptionError = document.querySelector('#description-error');\n    if (descriptionError) {\n      descriptionError.textContent = '';\n      descriptionError.style.display = 'none';\n\n      // Remove highlight from the description field\n      const descriptionInput = document.querySelector('#description');\n      if (descriptionInput) {\n        descriptionInput.classList.remove('error');\n        descriptionInput.setAttribute('aria-invalid', 'false');\n      }\n    }\n  }\n\n  // UI helper methods\n  showLoader(message = 'Loading...') {\n    const loader = document.querySelector('app-loader');\n    if (loader) loader.show(message);\n  }\n\n  hideLoader() {\n    const loader = document.querySelector('app-loader');\n    if (loader) loader.hide();\n  }\n\n  disableSubmitButton() {\n    const submitButton = document.querySelector('#submit-button');\n    if (submitButton) submitButton.disabled = true;\n  }\n\n  resetForm() {\n    const form = document.querySelector('#add-story-form');\n    const photoPreview = document.querySelector('#photo-preview');\n    const mapContainer = document.querySelector('#map-container');\n    const locationCheckbox = document.querySelector('#location-enabled');\n\n    if (form) form.reset();\n\n    if (photoPreview) {\n      photoPreview.innerHTML = `<i class=\"fas fa-image preview-placeholder\"></i>\n      <img id=\"preview-image\" class=\"hidden\" alt=\"Preview of your photo\">`;\n    }\n\n    if (mapContainer) {\n      mapContainer.classList.add('hidden');\n    }\n\n    if (locationCheckbox) {\n      locationCheckbox.checked = false;\n    }\n\n    // Reset character counter\n    const charCount = document.getElementById('char-count');\n    if (charCount) {\n      charCount.textContent = '0';\n      charCount.classList.remove('text-warning', 'text-danger');\n    }\n  }\n\n  // Alerts\n  async showLoginRequiredAlert() {\n    return Swal.fire({\n      icon: 'warning',\n      title: 'Login Required',\n      text: 'You need to login first',\n      confirmButtonText: 'OK',\n      confirmButtonColor: '#4361ee',\n    });\n  }\n\n  async showOfflineAlert() {\n    return Swal.fire({\n      icon: 'error',\n      title: 'Offline Mode',\n      text: 'Adding stories is not available without internet connection.',\n      confirmButtonColor: '#4361ee',\n    });\n  }\n\n  async showSuccessAlert() {\n    return Swal.fire({\n      icon: 'success',\n      title: 'Story added successfully!',\n      showConfirmButton: false,\n      timer: 1500,\n    });\n  }\n\n  async showErrorAlert(message) {\n    return Swal.fire({\n      icon: 'error',\n      title: 'Error',\n      text: message || 'Failed to add story',\n      confirmButtonColor: '#4361ee',\n    });\n  }\n\n  showProgressBar() {\n    const progressContainer = document.getElementById('progress-container');\n    if (progressContainer) {\n      progressContainer.classList.remove('hidden');\n    }\n  }\n\n  hideProgressBar() {\n    const progressContainer = document.getElementById('progress-container');\n    if (progressContainer) {\n      progressContainer.classList.add('hidden');\n    }\n  }\n\n  updateProgressBar(percent) {\n    const progressBar = document.getElementById('progress-bar');\n    if (progressBar) {\n      progressBar.style.width = `${percent}%`;\n    }\n  }\n\n  showFormValidationError() {\n    Swal.fire({\n      icon: 'warning',\n      title: 'Form Validation Error',\n      text: 'Please fix the errors in the form before submitting.',\n      confirmButtonColor: '#4361ee',\n    });\n  }\n\n  showConfetti() {\n    const canvas = document.getElementById('confetti-canvas');\n    if (!canvas) return;\n\n    // Make canvas visible\n    canvas.classList.add('active');\n\n    // Configure confetti\n    const confettiSettings = {\n      target: canvas,\n      max: 150,\n      size: 1.5,\n      animate: true,\n      props: ['circle', 'square', 'triangle', 'line'],\n      colors: [\n        [165, 104, 246],\n        [230, 61, 135],\n        [0, 199, 228],\n        [253, 214, 126],\n      ],\n      clock: 25,\n      rotate: true,\n      start_from_edge: true,\n      respawn: false,\n    };\n\n    // Start confetti animation\n    const confetti = window.confetti.create(canvas, confettiSettings);\n    confetti({\n      particleCount: 150,\n      spread: 160,\n    });\n\n    // Remove canvas after animation completes\n    setTimeout(() => {\n      canvas.classList.remove('active');\n    }, 3000);\n  }\n\n  // Set close camera button event\n  setCloseCameraCallback(callback) {\n    const closeButton = document.querySelector('#close-camera');\n    if (closeButton) {\n      closeButton.addEventListener('click', callback);\n    }\n  }\n}\n","import '../components/sidebar';\nimport '../components/header';\nimport '../components/footer';\n\nexport default class NotFoundPage {\n  async render() {\n    return `\n      <app-sidebar></app-sidebar>\n      <app-header></app-header>\n      <main id=\"main-content\" class=\"main-content\" tabindex=\"-1\">\n        <section class=\"container not-found\">\n          <h1 class=\"page-title\">404 - Halaman Tidak Ditemukan</h1>\n          <p>Maaf, halaman yang Anda cari tidak tersedia.</p>\n          <a href=\"#/\" class=\"btn btn-primary\">\n            <i class=\"fas fa-home\" aria-hidden=\"true\"></i>\n            Kembali ke Beranda\n          </a>\n        </section>\n      </main>\n      <app-footer></app-footer>\n    `;\n  }\n\n  async afterRender() {\n    // No additional logic\n  }\n}\n","import '../components/sidebar';\nimport '../components/header';\nimport '../components/footer';\nimport { getAllStories, deleteStory } from '../idb';\n\nexport default class SavedStoriesPage {\n  async render() {\n    return `\n      <app-sidebar></app-sidebar>\n      <app-header></app-header>\n      <main id=\"main-content\" class=\"main-content\" tabindex=\"-1\">\n        <section class=\"container saved-stories\">\n          <h1 class=\"page-title\">\n            <i class=\"fas fa-database\" aria-hidden=\"true\"></i>\n            Saved Stories\n          </h1>\n          <div id=\"saved-stories-list\" class=\"stories-list\"></div>\n        </section>\n      </main>\n      <app-footer></app-footer>\n    `;\n  }\n\n  async afterRender() {\n    const listContainer = document.getElementById('saved-stories-list');\n    const stories = await getAllStories();\n    if (!stories || stories.length === 0) {\n      listContainer.innerHTML = `<p>No saved stories available.</p>`;\n      return;\n    }\n    stories.forEach((story) => {\n      const card = document.createElement('app-card');\n      card.story = story;\n\n      const deleteBtn = document.createElement('button');\n      deleteBtn.textContent = 'Delete';\n      deleteBtn.className = 'delete-story-button';\n      deleteBtn.addEventListener('click', async () => {\n        await deleteStory(story.id);\n        card.remove();\n        window.showToast('Story deleted from cache', 'success');\n      });\n\n      card.appendChild(deleteBtn);\n      listContainer.appendChild(card);\n    });\n  }\n}\n","import HomePage from '../pages/home-page';\nimport AboutPage from '../pages/about-page';\nimport LoginPage from '../pages/login-page';\nimport RegisterPage from '../pages/register-page';\nimport StoryDetailPage from '../pages/story-detail-page';\nimport AddStoryPage from '../pages/add-story-page';\nimport NotFoundPage from '../pages/not-found-page';\nimport SavedStoriesPage from '../pages/saved-stories-page';\n\nconst routes = {\n  '#/': HomePage,\n  '#/about': AboutPage,\n  '#/login': LoginPage,\n  '#/register': RegisterPage,\n  '#/stories/:id': StoryDetailPage,\n  '#/stories/add': AddStoryPage,\n  '#/saved': SavedStoriesPage,\n  '#/404': NotFoundPage,\n};\n\nexport default routes;\n","function extractPathnameSegments(path) {\n  // Remove query parameters if any\n  const cleanPath = path.split('?')[0];\n  const splitUrl = cleanPath.split('/').filter((segment) => segment !== '');\n\n  return {\n    resource: splitUrl[0] || null,\n    id: splitUrl[1] && splitUrl[1] !== 'add' ? splitUrl[1] : null,\n    isAddPage: splitUrl[1] === 'add',\n  };\n}\n\nexport function getActivePathname() {\n  return location.hash.replace('#', '') || '/';\n}\n\nexport function getActiveRoute() {\n  const pathname = getActivePathname();\n  const { resource, id, isAddPage } = extractPathnameSegments(pathname);\n\n  let route = '#/';\n  if (resource) route = `#/${resource}`;\n  if (isAddPage) route += '/add';\n  if (id) route += '/:id';\n\n  return route;\n}\n\nexport function parseActivePathname() {\n  return extractPathnameSegments(getActivePathname());\n}\n\nexport function getQueryParams() {\n  const query = location.hash.split('?')[1];\n  if (!query) return {};\n\n  return query.split('&').reduce((params, param) => {\n    const [key, value] = param.split('=');\n    params[key] = decodeURIComponent(value);\n    return params;\n  }, {});\n}\n","import routes from './routes/routes';\nimport { getActiveRoute, parseActivePathname } from './routes/url-parser';\nimport CONFIG from './config';\n\nclass App {\n  #content = null;\n  #activePresenter = null;\n  #previousRoute = null;\n\n  constructor({ content }) {\n    this.#content = content;\n\n    // Add event listener for sidebar logout\n    document.addEventListener('user-logout', () => {\n      // Clear user data from localStorage\n      localStorage.removeItem('token');\n      localStorage.removeItem('user');\n\n      // Show toast message\n      window.showToast('Logout berhasil', 'success');\n\n      // Redirect to login page\n      window.location.hash = '#/login';\n    });\n  }\n\n  async renderPage() {\n    const url = getActiveRoute();\n    const { resource, id, isAddPage } = parseActivePathname();\n\n    // Clean up resources of previous page\n    this.#cleanupPreviousPage();\n\n    // Handle \"Add Story\" page separately\n    if (isAddPage) {\n      const page = new routes['#/stories/add']();\n      this.#setDocumentTitle(resource, id);\n      this.#showLoading();\n\n      try {\n        await document.startViewTransition(async () => {\n          this.#content.innerHTML = await page.render();\n          await page.afterRender();\n\n          // Store the active presenter\n          if (page._presenter) {\n            this.#activePresenter = page._presenter;\n          }\n\n          this.#previousRoute = url;\n\n          // Update sidebar state\n          this.#updateSidebar();\n\n          // Custom animation for add story page\n          if (\n            window.matchMedia('(prefers-reduced-motion: no-preference)').matches\n          ) {\n            const mainContent = document.getElementById('main-content');\n            if (mainContent) {\n              mainContent.animate(\n                [\n                  { transform: 'translateX(100%)', opacity: 0 },\n                  { transform: 'translateX(0)', opacity: 1 },\n                ],\n                {\n                  duration: 300,\n                  easing: 'ease-out',\n                }\n              );\n            }\n          }\n        }).finished;\n      } catch (error) {\n        console.error('Error rendering Add Story page:', error);\n        this.#showErrorPage();\n      } finally {\n        this.#hideLoading();\n      }\n      return;\n    }\n\n    // Handle other pages\n    const PageClass = routes[url] || routes['#/404'];\n    const page = new PageClass();\n\n    this.#setDocumentTitle(resource, id);\n    this.#showLoading();\n\n    try {\n      await document.startViewTransition(async () => {\n        this.#content.innerHTML = await page.render();\n        await page.afterRender();\n\n        // Store the active presenter\n        if (page._presenter) {\n          this.#activePresenter = page._presenter;\n        }\n\n        this.#previousRoute = url;\n\n        // Update sidebar state\n        this.#updateSidebar();\n\n        // Custom animation for other pages\n        if (\n          window.matchMedia('(prefers-reduced-motion: no-preference)').matches\n        ) {\n          const mainContent = document.getElementById('main-content');\n          if (mainContent) {\n            mainContent.animate(\n              [\n                { transform: 'translateX(-50px)', opacity: 0 },\n                { transform: 'translateX(0)', opacity: 1 },\n              ],\n              {\n                duration: 300,\n                easing: 'ease-out',\n              }\n            );\n          }\n        }\n      }).finished;\n    } catch (error) {\n      console.error('Error rendering page:', error);\n      this.#showErrorPage();\n    } finally {\n      this.#hideLoading();\n    }\n  }\n\n  #cleanupPreviousPage() {\n    // If previous page was Add Story, stop the camera\n    const wasAddStoryPage = this.#previousRoute === '#/stories/add';\n    if (wasAddStoryPage && this.#activePresenter) {\n      if (typeof this.#activePresenter.stopCamera === 'function') {\n        this.#activePresenter.stopCamera();\n      }\n    }\n\n    // Reset active presenter\n    this.#activePresenter = null;\n  }\n\n  #setDocumentTitle(resource, id) {\n    const titles = {\n      stories: id ? 'Story Details' : 'Add Story',\n      login: 'Login',\n      register: 'Register',\n      about: 'About',\n      default: 'Home',\n    };\n\n    const title = titles[resource] || titles.default;\n    document.title = `Dicoding Story | ${title}`;\n  }\n\n  #showLoading() {\n    const loader = document.querySelector('app-loader');\n    if (loader) loader.show();\n  }\n\n  #hideLoading() {\n    const loader = document.querySelector('app-loader');\n    if (loader) loader.hide();\n  }\n\n  #showErrorPage() {\n    this.#content.innerHTML = `\n      <app-sidebar></app-sidebar>\n      <section class=\"container\">\n        <h1 class=\"page-title\">Error</h1>\n        <p>Gagal memuat halaman. Silakan coba lagi.</p>\n        <div class=\"flex gap-2 mt-3\">\n          <a href=\"#/\" class=\"back-link\">\n            <i class=\"fas fa-home\"></i>\n            Kembali ke Beranda\n          </a>\n          <button onclick=\"window.location.reload()\" class=\"back-link\" style=\"background-color: var(--danger)\">\n            <i class=\"fas fa-sync-alt\"></i>\n            Muat Ulang\n          </button>\n        </div>\n      </section>\n    `;\n  }\n\n  #updateSidebar() {\n    // Check if user data changed and notify sidebar\n    try {\n      const token = localStorage.getItem('token');\n      const userData = localStorage.getItem('user');\n\n      if (token && userData && userData !== 'undefined') {\n        try {\n          // Validate user data to ensure it's proper JSON\n          const parsedUserData = JSON.parse(userData);\n\n          // User is logged in\n          window.dispatchEvent(\n            new CustomEvent('user-login-state-changed', {\n              detail: {\n                isLoggedIn: true,\n                userData: parsedUserData,\n              },\n            })\n          );\n        } catch (jsonError) {\n          console.error('Invalid user data in localStorage:', jsonError);\n          // Clear invalid data\n          localStorage.removeItem('user');\n\n          // Create default user data structure with minimal info to prevent errors\n          const defaultUserData = { name: 'User', email: '' };\n          localStorage.setItem('user', JSON.stringify(defaultUserData));\n\n          window.dispatchEvent(\n            new CustomEvent('user-login-state-changed', {\n              detail: {\n                isLoggedIn: true, // Still logged in because token exists\n                userData: defaultUserData,\n              },\n            })\n          );\n        }\n      } else {\n        // User is not logged in\n        window.dispatchEvent(\n          new CustomEvent('user-login-state-changed', {\n            detail: {\n              isLoggedIn: false,\n              userData: null,\n            },\n          })\n        );\n      }\n    } catch (error) {\n      console.error('Error updating sidebar:', error);\n    }\n  }\n}\n\nexport default App;\n","import CONFIG from './config';\n\nexport function urlBase64ToUint8Array(base64String) {\n  const padding = '='.repeat((4 - (base64String.length % 4)) % 4);\n  const base64 = (base64String + padding).replace(/-/g, '+').replace(/_/g, '/');\n  const rawData = window.atob(base64);\n  return Uint8Array.from([...rawData].map((char) => char.charCodeAt(0)));\n}\n\nexport async function subscribeUserToPush(registration) {\n  try {\n    const permission = await Notification.requestPermission();\n    if (permission !== 'granted') {\n      console.log('Push notification permission denied');\n      return;\n    }\n    const token = localStorage.getItem('token'); // Ambil token user\n    if (!token) {\n      console.warn(\n        'User not logged in, cannot subscribe to push notifications'\n      );\n      return;\n    }\n    const applicationServerKey = urlBase64ToUint8Array(CONFIG.VAPID_PUBLIC_KEY);\n    const subscription = await registration.pushManager.subscribe({\n      userVisibleOnly: true,\n      applicationServerKey,\n    });\n    const { endpoint, keys } = subscription.toJSON();\n    const cleanSubscription = { endpoint, keys };\n\n    await fetch(`${CONFIG.BASE_URL}/notifications/subscribe`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        Authorization: `Bearer ${token}`,\n      },\n      body: JSON.stringify(cleanSubscription),\n    });\n    console.log('User subscribed to push notifications');\n  } catch (error) {\n    console.error('Failed to subscribe user:', error);\n  }\n}\n","import '../styles/styles.css';\nimport App from './app';\nimport CONFIG from './config';\nimport { subscribeUserToPush } from './notification-helper';\n\n// Create and show splash screen\nfunction showSplashScreen() {\n  const splashScreen = document.createElement('div');\n  splashScreen.className = 'splash-screen';\n\n  const logo = document.createElement('img');\n  logo.src = '/images/logo.png';\n  logo.alt = 'Dicoding Story Logo';\n  logo.className = 'splash-logo';\n\n  const title = document.createElement('div');\n  title.className = 'splash-title';\n  title.textContent = 'Dicoding Story';\n\n  const dotsContainer = document.createElement('div');\n  dotsContainer.className = 'splash-dots';\n\n  for (let i = 0; i < 3; i++) {\n    const dot = document.createElement('div');\n    dot.className = 'splash-dot';\n    dotsContainer.appendChild(dot);\n  }\n\n  splashScreen.appendChild(logo);\n  splashScreen.appendChild(title);\n  splashScreen.appendChild(dotsContainer);\n\n  document.body.appendChild(splashScreen);\n\n  return splashScreen;\n}\n\nfunction hideSplashScreen(splashScreen) {\n  splashScreen.style.opacity = '0';\n\n  setTimeout(() => {\n    splashScreen.style.visibility = 'hidden';\n    document.body.removeChild(splashScreen);\n  }, 600);\n}\n\n// Register Service Worker for PWA\nif ('serviceWorker' in navigator) {\n  // Handle Add to Home Screen prompt\n  window.addEventListener('beforeinstallprompt', (e) => {\n    e.preventDefault();\n    let deferredPrompt = e;\n    const installBtn = document.createElement('button');\n    installBtn.id = 'install-button';\n    installBtn.textContent = 'Install App';\n    installBtn.className = 'install-button';\n    document.body.appendChild(installBtn);\n    installBtn.addEventListener('click', async () => {\n      installBtn.style.display = 'none';\n      deferredPrompt.prompt();\n      const { outcome } = await deferredPrompt.userChoice;\n      console.log(`User response to the install prompt: ${outcome}`);\n      deferredPrompt = null;\n    });\n  });\n\n  window.addEventListener('load', () => {\n    // Register service worker in all environments (including development)\n    navigator.serviceWorker\n      .register(CONFIG.SERVICE_WORKER_PATH)\n      .then((registration) => {\n        console.log(\n          'ServiceWorker registration successful with scope: ',\n          registration.scope\n        );\n        window.showToast &&\n          window.showToast('Aplikasi siap digunakan secara offline', 'success');\n        // Subscribe to push notifications\n        subscribeUserToPush(registration);\n      })\n      .catch((err) => {\n        console.error('ServiceWorker registration failed: ', err);\n        window.showToast &&\n          window.showToast('Gagal mendaftarkan service worker', 'error');\n      });\n  });\n}\n\n// Feature detection for View Transition API\nconst supportsViewTransitions = () => {\n  return (\n    'startViewTransition' in document &&\n    !window.matchMedia('(prefers-reduced-motion: reduce)').matches\n  );\n};\n\n// Polyfill for View Transition API\nif (!supportsViewTransitions()) {\n  document.startViewTransition = (callback) => {\n    try {\n      const updateCallbackDone = Promise.resolve(callback());\n\n      return {\n        ready: Promise.resolve(),\n        updateCallbackDone,\n        finished: updateCallbackDone,\n      };\n    } catch (error) {\n      console.error('Error in startViewTransition callback:', error);\n      return {\n        ready: Promise.reject(error),\n        updateCallbackDone: Promise.reject(error),\n        finished: Promise.reject(error),\n      };\n    }\n  };\n}\n\n// Initialize theme from localStorage\nfunction initTheme() {\n  const savedTheme = localStorage.getItem('theme');\n  if (savedTheme) {\n    document.documentElement.setAttribute('data-theme', savedTheme);\n  } else if (\n    window.matchMedia &&\n    window.matchMedia('(prefers-color-scheme: dark)').matches\n  ) {\n    // If no saved preference, use system preference\n    document.documentElement.setAttribute('data-theme', 'dark');\n    localStorage.setItem('theme', 'dark');\n  }\n}\n\n// Call theme initialization immediately (before DOM is fully loaded)\ninitTheme();\n\n// Initialize the app\nasync function initializeApp() {\n  // Show splash screen first\n  const splashScreen = showSplashScreen();\n\n  // Delay app initialization to show splash screen\n  setTimeout(async () => {\n    const appElement = document.querySelector('#app');\n    if (!appElement) {\n      console.error('App element not found');\n      hideSplashScreen(splashScreen);\n      return;\n    }\n\n    const app = new App({\n      content: appElement,\n    });\n\n    try {\n      await app.renderPage();\n      // Hide splash screen after initial render is complete\n      hideSplashScreen(splashScreen);\n\n      // Setup scroll handler for header\n      setupHeaderScrollEffect();\n\n      // Setup theme mode toggle\n      setupThemeModeToggle();\n\n      // Setup animations for elements when they enter viewport\n      setupScrollAnimations();\n    } catch (error) {\n      console.error('Error loading initial page:', error);\n      hideSplashScreen(splashScreen);\n\n      appElement.innerHTML = `\n        <section class=\"container\">\n          <h1 class=\"page-title\">Error</h1>\n          <p>Gagal memuat halaman. Silakan coba lagi.</p>\n          <a href=\"#/\" class=\"back-link\">\n            <i class=\"fas fa-home\"></i>\n            Kembali ke Beranda\n          </a>\n        </section>\n      `;\n\n      window.showToast &&\n        window.showToast('Gagal memuat halaman, silakan coba lagi', 'error');\n    }\n\n    window.addEventListener('hashchange', async () => {\n      try {\n        // Show loading spinner for page transitions\n        const loadingSpinner = document.createElement('div');\n        loadingSpinner.className = 'loading-spinner';\n        loadingSpinner.innerHTML = `\n          <div class=\"spinner-container\">\n            <div class=\"spinner-pulse\"></div>\n            <div class=\"spinner\"></div>\n          </div>\n          <div class=\"spinner-text\">Loading...</div>\n        `;\n        document.body.appendChild(loadingSpinner);\n\n        // Render the new page\n        await app.renderPage();\n\n        // Setup animations again after page change\n        setupScrollAnimations();\n\n        // Remove loading spinner\n        document.body.removeChild(loadingSpinner);\n      } catch (error) {\n        console.error('Error loading page:', error);\n        window.showToast && window.showToast('Gagal memuat halaman', 'error');\n      }\n    });\n\n    // Skip to content implementation\n    const skipLinkHandler = () => {\n      const skipLink = document.querySelector('.skip-link');\n      if (skipLink) {\n        skipLink.addEventListener('click', function (event) {\n          event.preventDefault(); // Prevent default behavior that would refresh the page\n\n          const mainContent = document.querySelector('#main-content');\n          if (mainContent) {\n            skipLink.blur(); // Remove focus from the skip link\n            mainContent.focus(); // Set focus to the main content\n            mainContent.scrollIntoView({ behavior: 'smooth' }); // Scroll to main content\n          }\n        });\n      }\n    };\n\n    // Initialize skip link handler on page load\n    skipLinkHandler();\n\n    // Re-initialize skip link handler after each page change\n    window.addEventListener('hashchange', () => {\n      // Short delay to ensure DOM is updated after route change\n      setTimeout(skipLinkHandler, 100);\n    });\n\n    // Check for PWA install prompt\n    let deferredPrompt;\n    const installContainer = document.createElement('div');\n    installContainer.id = 'install-container';\n    installContainer.classList.add('install-prompt');\n    installContainer.innerHTML = `\n      <div class=\"install-content\">\n        <img src=\"/images/logo.png\" alt=\"App icon\" width=\"48\" height=\"48\">\n        <div class=\"install-text\">\n          <h3>Install Dicoding Story</h3>\n          <p>Install aplikasi ini untuk pengalaman offline yang lebih baik!</p>\n        </div>\n        <div class=\"install-actions\">\n          <button id=\"install-button\" class=\"primary-button\">Install</button>\n          <button id=\"dismiss-button\" class=\"secondary-button\">Nanti</button>\n        </div>\n      </div>\n    `;\n    document.body.appendChild(installContainer);\n\n    window.addEventListener('beforeinstallprompt', (e) => {\n      // Prevent Chrome 76+ from automatically showing the prompt\n      e.preventDefault();\n      // Stash the event so it can be triggered later\n      deferredPrompt = e;\n      // Show the install prompt after a delay\n      setTimeout(() => {\n        installContainer.classList.add('show');\n      }, 3000);\n\n      document\n        .getElementById('install-button')\n        .addEventListener('click', () => {\n          installContainer.classList.remove('show');\n          // Show the prompt\n          deferredPrompt.prompt();\n          // Wait for the user to respond to the prompt\n          deferredPrompt.userChoice.then((choiceResult) => {\n            if (choiceResult.outcome === 'accepted') {\n              console.log('User accepted the install prompt');\n              window.showToast &&\n                window.showToast('Aplikasi sedang diinstall!', 'success');\n            } else {\n              console.log('User dismissed the install prompt');\n            }\n            // Clear the saved prompt since it can't be used again\n            deferredPrompt = null;\n          });\n        });\n\n      document\n        .getElementById('dismiss-button')\n        .addEventListener('click', () => {\n          installContainer.classList.remove('show');\n        });\n    });\n\n    // Show welcome toast\n    window.showToast &&\n      setTimeout(() => {\n        window.showToast('Selamat datang di Dicoding Story!', 'info');\n      }, 1000);\n  }, 1800); // Give more time to show the splash screen\n}\n\nfunction setupHeaderScrollEffect() {\n  const header = document.querySelector('header');\n  if (!header) return;\n\n  const scrollHandler = () => {\n    if (window.scrollY > 30) {\n      header.classList.add('scrolled');\n    } else {\n      header.classList.remove('scrolled');\n    }\n  };\n\n  // Initial check\n  scrollHandler();\n\n  // Add scroll event listener\n  window.addEventListener('scroll', scrollHandler);\n}\n\nfunction setupThemeModeToggle() {\n  // Check if we have a theme preference stored\n  const savedTheme = localStorage.getItem('theme');\n\n  // Apply saved theme if it exists\n  if (savedTheme) {\n    document.documentElement.setAttribute('data-theme', savedTheme);\n  }\n\n  // Add theme toggle button to nav if it doesn't exist yet\n  const navList = document.querySelector('.nav-list');\n  if (navList) {\n    // Check if theme toggle already exists\n    if (!document.getElementById('theme-toggle-item')) {\n      const themeToggleItem = document.createElement('li');\n      themeToggleItem.id = 'theme-toggle-item';\n\n      const currentTheme =\n        savedTheme ||\n        (window.matchMedia('(prefers-color-scheme: dark)').matches\n          ? 'dark'\n          : 'light');\n\n      themeToggleItem.innerHTML = `\n        <button id=\"theme-toggle\" aria-label=\"Toggle dark/light mode\">\n          <i class=\"fas ${currentTheme === 'dark' ? 'fa-sun' : 'fa-moon'}\" aria-hidden=\"true\"></i>\n          <span>${currentTheme === 'dark' ? 'Light Mode' : 'Dark Mode'}</span>\n        </button>\n      `;\n\n      // Add after the second item\n      const secondItem = navList.children[1];\n      if (secondItem) {\n        navList.insertBefore(themeToggleItem, secondItem.nextSibling);\n      } else {\n        navList.appendChild(themeToggleItem);\n      }\n\n      // Add event listener\n      const themeToggle = document.getElementById('theme-toggle');\n      if (themeToggle) {\n        themeToggle.addEventListener('click', toggleTheme);\n      }\n    }\n  }\n}\n\nfunction toggleTheme() {\n  const currentTheme =\n    document.documentElement.getAttribute('data-theme') ||\n    (window.matchMedia('(prefers-color-scheme: dark)').matches\n      ? 'dark'\n      : 'light');\n\n  const newTheme = currentTheme === 'dark' ? 'light' : 'dark';\n\n  // Update the document attribute\n  document.documentElement.setAttribute('data-theme', newTheme);\n\n  // Save to localStorage\n  localStorage.setItem('theme', newTheme);\n\n  // Update button icon and text\n  const themeToggle = document.getElementById('theme-toggle');\n  if (themeToggle) {\n    const icon = themeToggle.querySelector('i');\n    const text = themeToggle.querySelector('span');\n\n    if (icon) {\n      icon.className = `fas ${newTheme === 'dark' ? 'fa-sun' : 'fa-moon'}`;\n    }\n\n    if (text) {\n      text.textContent = newTheme === 'dark' ? 'Light Mode' : 'Dark Mode';\n    }\n  }\n\n  // Show toast notification\n  window.showToast &&\n    window.showToast(\n      `Switched to ${newTheme === 'dark' ? 'dark' : 'light'} mode`,\n      'info'\n    );\n}\n\nfunction setupScrollAnimations() {\n  // Set up animations for elements that enter the viewport\n  const animateOnScroll = () => {\n    const elements = document.querySelectorAll(\n      '.story-item, .page-title, .story-form, .auth-container'\n    );\n\n    elements.forEach((element) => {\n      // Check if element is in viewport\n      const rect = element.getBoundingClientRect();\n      const isInViewport =\n        rect.top <=\n          (window.innerHeight || document.documentElement.clientHeight) *\n            0.85 && rect.bottom >= 0;\n\n      if (isInViewport) {\n        element.classList.add('visible');\n\n        // Add the proper animation class based on element type\n        if (element.classList.contains('story-item')) {\n          element.classList.add('animate__animated', 'animate__fadeInUp');\n          // Stagger the animations slightly\n          const index = Array.from(element.parentNode.children).indexOf(\n            element\n          );\n          element.style.animationDelay = `${index * 0.1}s`;\n        } else if (element.classList.contains('page-title')) {\n          element.classList.add('animate__animated', 'animate__fadeInDown');\n        } else {\n          element.classList.add('animate__animated', 'animate__fadeIn');\n        }\n      }\n    });\n  };\n\n  // Run once on page load\n  setTimeout(animateOnScroll, 100);\n\n  // Add scroll event listener with debounce\n  let scrollTimeout;\n  window.addEventListener('scroll', () => {\n    clearTimeout(scrollTimeout);\n    scrollTimeout = setTimeout(animateOnScroll, 20);\n  });\n}\n\ndocument.addEventListener('DOMContentLoaded', initializeApp);\n"],"names":["message","source","lineno","colno","error","type","toastContainer","toast","icon","textSpan","connectionStatus","connectionMessage","updateConnectionStatus","CONFIG","DicodingStoryApi","url","options","retryAttempt","controller","signal","mergedOptions","timeout","response","errorData","errorMessage","resolve","reject","xhr","key","event","percentComplete","name","email","password","result","token","page","size","location","id","data","onProgress","subscription","endpoint","AppHeader","isLoggedIn","user","userData","getInitials","drawerButton","navigationDrawer","e","isOpen","firstNavItem","userMenu","userInfo","dropdown","isExpanded","firstItem","themeToggle","isDark","themeIcon","themeText","newTheme","text","logoutButton","notificationToggle","notificationStatus","statusIndicator","originalText","permission","registration","existingSubscription","subscriptionData","keys","cleanSubscriptionData","apiError","part","showFormattedDate","date","locale","defaultOptions","debounce","func","wait","immediate","args","context","later","callNow","formatFileSize","bytes","sizes","i","validateEmail","AppCard","story","formattedDate","titleId","descId","userColor","getUserColor","truncateText","lat","lon","storyId","storyName","storyDescription","mapElement","map","customIcon","observer","entries","entry","colors","hash","acc","char","maxLength","AppLoader","oldValue","newValue","messageElement","AppFooter","currentYear","yearElement","AppSidebar","toggleButton","jsonError","userInitials","overlay","closeButton","link","sidebar","route","currentRoute","instanceOfAny","object","constructors","c","idbProxyableTypes","cursorAdvanceMethods","getIdbProxyableTypes","getCursorAdvanceMethods","transactionDoneMap","transformCache","reverseTransformCache","promisifyRequest","request","promise","unlisten","success","wrap","cacheDonePromiseForTransaction","tx","done","complete","idbProxyTraps","target","prop","receiver","value","replaceTraps","callback","wrapFunction","unwrap","transformCachableValue","openDB","version","blocked","upgrade","blocking","terminated","openPromise","db","readMethods","writeMethods","cachedMethods","getMethod","targetFuncName","useIndex","isWrite","method","storeName","oldTraps","advanceMethodProps","methodMap","advanceResults","ittrProxiedCursorToOriginalProxy","cursorIteratorTraps","cachedFunc","iterate","cursor","proxiedCursor","isIteratorProp","dbPromise","saveStories","stories","getAllStories","deleteStory","HomePresenter","view","isChecked","cachedStories","HomePage","loadMoreButton","locationFilter","scrollY","visible","pageHeight","loader","loadingMore","storiesList","emptyState","index","card","validStories","hasMore","AboutPage","LoginPage","form","rememberMe","emailInput","passwordInput","isEmailValid","isPasswordValid","errorElement","rememberedEmail","rememberCheckbox","RegisterPage","nameInput","isNameValid","StoryDetailPresenter","cachedStory","delay","mapContainer","baseMaps","description","popup","cacheData","updatedCache","item","limitedCache","cachedStoryJson","parsedStory","parseError","cachedStoriesJson","foundStory","isFavorite","shareData","favoritesJson","favorites","StoryDetailPage","storyContent","storyPhoto","storyCreatedAt","storyTitleId","storyDescId","offlineNotice","match","initialState","favoriteButton","newState","shareButton","article","AddStoryPresenter","recentsJson","recents","draftId","draft","d","permissionStatus","cameraButton","track","draftTimeout","descriptionInput","draftsJson","drafts","preview","newDraft","formData","progress","file","stream","fallbackStream","dataUrl","filename","arr","mimeMatch","mime","bstr","n","u8arr","word","isDescriptionValid","isPhotoValid","photoInput","photoPreview","geocoder","lng","position","latitude","longitude","geocoderControl","searchButton","searchInput","query","locations","loc","opt","idx","selectedOption","locationText","results","locationName","AddStoryPage","textarea","charCount","count","container","html","btn","openCameraButton","takePhotoButton","cameraContainer","videoElement","canvas","flash","reader","photoError","locationCheckbox","_a","locateMeButton","searchLocationButton","latInput","lonInput","photoFile","useLocation","trimmedValue","descriptionError","submitButton","progressContainer","percent","progressBar","confettiSettings","NotFoundPage","SavedStoriesPage","listContainer","deleteBtn","routes","extractPathnameSegments","path","splitUrl","segment","getActivePathname","getActiveRoute","pathname","resource","isAddPage","parseActivePathname","App","content","__privateAdd","_App_instances","_content","_activePresenter","_previousRoute","__privateSet","__privateMethod","cleanupPreviousPage_fn","setDocumentTitle_fn","showLoading_fn","__privateGet","updateSidebar_fn","mainContent","showErrorPage_fn","hideLoading_fn","PageClass","titles","title","parsedUserData","defaultUserData","urlBase64ToUint8Array","base64String","padding","base64","rawData","subscribeUserToPush","applicationServerKey","cleanSubscription","showSplashScreen","splashScreen","logo","dotsContainer","dot","hideSplashScreen","deferredPrompt","installBtn","outcome","err","supportsViewTransitions","updateCallbackDone","initTheme","savedTheme","initializeApp","appElement","app","setupHeaderScrollEffect","setupThemeModeToggle","setupScrollAnimations","loadingSpinner","skipLinkHandler","skipLink","installContainer","choiceResult","header","scrollHandler","navList","themeToggleItem","currentTheme","secondItem","toggleTheme","animateOnScroll","element","rect","scrollTimeout"],"mappings":"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","x_google_ignoreList":[10]}