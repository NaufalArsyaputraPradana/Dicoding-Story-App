{"version":3,"file":"main-CWHRJiza.js","sources":["../../src/scripts/error-handler.js","../../src/scripts/connection-monitor.js","../../src/scripts/config.js","../../src/scripts/data/api.js","../../src/scripts/components/header.js","../../src/scripts/utils/index.js","../../src/scripts/components/card.js","../../src/scripts/components/loader.js","../../src/scripts/components/footer.js","../../src/scripts/components/sidebar.js","../../node_modules/idb/build/index.js","../../src/scripts/idb.js","../../src/scripts/pages/home/home-presenter.js","../../src/scripts/pages/home/home-page.js","../../src/scripts/pages/about/about-page.js","../../src/scripts/pages/auth/login/login-page.js","../../src/scripts/pages/auth/register/register-page.js","../../src/scripts/pages/story-detail/story-detail-presenter.js","../../src/scripts/pages/story-detail/story-detail-page.js","../../src/scripts/pages/add/add-presenter.js","../../src/scripts/pages/add/add-page.js","../../src/scripts/pages/not-found-page.js","../../src/scripts/routes/url-parser.js","../../src/scripts/utils/auth.js","../../src/scripts/pages/saved/saved-page.js","../../src/scripts/routes/routes.js","../../src/scripts/pages/app.js","../../src/scripts/utils/notification-helper.js","../../src/scripts/index.js"],"sourcesContent":["(function () {\n  window.onerror = function (message, source, lineno, colno, error) {\n    console.error('Global error caught:', {\n      message,\n      source,\n      lineno,\n      colno,\n      error,\n    });\n\n    if (message && message.includes('Cannot read properties of undefined')) {\n      if (!window.hasShownErrorMessage) {\n        window.hasShownErrorMessage = true;\n        setTimeout(() => {\n          window.hasShownErrorMessage = false;\n        }, 5000);\n\n        if (!window.location.hash.includes('error')) {\n          window.showToast?.(\n            'Terjadi kesalahan saat menampilkan konten. Kami akan mencoba memperbaikinya secara otomatis.',\n            'warning'\n          );\n        }\n      }\n      return true;\n    }\n    return false;\n  };\n\n  window.showToast = function (message, type = 'info') {\n    const toastContainer = document.getElementById('toast-container');\n    if (!toastContainer) return;\n\n    const toast = document.createElement('div');\n    toast.className = `toast toast-${type}`;\n    toast.setAttribute('role', 'alert');\n\n    const icon = document.createElement('i');\n    icon.className = `fas ${\n      type === 'success'\n        ? 'fa-check-circle'\n        : type === 'error'\n        ? 'fa-exclamation-circle'\n        : type === 'warning'\n        ? 'fa-exclamation-triangle'\n        : 'fa-info-circle'\n    }`;\n    icon.setAttribute('aria-hidden', 'true');\n\n    const textSpan = document.createElement('span');\n    textSpan.textContent = message;\n\n    toast.appendChild(icon);\n    toast.appendChild(textSpan);\n    toastContainer.appendChild(toast);\n\n    requestAnimationFrame(() => {\n      setTimeout(() => {\n        toast.classList.add('show');\n      }, 10);\n    });\n\n    setTimeout(() => {\n      toast.classList.remove('show');\n      setTimeout(() => {\n        if (toastContainer.contains(toast)) {\n          toastContainer.removeChild(toast);\n        }\n      }, 300);\n    }, 5000);\n  };\n})();\n","(function () {\n  const connectionStatus = document.getElementById('connection-status');\n  const connectionMessage = document.getElementById('connection-message');\n\n  if (!connectionStatus || !connectionMessage) return;\n\n  function updateConnectionStatus() {\n    if (navigator.onLine) {\n      connectionStatus.classList.add('online');\n      connectionStatus.classList.remove('offline');\n      connectionMessage.textContent = 'Koneksi telah pulih';\n      setTimeout(() => {\n        connectionStatus.classList.add('hidden');\n      }, 3000);\n    } else {\n      connectionStatus.classList.remove('online');\n      connectionStatus.classList.add('offline');\n      connectionStatus.classList.remove('hidden');\n      connectionMessage.textContent = 'Anda sedang offline';\n    }\n  }\n\n  updateConnectionStatus();\n\n  window.addEventListener('online', updateConnectionStatus);\n  window.addEventListener('offline', updateConnectionStatus);\n})();\n","const CONFIG = {\n  BASE_URL: 'https://story-api.dicoding.dev/v1',\n  DEFAULT_LANGUAGE: 'id-ID',\n  CACHE_NAME: 'DicodingStory-V5',\n  DATABASE_NAME: 'dicoding-story-database',\n  DATABASE_VERSION: 1,\n  OBJECT_STORE_NAME: 'stories',\n  DEFAULT_MAP_CENTER: [-6.1754, 106.8272], // Jakarta\n  DEFAULT_MAP_ZOOM: 13,\n  PAGE_SIZE: 10,\n  API_TIMEOUT: 30000,\n  API_RETRY_ATTEMPTS: 2,\n  API_RETRY_DELAY: 1000,\n  MAX_PHOTO_SIZE: 5 * 1024 * 1024, // 5MB\n  MAP_TILE_LAYERS: {\n    osm: {\n      url: 'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\n      attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\n      name: 'OpenStreetMap',\n    },\n    satellite: {\n      url: 'https://api.maptiler.com/maps/hybrid/{z}/{x}/{y}.jpg?key=WlHVW3GmIbcYKHpoc75N',\n      attribution: '<a href=\"https://www.maptiler.com/copyright/\" target=\"_blank\">&copy; MapTiler</a> <a href=\"https://www.openstreetmap.org/copyright\" target=\"_blank\">&copy; OpenStreetMap contributors</a>',\n      name: 'Satellite',\n    },\n    dark: {\n      url: 'https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png',\n      attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors &copy; <a href=\"https://carto.com/attributions\">CARTO</a>',\n      name: 'Dark Mode',\n    },\n  },\n  VAPID_PUBLIC_KEY: 'BCCs2eonMI-6H2ctvFaWg-UYdDv387Vno_bzUzALpB442r2lCnsHmtrx8biyPi_E-1fSGABK_Qs_GlvPoJJqxbk',\n  SERVICE_WORKER_PATH: './sw.js',\n  OFFLINE_PAGE: './offline.html',\n  ACCESS_TOKEN_KEY: 'accessToken',\n};\n\nexport default CONFIG;\n","import CONFIG from '../config';\n\nclass DicodingStoryApi {\n  // Helper: fetch with timeout and retry\n  static async _fetchWithTimeout(url, options = {}, retryAttempt = 0) {\n    const controller = new AbortController();\n    const { signal } = controller;\n    const mergedOptions = {\n      ...options,\n      signal,\n      mode: 'cors',\n      credentials: 'same-origin',\n    };\n\n    const timeout = setTimeout(() => controller.abort(), CONFIG.API_TIMEOUT);\n\n    try {\n      // Handle upload with progress\n      if (\n        options.body instanceof FormData &&\n        options.onProgress &&\n        options.method === 'POST'\n      ) {\n        return await this._uploadWithProgress(url, options);\n      }\n\n      const response = await fetch(url, mergedOptions);\n\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({}));\n        let errorMessage = errorData.message || `HTTP error! status: ${response.status}`;\n\n        // User-friendly error messages\n        if (response.status === 400) {\n          errorMessage = errorData.message || 'Bad Request: The server could not process your request.';\n          const error = new Error(errorMessage);\n          error.status = response.status;\n          error.data = errorData;\n          throw error;\n        } else if (response.status === 401) {\n          errorMessage = 'Your session has expired. Please login again.';\n          setTimeout(() => (window.location.hash = '#/login'), 2000);\n        } else if (response.status === 403) {\n          errorMessage = \"You don't have permission to perform this action.\";\n        } else if (response.status === 404) {\n          errorMessage = 'The requested resource was not found.';\n        } else if (response.status === 413) {\n          errorMessage = 'The file you are trying to upload is too large.';\n        } else if (response.status >= 500) {\n          errorMessage = 'Server error. Please try again later.';\n        }\n\n        throw new Error(errorMessage);\n      }\n\n      return await response.json();\n    } catch (error) {\n      if (error.name === 'AbortError') {\n        if (retryAttempt < CONFIG.API_RETRY_ATTEMPTS) {\n          await new Promise((resolve) => setTimeout(resolve, CONFIG.API_RETRY_DELAY));\n          return this._fetchWithTimeout(url, options, retryAttempt + 1);\n        }\n        throw new Error('Request timed out. Please check your internet connection and try again.');\n      }\n\n      // Network/CORS errors\n      if (\n        error.message === 'Failed to fetch' ||\n        error.message.includes('NetworkError') ||\n        error.message.includes('CORS')\n      ) {\n        if (url.includes('/notifications/')) {\n          return { status: 'failed', error: error.message };\n        }\n        window.showToast?.('Network connection issue. Please check your internet connection.', 'warning');\n      }\n\n      throw error;\n    } finally {\n      clearTimeout(timeout);\n    }\n  }\n\n  // Helper: upload with progress\n  static async _uploadWithProgress(url, options) {\n    return new Promise((resolve, reject) => {\n      const xhr = new XMLHttpRequest();\n      xhr.open(options.method || 'POST', url);\n\n      if (options.headers) {\n        Object.keys(options.headers).forEach((key) => {\n          xhr.setRequestHeader(key, options.headers[key]);\n        });\n      }\n\n      xhr.upload.addEventListener('progress', (event) => {\n        if (event.lengthComputable && options.onProgress) {\n          const percentComplete = Math.round((event.loaded / event.total) * 100);\n          options.onProgress(percentComplete);\n        }\n      });\n\n      xhr.addEventListener('load', () => {\n        if (xhr.status >= 200 && xhr.status < 300) {\n          try {\n            resolve(JSON.parse(xhr.responseText));\n          } catch {\n            reject(new Error('Invalid response format from server'));\n          }\n        } else {\n          try {\n            const errorData = JSON.parse(xhr.responseText);\n            reject(new Error(errorData.message || `HTTP error! status: ${xhr.status}`));\n          } catch {\n            reject(new Error(`HTTP error! status: ${xhr.status}`));\n          }\n        }\n      });\n\n      xhr.addEventListener('error', () => reject(new Error('Network error occurred')));\n      xhr.addEventListener('abort', () => reject(new Error('Upload aborted')));\n      xhr.addEventListener('timeout', () => reject(new Error('Upload timed out')));\n      xhr.send(options.body);\n    });\n  }\n\n  // Auth\n  static async register({ name, email, password }) {\n    this._validateEmail(email);\n    this._validatePassword(password);\n\n    try {\n      const result = await this._fetchWithTimeout(`${CONFIG.BASE_URL}/register`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ name, email, password }),\n      });\n      window.showToast?.('Registrasi berhasil! Silakan login.', 'success');\n      return result;\n    } catch (error) {\n      if (error.message.includes('email is already taken')) {\n        throw new Error('Email sudah digunakan. Silakan gunakan email lain.');\n      }\n      throw error;\n    }\n  }\n\n  static async login({ email, password }) {\n    this._validateEmail(email);\n\n    try {\n      const result = await this._fetchWithTimeout(`${CONFIG.BASE_URL}/login`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ email, password }),\n      });\n      window.showToast?.(`Selamat datang kembali, ${result.loginResult.name}!`, 'success');\n      return result;\n    } catch (error) {\n      if (\n        error.message.includes('user not found') ||\n        error.message.includes('password')\n      ) {\n        throw new Error('Email atau password salah. Silakan coba lagi.');\n      }\n      throw error;\n    }\n  }\n\n  // Stories\n  static async getAllStories({ token, page = 1, size = CONFIG.PAGE_SIZE, location = 0 }) {\n    this._validateToken(token);\n\n    try {\n      const response = await this._fetchWithTimeout(\n        `${CONFIG.BASE_URL}/stories?page=${page}&size=${size}&location=${location}`,\n        { headers: { Authorization: `Bearer ${token}` } }\n      );\n      if (!response || !response.listStory) {\n        throw new Error('Format respons dari server tidak valid');\n      }\n      return response;\n    } catch (error) {\n      window.showToast?.('Gagal memuat cerita. ' + error.message, 'error');\n      throw error;\n    }\n  }\n\n  static async getStoryDetail({ token, id }) {\n    this._validateToken(token);\n    if (!id) throw new Error('ID cerita tidak valid');\n    return this._fetchWithTimeout(`${CONFIG.BASE_URL}/stories/${id}`, {\n      headers: { Authorization: `Bearer ${token}` },\n    });\n  }\n\n  static async addNewStory({ token, data, onProgress }) {\n    this._validateToken(token);\n\n    try {\n      if (!data.has('description')) throw new Error('Description is required');\n      if (!data.has('photo')) throw new Error('Photo is required');\n\n      const options = {\n        method: 'POST',\n        headers: { Authorization: `Bearer ${token}` },\n        body: data,\n        onProgress,\n      };\n\n      const result = await this._fetchWithTimeout(`${CONFIG.BASE_URL}/stories`, options);\n      window.showToast?.('Cerita berhasil ditambahkan!', 'success');\n      return result;\n    } catch (error) {\n      if (error.message.includes('photo')) {\n        throw new Error('Gagal mengunggah foto. Pastikan ukuran foto tidak melebihi 5MB.');\n      } else if (error.status === 400) {\n        throw new Error('Bad request: Pastikan semua data yang dikirim valid (foto dan deskripsi wajib diisi).');\n      } else if (\n        error.message.includes('Network') ||\n        error.message.includes('timeout')\n      ) {\n        throw new Error('Koneksi gagal. Periksa koneksi internet Anda dan coba lagi.');\n      }\n      throw error;\n    }\n  }\n\n  // Push Notification\n  static async subscribeNotification({ token, subscription }) {\n    this._validateToken(token);\n    try {\n      const result = await this._fetchWithTimeout(\n        `${CONFIG.BASE_URL}/notifications/subscribe`,\n        {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n            Authorization: `Bearer ${token}`,\n          },\n          body: JSON.stringify(subscription),\n        }\n      );\n      window.showToast?.('Notifikasi berhasil diaktifkan!', 'success');\n      return result;\n    } catch (error) {\n      window.showToast?.('Gagal mengaktifkan notifikasi', 'error');\n      throw error;\n    }\n  }\n\n  static async unsubscribeNotification({ token, endpoint }) {\n    this._validateToken(token);\n    if (!endpoint) throw new Error('Endpoint notifikasi tidak valid');\n\n    try {\n      const isDev =\n        window.location.hostname === 'localhost' ||\n        window.location.hostname === '127.0.0.1';\n\n      if (isDev) {\n        window.showToast?.('Notifikasi berhasil dinonaktifkan (dev mode)', 'info');\n        return { success: true, message: 'Unsubscribed from notifications (development mock)' };\n      }\n\n      const result = await this._fetchWithTimeout(\n        `${CONFIG.BASE_URL}/notifications/subscribe`,\n        {\n          method: 'DELETE',\n          headers: {\n            'Content-Type': 'application/json',\n            Authorization: `Bearer ${token}`,\n          },\n          body: JSON.stringify({ endpoint }),\n        }\n      );\n      window.showToast?.('Notifikasi berhasil dinonaktifkan', 'info');\n      return result;\n    } catch (error) {\n      if (\n        !(\n          window.location.hostname === 'localhost' ||\n          window.location.hostname === '127.0.0.1'\n        )\n      ) {\n        window.showToast?.('Gagal menonaktifkan notifikasi', 'error');\n      }\n      throw error;\n    }\n  }\n\n  // Validation helpers\n  static _validateToken(token) {\n    if (!token) throw new Error('Autentikasi diperlukan. Silakan login terlebih dahulu.');\n  }\n\n  static _validateEmail(email) {\n    const re = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n    if (!re.test(email)) throw new Error('Silakan masukkan alamat email yang valid');\n  }\n\n  static _validatePassword(password) {\n    if (password.length < 8) throw new Error('Password harus minimal 8 karakter');\n  }\n}\n\nexport default DicodingStoryApi;\n","import DicodingStoryApi from '../data/api';\nimport CONFIG from '../config';\n\nclass AppHeader extends HTMLElement {\n  connectedCallback() {\n    this.render();\n    this.setupEventListeners();\n    this.checkNotificationPermission();\n  }\n\n  render() {\n    const isLoggedIn = !!localStorage.getItem('token');\n    let user = null;\n    try {\n      const userData = localStorage.getItem('user');\n      if (userData && userData !== 'undefined') user = JSON.parse(userData);\n    } catch {\n      localStorage.removeItem('user');\n    }\n\n    this.innerHTML = `\n      <header>\n        <div class=\"container main-header\">\n          <a class=\"brand-name\" href=\"#/\" aria-label=\"Home\">\n            <img src=\"/images/logo.png\" alt=\"Dicoding Story Logo\" width=\"32\" height=\"32\">\n            Dicoding Story\n          </a>\n          <nav id=\"navigation-drawer\" class=\"navigation-drawer\" aria-label=\"Main navigation\">\n            <ul id=\"nav-list\" class=\"nav-list\">\n              <li>\n                <a href=\"#/\" class=\"${window.location.hash === '#/' ? 'active' : ''}\" aria-current=\"${window.location.hash === '#/' ? 'page' : 'false'}\">\n                  <i class=\"fas fa-home\" aria-hidden=\"true\"></i> Home\n                </a>\n              </li>\n              <li>\n                <a href=\"#/about\" class=\"${window.location.hash === '#/about' ? 'active' : ''}\" aria-current=\"${window.location.hash === '#/about' ? 'page' : 'false'}\">\n                  <i class=\"fas fa-info-circle\" aria-hidden=\"true\"></i> About\n                </a>\n              </li>\n              ${\n                isLoggedIn\n                  ? `\n                    <li>\n                      <a href=\"#/stories/add\" class=\"${window.location.hash === '#/stories/add' ? 'active' : ''}\" aria-current=\"${window.location.hash === '#/stories/add' ? 'page' : 'false'}\">\n                        <i class=\"fas fa-plus-circle\" aria-hidden=\"true\"></i> Add Story\n                      </a>\n                    </li>\n                    <li>\n                      <a href=\"#/saved\" class=\"${window.location.hash === '#/saved' ? 'active' : ''}\" aria-current=\"${window.location.hash === '#/saved' ? 'page' : 'false'}\">\n                        <i class=\"fas fa-database\" aria-hidden=\"true\"></i> Saved Stories\n                      </a>\n                    </li>\n                    <li class=\"user-menu\">\n                      <div class=\"user-info\" tabindex=\"0\" aria-haspopup=\"true\" aria-expanded=\"false\">\n                        <div class=\"user-avatar\" aria-hidden=\"true\">${getInitials(user?.name)}</div>\n                        <span>${user?.name || 'User'}</span>\n                        <i class=\"fas fa-chevron-down ml-1\" aria-hidden=\"true\"></i>\n                      </div>\n                      <ul class=\"user-dropdown\" role=\"menu\" style=\"display: none;\">\n                        <li role=\"none\">\n                          <button id=\"notification-toggle\" class=\"dropdown-button notification-toggle\" role=\"menuitem\">\n                            <i class=\"fas fa-bell\" aria-hidden=\"true\"></i>\n                            <span id=\"notification-status\">Enable Notifications</span>\n                            <span class=\"status-indicator\"></span>\n                          </button>\n                        </li>\n                        <li role=\"none\">\n                          <button id=\"logout-button\" class=\"dropdown-button logout-button\" role=\"menuitem\">\n                            <i class=\"fas fa-sign-out-alt\" aria-hidden=\"true\"></i>\n                            Logout\n                          </button>\n                        </li>\n                      </ul>\n                    </li>\n                  `\n                  : `\n                    <li>\n                      <a href=\"#/login\" class=\"${window.location.hash === '#/login' ? 'active' : ''}\" aria-current=\"${window.location.hash === '#/login' ? 'page' : 'false'}\">\n                        <i class=\"fas fa-sign-in-alt\" aria-hidden=\"true\"></i> Login\n                      </a>\n                    </li>\n                    <li>\n                      <a href=\"#/register\" class=\"${window.location.hash === '#/register' ? 'active' : ''}\" aria-current=\"${window.location.hash === '#/register' ? 'page' : 'false'}\">\n                        <i class=\"fas fa-user-plus\" aria-hidden=\"true\"></i> Register\n                      </a>\n                    </li>\n                  `\n              }\n            </ul>\n          </nav>\n          <button id=\"drawer-button\" class=\"drawer-button\" aria-label=\"Toggle navigation\" aria-expanded=\"false\" aria-controls=\"navigation-drawer\">\n            <i class=\"fas fa-bars\" aria-hidden=\"true\"></i>\n          </button>\n        </div>\n      </header>\n    `;\n  }\n\n  setupEventListeners() {\n    this._setupDrawerToggle();\n    this._setupUserMenu();\n    this._setupLogoutButton();\n    this._setupNotificationToggle();\n  }\n\n  _setupDrawerToggle() {\n    const drawerButton = this.querySelector('#drawer-button');\n    const navigationDrawer = this.querySelector('#navigation-drawer');\n    if (!drawerButton || !navigationDrawer) return;\n\n    drawerButton.addEventListener('click', (e) => {\n      e.stopPropagation();\n      const isOpen = navigationDrawer.classList.toggle('open');\n      drawerButton.setAttribute('aria-expanded', isOpen);\n      if (isOpen) {\n        const firstNavItem = navigationDrawer.querySelector('a');\n        if (firstNavItem) firstNavItem.focus();\n      }\n    });\n\n    document.addEventListener('click', (event) => {\n      if (!navigationDrawer.contains(event.target)) {\n        navigationDrawer.classList.remove('open');\n        drawerButton.setAttribute('aria-expanded', 'false');\n      }\n    });\n\n    document.addEventListener('keydown', (event) => {\n      if (event.key === 'Escape') {\n        navigationDrawer.classList.remove('open');\n        drawerButton.setAttribute('aria-expanded', 'false');\n        drawerButton.focus();\n      }\n    });\n  }\n\n  _setupUserMenu() {\n    const userMenu = this.querySelector('.user-menu');\n    if (!userMenu) return;\n    const userInfo = userMenu.querySelector('.user-info');\n    const dropdown = userMenu.querySelector('.user-dropdown');\n\n    userInfo.addEventListener('click', (e) => {\n      e.stopPropagation();\n      const isExpanded = userInfo.getAttribute('aria-expanded') === 'true';\n      userInfo.setAttribute('aria-expanded', !isExpanded);\n      dropdown.style.display = isExpanded ? 'none' : 'block';\n    });\n\n    document.addEventListener('click', () => {\n      userInfo.setAttribute('aria-expanded', 'false');\n      dropdown.style.display = 'none';\n    });\n\n    userInfo.addEventListener('keydown', (e) => {\n      if (e.key === 'Enter' || e.key === ' ') {\n        e.preventDefault();\n        const isExpanded = userInfo.getAttribute('aria-expanded') === 'true';\n        userInfo.setAttribute('aria-expanded', !isExpanded);\n        dropdown.style.display = isExpanded ? 'none' : 'block';\n        if (!isExpanded) {\n          const firstItem = dropdown.querySelector('button');\n          if (firstItem) firstItem.focus();\n        }\n      }\n    });\n  }\n\n  _setupLogoutButton() {\n    const logoutButton = this.querySelector('#logout-button');\n    if (!logoutButton) return;\n    logoutButton.addEventListener('click', () => {\n      Swal.fire({\n        title: 'Logout',\n        text: 'Are you sure you want to logout?',\n        icon: 'question',\n        showCancelButton: true,\n        confirmButtonColor: '#4361ee',\n        cancelButtonColor: '#f72585',\n        confirmButtonText: 'Yes, Logout',\n        cancelButtonText: 'Cancel',\n        focusCancel: true,\n      }).then((result) => {\n        if (result.isConfirmed) {\n          this._cleanupNotifications();\n          localStorage.removeItem('token');\n          localStorage.removeItem('user');\n          window.showToast && window.showToast('Logout successful', 'success');\n          window.location.hash = '#/login';\n        }\n      });\n    });\n  }\n\n  async _cleanupNotifications() {\n    if (!('serviceWorker' in navigator) || !('PushManager' in window)) return;\n    try {\n      const registration = await navigator.serviceWorker.ready;\n      const subscription = await registration.pushManager.getSubscription();\n      if (subscription) await subscription.unsubscribe();\n    } catch {}\n  }\n\n  async checkNotificationPermission() {\n    const notificationToggle = this.querySelector('#notification-toggle');\n    const notificationStatus = this.querySelector('#notification-status');\n    const statusIndicator = this.querySelector('.status-indicator');\n    if (!notificationToggle || !notificationStatus || !statusIndicator) return;\n\n    if (Notification.permission === 'granted') {\n      const hasSubscription = await this._checkActiveSubscription();\n      notificationStatus.textContent = hasSubscription ? 'Disable Notifications' : 'Enable Notifications';\n      statusIndicator.classList.toggle('active', hasSubscription);\n      notificationToggle.classList.toggle('enabled', hasSubscription);\n    } else if (Notification.permission === 'denied') {\n      notificationStatus.textContent = 'Notifications Blocked';\n      notificationToggle.disabled = true;\n      notificationToggle.classList.add('blocked');\n      statusIndicator.classList.add('blocked');\n    } else {\n      notificationStatus.textContent = 'Enable Notifications';\n      statusIndicator.classList.remove('active');\n      notificationToggle.classList.remove('enabled');\n    }\n  }\n\n  async _checkActiveSubscription() {\n    if (!('serviceWorker' in navigator) || !('PushManager' in window)) return false;\n    try {\n      const registration = await navigator.serviceWorker.ready;\n      const subscription = await registration.pushManager.getSubscription();\n      return !!subscription;\n    } catch {\n      return false;\n    }\n  }\n\n  _setupNotificationToggle() {\n    const notificationToggle = this.querySelector('#notification-toggle');\n    const notificationStatus = this.querySelector('#notification-status');\n    const statusIndicator = this.querySelector('.status-indicator');\n    if (!notificationToggle || !notificationStatus || !statusIndicator) return;\n\n    notificationToggle.addEventListener('click', async () => {\n      if (notificationToggle.disabled) return;\n      notificationToggle.disabled = true;\n      notificationToggle.classList.add('loading');\n      const originalText = notificationStatus.textContent;\n      notificationStatus.textContent = 'Processing...';\n\n      try {\n        const hasSubscription = await this._checkActiveSubscription();\n        if (hasSubscription) {\n          await this._unsubscribeFromNotifications();\n          notificationStatus.textContent = 'Enable Notifications';\n          statusIndicator.classList.remove('active');\n          notificationToggle.classList.remove('enabled');\n        } else {\n          if (Notification.permission === 'granted') {\n            await this._subscribeToNotifications();\n            notificationStatus.textContent = 'Disable Notifications';\n            statusIndicator.classList.add('active');\n            notificationToggle.classList.add('enabled');\n          } else {\n            const permission = await Notification.requestPermission();\n            if (permission === 'granted') {\n              await this._subscribeToNotifications();\n              notificationStatus.textContent = 'Disable Notifications';\n              statusIndicator.classList.add('active');\n              notificationToggle.classList.add('enabled');\n            } else if (permission === 'denied') {\n              notificationStatus.textContent = 'Notifications Blocked';\n              notificationToggle.disabled = true;\n              notificationToggle.classList.add('blocked');\n              statusIndicator.classList.add('blocked');\n              window.showToast && window.showToast('Notification permission denied by browser', 'warning');\n            }\n          }\n        }\n      } catch {\n        notificationStatus.textContent = originalText;\n        window.showToast && window.showToast('Failed to toggle notifications', 'error');\n      } finally {\n        notificationToggle.disabled = false;\n        notificationToggle.classList.remove('loading');\n      }\n    });\n  }\n\n  async _subscribeToNotifications() {\n    if (!('serviceWorker' in navigator) || !('PushManager' in window)) return;\n    const token = localStorage.getItem('token');\n    if (!token) return;\n    try {\n      const registration = await navigator.serviceWorker.ready;\n      const existingSubscription = await registration.pushManager.getSubscription();\n      if (existingSubscription) await existingSubscription.unsubscribe();\n      const subscription = await registration.pushManager.subscribe({\n        userVisibleOnly: true,\n        applicationServerKey: CONFIG.VAPID_PUBLIC_KEY,\n      });\n      const { endpoint, keys } = subscription.toJSON();\n      await DicodingStoryApi.subscribeNotification({\n        token,\n        subscription: { endpoint, keys },\n      });\n      window.showToast && window.showToast('Notifications enabled successfully', 'success');\n      return true;\n    } catch {\n      window.showToast && window.showToast('Failed to enable notifications', 'error');\n      return false;\n    }\n  }\n\n  async _unsubscribeFromNotifications() {\n    const token = localStorage.getItem('token');\n    if (!token) return false;\n    try {\n      const registration = await navigator.serviceWorker.ready;\n      const subscription = await registration.pushManager.getSubscription();\n      if (subscription) {\n        try {\n          await DicodingStoryApi.unsubscribeNotification({\n            token,\n            endpoint: subscription.endpoint,\n          });\n        } catch {}\n        await subscription.unsubscribe();\n        window.showToast && window.showToast('Notifications disabled successfully', 'info');\n        return true;\n      }\n      return true;\n    } catch {\n      window.showToast && window.showToast('Failed to disable notifications', 'error');\n      return false;\n    }\n  }\n}\n\ncustomElements.define('app-header', AppHeader);\n\nfunction getInitials(name) {\n  if (!name) return 'U';\n  return name\n    .split(' ')\n    .map((part) => part.charAt(0))\n    .join('')\n    .toUpperCase();\n}\n","export function showFormattedDate(date, locale = 'id-ID', options = {}) {\n  const defaultOptions = { year: 'numeric', month: 'long', day: 'numeric', ...options };\n  try {\n    return new Date(date).toLocaleDateString(locale, defaultOptions);\n  } catch (error) {\n    console.error('Error formatting date:', error);\n    return date || 'Unknown date';\n  }\n}\n\nexport function truncateText(text, maxLength = 100) {\n  if (!text) return '';\n  return text.length <= maxLength ? text : `${text.substring(0, maxLength)}...`;\n}\n\nexport function debounce(func, wait = 300, immediate = false) {\n  let timeout;\n  return function executedFunction(...args) {\n    const context = this;\n    const later = () => {\n      timeout = null;\n      if (!immediate) func.apply(context, args);\n    };\n    const callNow = immediate && !timeout;\n    clearTimeout(timeout);\n    timeout = setTimeout(later, wait);\n    if (callNow) func.apply(context, args);\n  };\n}\n\nexport async function sleep(ms = 1000) {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n}\n\nexport function formatFileSize(bytes) {\n  if (bytes === 0) return '0 Bytes';\n  const sizes = ['Bytes', 'KB', 'MB', 'GB'];\n  const i = Math.floor(Math.log(bytes) / Math.log(1024));\n  return parseFloat((bytes / Math.pow(1024, i)).toFixed(2)) + ' ' + sizes[i];\n}\n\nexport function validateEmail(email) {\n  const re = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n  return re.test(email);\n}\n\nexport function getInitials(name) {\n  if (!name) return 'U';\n  return name\n    .split(' ')\n    .map((part) => part.charAt(0))\n    .join('')\n    .toUpperCase();\n}\n\nexport function isMobileDevice() {\n  return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n}\n\nexport function isOnline() {\n  return navigator.onLine;\n}\n\nexport function capitalizeFirstLetter(string) {\n  return string.charAt(0).toUpperCase() + string.slice(1);\n}\n\nexport function getRandomColor() {\n  const colors = [\n    '#4361ee', '#3f37c9', '#4895ef', '#4cc9f0', '#f72585', '#b5179e',\n  ];\n  return colors[Math.floor(Math.random() * colors.length)];\n}\n\nexport function animateElement(element, animation, duration = 300) {\n  return new Promise((resolve) => {\n    const animationClass = `animate-${animation}`;\n    element.classList.add(animationClass);\n    setTimeout(() => {\n      element.classList.remove(animationClass);\n      resolve();\n    }, duration);\n  });\n}\n","import { showFormattedDate, truncateText } from '../utils/index';\nimport CONFIG from '../config';\n\nclass AppCard extends HTMLElement {\n  set story(data) {\n    this._story = data;\n    this.render();\n  }\n\n  render() {\n    if (!this._story) return;\n\n    try {\n      const story = {\n        id: this._story.id || `unknown-${Date.now()}`,\n        name: this._story.name || 'Unknown User',\n        description: this._story.description || 'No description provided',\n        photoUrl: this._story.photoUrl || './images/placeholder.jpg',\n        createdAt: this._story.createdAt || new Date().toISOString(),\n        lat: this._story.lat,\n        lon: this._story.lon,\n      };\n\n      const formattedDate = showFormattedDate(story.createdAt, 'id-ID');\n      const titleId = `story-title-${story.id}`;\n      const descId = `story-desc-${story.id}`;\n      const userColor = getUserColor(story.name);\n\n      // Check if story is saved in favorites (localStorage)\n      const favoritesJson = localStorage.getItem('favoriteStories');\n      let isSaved = false;\n      if (favoritesJson) {\n        try {\n          const favorites = JSON.parse(favoritesJson);\n          isSaved = Array.isArray(favorites) && favorites.includes(story.id);\n        } catch {\n          isSaved = false;\n        }\n      }\n\n      this.innerHTML = `\n        <article class=\"story-item\" aria-labelledby=\"${titleId}\" aria-describedby=\"${descId}\">\n          <div class=\"story-image-container\">\n            <div class=\"story-badge\" style=\"background-color: ${userColor}\">\n              <i class=\"fas fa-camera\" aria-hidden=\"true\"></i>\n            </div>\n            <img \n              class=\"story-image\" \n              src=\"${story.photoUrl}\" \n              alt=\"Photo shared by ${story.name}\" \n              loading=\"lazy\"\n              onerror=\"this.src='./images/placeholder.jpg'\"\n            >\n          </div>\n          <div class=\"story-content\">\n            <div class=\"story-header\">\n              <div class=\"story-user\">\n                <div class=\"user-avatar\" aria-hidden=\"true\" style=\"background-color: ${userColor}\">\n                  ${getInitials(story.name)}\n                </div>\n                <div>\n                  <h3 class=\"story-name\" id=\"${titleId}\">${story.name}</h3>\n                  <time class=\"story-date\" datetime=\"${story.createdAt}\">\n                    <i class=\"far fa-calendar-alt\" aria-hidden=\"true\"></i> ${formattedDate}\n                  </time>\n                </div>\n              </div>\n              ${\n                story.lat && story.lon\n                  ? `<div class=\"story-location-badge\" title=\"Has location data\">\n                      <i class=\"fas fa-map-marker-alt\" aria-hidden=\"true\"></i>\n                    </div>`\n                  : ''\n              }\n            </div>\n            <p class=\"story-description\" id=\"${descId}\">${truncateText(story.description, 120)}</p>\n            ${\n              story.lat && story.lon\n                ? `<div class=\"story-map\" id=\"map-${story.id}\" aria-label=\"Location of story by ${story.name}\" tabindex=\"0\"></div>`\n                : ''\n            }\n            <div class=\"story-actions\">\n              <a href=\"#/stories/${story.id}\" class=\"story-link\" aria-label=\"Read full story by ${story.name}\">\n                <i class=\"fas fa-book-reader\" aria-hidden=\"true\"></i>\n                Read Full Story\n              </a>\n              <button \n                class=\"save-story-btn${isSaved ? ' saved' : ''}\" \n                aria-label=\"${isSaved ? 'Saved' : 'Save to favorites'}\"\n                title=\"${isSaved ? 'Saved' : 'Save to favorites'}\"\n              >\n                <i class=\"fas fa-bookmark\"></i>\n                <span>${isSaved ? 'Saved' : 'Save'}</span>\n              </button>\n            </div>\n          </div>\n        </article>\n      `;\n\n      // Save button logic\n      const saveBtn = this.querySelector('.save-story-btn');\n      if (saveBtn) {\n        saveBtn.addEventListener('click', (e) => {\n          e.preventDefault();\n          let favorites = [];\n          try {\n            const favoritesJson = localStorage.getItem('favoriteStories');\n            favorites = favoritesJson ? JSON.parse(favoritesJson) : [];\n          } catch {\n            favorites = [];\n          }\n          const alreadySaved = favorites.includes(story.id);\n          if (!alreadySaved) {\n            favorites.push(story.id);\n            localStorage.setItem('favoriteStories', JSON.stringify(favorites));\n            saveBtn.classList.add('saved');\n            saveBtn.setAttribute('aria-label', 'Saved');\n            saveBtn.title = 'Saved';\n            saveBtn.querySelector('span').textContent = 'Saved';\n            window.showToast?.('Cerita disimpan ke Favorit!', 'success');\n          } else {\n            // Optional: allow unsave\n            favorites = favorites.filter((id) => id !== story.id);\n            localStorage.setItem('favoriteStories', JSON.stringify(favorites));\n            saveBtn.classList.remove('saved');\n            saveBtn.setAttribute('aria-label', 'Save to favorites');\n            saveBtn.title = 'Save to favorites';\n            saveBtn.querySelector('span').textContent = 'Save';\n            window.showToast?.('Cerita dihapus dari Favorit', 'info');\n          }\n        });\n      }\n\n      if (story.lat && story.lon) {\n        requestAnimationFrame(() => this.renderMap());\n      }\n    } catch (error) {\n      this.innerHTML = `\n        <article class=\"story-item\">\n          <div class=\"story-content\">\n            <div class=\"story-header\">\n              <div class=\"story-user\">\n                <div class=\"user-avatar\" style=\"background-color: #4361ee\">U</div>\n                <div>\n                  <h3 class=\"story-name\">Story data error</h3>\n                  <time class=\"story-date\">Unknown date</time>\n                </div>\n              </div>\n            </div>\n            <p class=\"story-description\">There was an error rendering this story. Please try refreshing the page.</p>\n            <div class=\"story-actions\">\n              <a href=\"#/\" class=\"story-link\">\n                <i class=\"fas fa-home\" aria-hidden=\"true\"></i>\n                Back to Home\n              </a>\n            </div>\n          </div>\n        </article>\n      `;\n    }\n  }\n\n  renderMap() {\n    try {\n      if (!this._story) return;\n      const lat = parseFloat(this._story.lat);\n      const lon = parseFloat(this._story.lon);\n      if (isNaN(lat) || isNaN(lon)) return;\n\n      const storyId = this._story.id || `unknown-${Date.now()}`;\n      const storyName = this._story.name || 'Unknown User';\n      const storyDescription = this._story.description || '';\n      const mapElement = this.querySelector(`#map-${storyId}`);\n      if (!mapElement || !window.L) return;\n\n      const map = L.map(mapElement, {\n        zoomControl: false,\n        dragging: false,\n        touchZoom: false,\n        scrollWheelZoom: false,\n        doubleClickZoom: false,\n        boxZoom: false,\n        keyboard: false,\n        attributionControl: false,\n      }).setView([lat, lon], 13);\n\n      L.tileLayer(CONFIG.MAP_TILE_LAYERS.osm.url, { maxZoom: 19 }).addTo(map);\n\n      const userColor = getUserColor(storyName);\n      const customIcon = L.divIcon({\n        html: `<div style=\"background-color: ${userColor}; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; box-shadow: 0 2px 5px rgba(0,0,0,0.3);\">\n                <i class=\"fas fa-map-marker-alt\"></i>\n              </div>`,\n        className: '',\n        iconSize: [30, 30],\n        iconAnchor: [15, 30],\n      });\n\n      L.marker([lat, lon], { icon: customIcon })\n        .addTo(map)\n        .bindPopup(\n          `<div class=\"map-popup\">\n            <b>${storyName}</b>\n            <p>${truncateText(storyDescription, 50)}...</p>\n            <a href=\"#/stories/${storyId}\" class=\"popup-link\">View Details</a>\n          </div>`,\n          { className: 'custom-popup', closeButton: false }\n        )\n        .openPopup();\n\n      map.on('click', () => {\n        window.location.hash = `#/stories/${storyId}`;\n      });\n\n      mapElement.addEventListener('keydown', (event) => {\n        if (event.key === 'Enter' || event.key === ' ') {\n          window.location.hash = `#/stories/${storyId}`;\n        }\n      });\n    } catch (error) {\n      // Silent fail for map\n    }\n  }\n\n  connectedCallback() {\n    try {\n      if (\n        'IntersectionObserver' in window &&\n        window.matchMedia('(prefers-reduced-motion: no-preference)').matches\n      ) {\n        const observer = new IntersectionObserver(\n          (entries) => {\n            entries.forEach((entry) => {\n              if (entry.isIntersecting) {\n                this.classList.add('visible');\n                observer.unobserve(this);\n              }\n            });\n          },\n          { threshold: 0.2 }\n        );\n        observer.observe(this);\n      } else {\n        this.classList.add('visible');\n      }\n    } catch {\n      this.classList.add('visible');\n    }\n  }\n}\n\ncustomElements.define('app-card', AppCard);\n\n// Helper functions\nfunction getInitials(name) {\n  if (!name || typeof name !== 'string') return 'U';\n  return name\n    .split(' ')\n    .map((part) => part.charAt(0))\n    .join('')\n    .toUpperCase()\n    .substring(0, 2);\n}\n\nfunction getUserColor(name) {\n  const colors = [\n    '#4361ee', '#3f37c9', '#4895ef', '#4cc9f0', '#f72585',\n    '#7209b7', '#3a0ca3', '#f8961e', '#fb5607', '#80b918',\n  ];\n  if (!name || typeof name !== 'string') return colors[0];\n  const hash = name.split('').reduce((acc, char) => char.charCodeAt(0) + ((acc << 5) - acc), 0);\n  return colors[Math.abs(hash) % colors.length];\n}\n","class AppLoader extends HTMLElement {\n  constructor() {\n    super();\n    this.message = 'Loading...';\n  }\n\n  static get observedAttributes() {\n    return ['message'];\n  }\n\n  attributeChangedCallback(name, oldValue, newValue) {\n    if (name === 'message' && oldValue !== newValue) {\n      this.message = newValue;\n      this.renderMessage();\n    }\n  }\n\n  connectedCallback() {\n    this.render();\n    this.hide();\n  }\n\n  show(message = '') {\n    if (message) {\n      this.message = message;\n      this.renderMessage();\n    }\n    this.style.display = 'flex';\n  }\n\n  hide() {\n    this.style.display = 'none';\n  }\n\n  render() {\n    this.innerHTML = `\n      <div class=\"loading-spinner\" aria-live=\"polite\" aria-busy=\"true\">\n        <div class=\"spinner\"></div>\n        <p class=\"loading-message\">${this.message}</p>\n      </div>\n    `;\n  }\n\n  renderMessage() {\n    const messageElement = this.querySelector('.loading-message');\n    if (messageElement) {\n      messageElement.textContent = this.message;\n    }\n  }\n}\n\ncustomElements.define('app-loader', AppLoader);\n","class AppFooter extends HTMLElement {\n  connectedCallback() {\n    this.render();\n    this.setupEventListeners();\n  }\n\n  render() {\n    const currentYear = new Date().getFullYear();\n    this.innerHTML = `\n      <footer class=\"app-footer\">\n        <div class=\"container footer-content\">\n          <div class=\"social-links\">\n            <a href=\"https://github.com/NaufalArsyaputraPradana/\" aria-label=\"GitHub\" target=\"_blank\" rel=\"noopener noreferrer\">\n              <i class=\"fab fa-github\"></i>\n            </a>\n            <a href=\"https://www.linkedin.com/in/naufalarsyaputrapradana/\" aria-label=\"LinkedIn\" target=\"_blank\" rel=\"noopener noreferrer\">\n              <i class=\"fab fa-linkedin\"></i>\n            </a>\n            <a href=\"https://www.instagram.com/arsya.pradana_/\" aria-label=\"Instagram\" target=\"_blank\" rel=\"noopener noreferrer\">\n              <i class=\"fab fa-instagram\"></i>\n            </a>\n          </div>\n          <p>&copy; ${currentYear} Dicoding Story. All rights reserved.</p>\n          <p class=\"copyright\">\n            Made with <i class=\"fas fa-code\" style=\"color: var(--danger)\"></i> by Naufal Arsyaputra Pradana for Dicoding Submission\n          </p>\n        </div>\n      </footer>\n    `;\n  }\n\n  setupEventListeners() {\n    const yearElement = this.querySelector('p:first-of-type');\n    if (yearElement) {\n      yearElement.addEventListener('click', () => {\n        window.scrollTo({ top: 0, behavior: 'smooth' });\n      });\n    }\n  }\n}\n\ncustomElements.define('app-footer', AppFooter);\n","class AppSidebar extends HTMLElement {\n  constructor() {\n    super();\n    this._isInitialized = false;\n    this._isLoggedIn = false;\n    this._userData = null;\n    this._checkLoginStatus();\n  }\n\n  connectedCallback() {\n    this._render();\n    this._isInitialized = true;\n    this._bindEvents();\n    window.addEventListener('hashchange', () => this._render());\n    window.addEventListener('user-login-state-changed', (event) => {\n      this._isLoggedIn = event.detail.isLoggedIn;\n      this._userData = event.detail.userData;\n      this._render();\n    });\n  }\n\n  disconnectedCallback() {\n    const toggleButton = this.querySelector('#sidebar-toggle');\n    if (toggleButton) toggleButton.removeEventListener('click', this._toggleSidebar);\n    window.removeEventListener('hashchange', this._render);\n    window.removeEventListener('user-login-state-changed', this._render);\n  }\n\n  _checkLoginStatus() {\n    try {\n      const token = localStorage.getItem('token');\n      const userData = localStorage.getItem('user');\n      if (token && userData) {\n        try {\n          this._isLoggedIn = true;\n          this._userData = JSON.parse(userData);\n        } catch {\n          localStorage.removeItem('user');\n          this._isLoggedIn = !!token;\n          this._userData = null;\n        }\n      } else {\n        this._isLoggedIn = false;\n        this._userData = null;\n      }\n    } catch {\n      this._isLoggedIn = false;\n      this._userData = null;\n    }\n  }\n\n  _render() {\n    this.innerHTML = `\n      <div class=\"sidebar-container\">\n        <div id=\"sidebar\" class=\"sidebar position-fixed\">\n          <div class=\"sidebar-header\">\n            <img src=\"./images/logo.png\" alt=\"Dicoding Story Logo\" class=\"sidebar-logo\">\n            <h2 class=\"sidebar-title\">Dicoding Story</h2>\n            <button id=\"sidebar-close\" class=\"sidebar-close\" aria-label=\"Close sidebar\">\n              <i class=\"fas fa-times\" aria-hidden=\"true\"></i>\n            </button>\n          </div>\n          <div class=\"sidebar-content\">\n            ${this._renderUserSection()}\n            <nav class=\"sidebar-nav\">\n              <ul>\n                <li>\n                  <a href=\"#/\" class=\"sidebar-link ${this._isActiveRoute('#/') ? 'active' : ''}\">\n                    <i class=\"fas fa-home\" aria-hidden=\"true\"></i>\n                    <span>Home</span>\n                  </a>\n                </li>\n                ${\n                  this._isLoggedIn\n                    ? `\n                <li>\n                  <a href=\"#/stories/add\" class=\"sidebar-link ${this._isActiveRoute('#/stories/add') ? 'active' : ''}\">\n                    <i class=\"fas fa-plus-circle\" aria-hidden=\"true\"></i>\n                    <span>Add Story</span>\n                  </a>\n                </li>\n                `\n                    : ''\n                }\n                <li>\n                  <a href=\"#/about\" class=\"sidebar-link ${this._isActiveRoute('#/about') ? 'active' : ''}\">\n                    <i class=\"fas fa-info-circle\" aria-hidden=\"true\"></i>\n                    <span>About</span>\n                  </a>\n                </li>\n                <li>\n                  <a href=\"#/saved\" class=\"sidebar-link ${this._isActiveRoute('#/saved') ? 'active' : ''}\" id=\"sidebar-saved-link\">\n                    <i class=\"fas fa-database\" aria-hidden=\"true\"></i>\n                    <span>Saved Stories</span>\n                  </a>\n                </li>\n              </ul>\n            </nav>\n          </div>\n          <div class=\"sidebar-footer\">\n            ${\n              this._isLoggedIn\n                ? `\n              <button id=\"logout-button\" class=\"sidebar-logout-button\">\n                <i class=\"fas fa-sign-out-alt\" aria-hidden=\"true\"></i>\n                <span>Log Out</span>\n              </button>\n            `\n                : `\n              <div class=\"sidebar-auth-buttons\">\n                <a href=\"#/login\" class=\"sidebar-auth-button login\">\n                  <i class=\"fas fa-sign-in-alt\" aria-hidden=\"true\"></i>\n                  <span>Login</span>\n                </a>\n                <a href=\"#/register\" class=\"sidebar-auth-button register\">\n                  <i class=\"fas fa-user-plus\" aria-hidden=\"true\"></i>\n                  <span>Register</span>\n                </a>\n              </div>\n            `\n            }\n          </div>\n        </div>\n        <div id=\"sidebar-overlay\" class=\"sidebar-overlay\"></div>\n      </div>\n    `;\n  }\n\n  _renderUserSection() {\n    if (!this._isLoggedIn || !this._userData) {\n      return `\n        <div class=\"sidebar-guest\">\n          <i class=\"fas fa-user-circle sidebar-guest-icon\" aria-hidden=\"true\"></i>\n          <p>Welcome, Guest!</p>\n          <small>Login to share your story</small>\n        </div>\n      `;\n    }\n    const userInitials = this._getInitials(this._userData.name);\n    const avatarColor = this._getAvatarColor(this._userData.name);\n    return `\n      <div class=\"sidebar-user\">\n        <div class=\"sidebar-user-avatar\" style=\"background-color: ${avatarColor}\">\n          ${\n            this._userData.photoUrl\n              ? `<img src=\"${this._userData.photoUrl}\" alt=\"${this._userData.name}'s avatar\">`\n              : `<span class=\"avatar-initials\">${userInitials}</span>`\n          }\n        </div>\n        <div class=\"sidebar-user-info\">\n          <h3 class=\"sidebar-user-name\">${this._userData.name}</h3>\n          <p class=\"sidebar-user-email\">${this._userData.email}</p>\n        </div>\n      </div>\n    `;\n  }\n\n  _getInitials(name) {\n    if (!name || typeof name !== 'string') return '?';\n    return name\n      .split(' ')\n      .map((part) => part.charAt(0))\n      .join('')\n      .toUpperCase()\n      .substring(0, 2);\n  }\n\n  _getAvatarColor(name) {\n    if (!name) return '#4361ee';\n    const colors = [\n      '#4361ee', '#3a0ca3', '#f72585', '#4cc9f0', '#4895ef',\n      '#560bad', '#f8961e', '#fb5607', '#80b918',\n    ];\n    let hash = 0;\n    for (let i = 0; i < name.length; i++) {\n      hash = name.charCodeAt(i) + ((hash << 5) - hash);\n    }\n    return colors[Math.abs(hash) % colors.length];\n  }\n\n  _bindEvents() {\n    const toggleButton = this.querySelector('#sidebar-toggle');\n    const sidebar = this.querySelector('#sidebar');\n    const overlay = this.querySelector('#sidebar-overlay');\n    const closeButton = this.querySelector('#sidebar-close');\n\n    if (toggleButton) toggleButton.addEventListener('click', () => this._toggleSidebar());\n    if (closeButton) closeButton.addEventListener('click', () => this._closeSidebar());\n    if (overlay) overlay.addEventListener('click', () => this._closeSidebar());\n\n    const logoutButton = this.querySelector('#logout-button');\n    if (logoutButton) {\n      logoutButton.addEventListener('click', () => {\n        this.dispatchEvent(\n          new CustomEvent('user-logout', { bubbles: true, composed: true })\n        );\n        this._closeSidebar();\n      });\n    }\n\n    const sidebarLinks = this.querySelectorAll('.sidebar-link');\n    sidebarLinks.forEach((link) => {\n      link.addEventListener('click', () => this._closeSidebar());\n    });\n\n    // Fix: Saved Stories link should always go to #/saved, not redirect to login\n    const savedLink = this.querySelector('#sidebar-saved-link');\n    if (savedLink) {\n      savedLink.addEventListener('click', (e) => {\n        e.preventDefault();\n        window.location.hash = '#/saved';\n        this._closeSidebar();\n      });\n    }\n  }\n\n  _toggleSidebar() {\n    const sidebar = this.querySelector('#sidebar');\n    const overlay = this.querySelector('#sidebar-overlay');\n    if (!sidebar || !overlay) return;\n    if (sidebar.classList.contains('open')) {\n      this._closeSidebar();\n    } else {\n      sidebar.classList.add('open');\n      overlay.classList.add('visible');\n      document.body.classList.add('sidebar-open');\n    }\n  }\n\n  _closeSidebar() {\n    const sidebar = this.querySelector('#sidebar');\n    const overlay = this.querySelector('#sidebar-overlay');\n    if (!sidebar || !overlay) return;\n    sidebar.classList.remove('open');\n    overlay.classList.remove('visible');\n    document.body.classList.remove('sidebar-open');\n  }\n\n  _isActiveRoute(route) {\n    const currentRoute = window.location.hash || '#/';\n    if (currentRoute === route) return true;\n    if (route === '#/stories/add' && currentRoute.includes('#/stories/add')) return true;\n    if (route === '#/stories' && currentRoute.includes('#/stories/') && !currentRoute.includes('#/stories/add')) return true;\n    return false;\n  }\n}\n\ncustomElements.define('app-sidebar', AppSidebar);\nexport default AppSidebar;\n","const instanceOfAny = (object, constructors) => constructors.some((c) => object instanceof c);\n\nlet idbProxyableTypes;\nlet cursorAdvanceMethods;\n// This is a function to prevent it throwing up in node environments.\nfunction getIdbProxyableTypes() {\n    return (idbProxyableTypes ||\n        (idbProxyableTypes = [\n            IDBDatabase,\n            IDBObjectStore,\n            IDBIndex,\n            IDBCursor,\n            IDBTransaction,\n        ]));\n}\n// This is a function to prevent it throwing up in node environments.\nfunction getCursorAdvanceMethods() {\n    return (cursorAdvanceMethods ||\n        (cursorAdvanceMethods = [\n            IDBCursor.prototype.advance,\n            IDBCursor.prototype.continue,\n            IDBCursor.prototype.continuePrimaryKey,\n        ]));\n}\nconst transactionDoneMap = new WeakMap();\nconst transformCache = new WeakMap();\nconst reverseTransformCache = new WeakMap();\nfunction promisifyRequest(request) {\n    const promise = new Promise((resolve, reject) => {\n        const unlisten = () => {\n            request.removeEventListener('success', success);\n            request.removeEventListener('error', error);\n        };\n        const success = () => {\n            resolve(wrap(request.result));\n            unlisten();\n        };\n        const error = () => {\n            reject(request.error);\n            unlisten();\n        };\n        request.addEventListener('success', success);\n        request.addEventListener('error', error);\n    });\n    // This mapping exists in reverseTransformCache but doesn't exist in transformCache. This\n    // is because we create many promises from a single IDBRequest.\n    reverseTransformCache.set(promise, request);\n    return promise;\n}\nfunction cacheDonePromiseForTransaction(tx) {\n    // Early bail if we've already created a done promise for this transaction.\n    if (transactionDoneMap.has(tx))\n        return;\n    const done = new Promise((resolve, reject) => {\n        const unlisten = () => {\n            tx.removeEventListener('complete', complete);\n            tx.removeEventListener('error', error);\n            tx.removeEventListener('abort', error);\n        };\n        const complete = () => {\n            resolve();\n            unlisten();\n        };\n        const error = () => {\n            reject(tx.error || new DOMException('AbortError', 'AbortError'));\n            unlisten();\n        };\n        tx.addEventListener('complete', complete);\n        tx.addEventListener('error', error);\n        tx.addEventListener('abort', error);\n    });\n    // Cache it for later retrieval.\n    transactionDoneMap.set(tx, done);\n}\nlet idbProxyTraps = {\n    get(target, prop, receiver) {\n        if (target instanceof IDBTransaction) {\n            // Special handling for transaction.done.\n            if (prop === 'done')\n                return transactionDoneMap.get(target);\n            // Make tx.store return the only store in the transaction, or undefined if there are many.\n            if (prop === 'store') {\n                return receiver.objectStoreNames[1]\n                    ? undefined\n                    : receiver.objectStore(receiver.objectStoreNames[0]);\n            }\n        }\n        // Else transform whatever we get back.\n        return wrap(target[prop]);\n    },\n    set(target, prop, value) {\n        target[prop] = value;\n        return true;\n    },\n    has(target, prop) {\n        if (target instanceof IDBTransaction &&\n            (prop === 'done' || prop === 'store')) {\n            return true;\n        }\n        return prop in target;\n    },\n};\nfunction replaceTraps(callback) {\n    idbProxyTraps = callback(idbProxyTraps);\n}\nfunction wrapFunction(func) {\n    // Due to expected object equality (which is enforced by the caching in `wrap`), we\n    // only create one new func per func.\n    // Cursor methods are special, as the behaviour is a little more different to standard IDB. In\n    // IDB, you advance the cursor and wait for a new 'success' on the IDBRequest that gave you the\n    // cursor. It's kinda like a promise that can resolve with many values. That doesn't make sense\n    // with real promises, so each advance methods returns a new promise for the cursor object, or\n    // undefined if the end of the cursor has been reached.\n    if (getCursorAdvanceMethods().includes(func)) {\n        return function (...args) {\n            // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use\n            // the original object.\n            func.apply(unwrap(this), args);\n            return wrap(this.request);\n        };\n    }\n    return function (...args) {\n        // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use\n        // the original object.\n        return wrap(func.apply(unwrap(this), args));\n    };\n}\nfunction transformCachableValue(value) {\n    if (typeof value === 'function')\n        return wrapFunction(value);\n    // This doesn't return, it just creates a 'done' promise for the transaction,\n    // which is later returned for transaction.done (see idbObjectHandler).\n    if (value instanceof IDBTransaction)\n        cacheDonePromiseForTransaction(value);\n    if (instanceOfAny(value, getIdbProxyableTypes()))\n        return new Proxy(value, idbProxyTraps);\n    // Return the same value back if we're not going to transform it.\n    return value;\n}\nfunction wrap(value) {\n    // We sometimes generate multiple promises from a single IDBRequest (eg when cursoring), because\n    // IDB is weird and a single IDBRequest can yield many responses, so these can't be cached.\n    if (value instanceof IDBRequest)\n        return promisifyRequest(value);\n    // If we've already transformed this value before, reuse the transformed value.\n    // This is faster, but it also provides object equality.\n    if (transformCache.has(value))\n        return transformCache.get(value);\n    const newValue = transformCachableValue(value);\n    // Not all types are transformed.\n    // These may be primitive types, so they can't be WeakMap keys.\n    if (newValue !== value) {\n        transformCache.set(value, newValue);\n        reverseTransformCache.set(newValue, value);\n    }\n    return newValue;\n}\nconst unwrap = (value) => reverseTransformCache.get(value);\n\n/**\n * Open a database.\n *\n * @param name Name of the database.\n * @param version Schema version.\n * @param callbacks Additional callbacks.\n */\nfunction openDB(name, version, { blocked, upgrade, blocking, terminated } = {}) {\n    const request = indexedDB.open(name, version);\n    const openPromise = wrap(request);\n    if (upgrade) {\n        request.addEventListener('upgradeneeded', (event) => {\n            upgrade(wrap(request.result), event.oldVersion, event.newVersion, wrap(request.transaction), event);\n        });\n    }\n    if (blocked) {\n        request.addEventListener('blocked', (event) => blocked(\n        // Casting due to https://github.com/microsoft/TypeScript-DOM-lib-generator/pull/1405\n        event.oldVersion, event.newVersion, event));\n    }\n    openPromise\n        .then((db) => {\n        if (terminated)\n            db.addEventListener('close', () => terminated());\n        if (blocking) {\n            db.addEventListener('versionchange', (event) => blocking(event.oldVersion, event.newVersion, event));\n        }\n    })\n        .catch(() => { });\n    return openPromise;\n}\n/**\n * Delete a database.\n *\n * @param name Name of the database.\n */\nfunction deleteDB(name, { blocked } = {}) {\n    const request = indexedDB.deleteDatabase(name);\n    if (blocked) {\n        request.addEventListener('blocked', (event) => blocked(\n        // Casting due to https://github.com/microsoft/TypeScript-DOM-lib-generator/pull/1405\n        event.oldVersion, event));\n    }\n    return wrap(request).then(() => undefined);\n}\n\nconst readMethods = ['get', 'getKey', 'getAll', 'getAllKeys', 'count'];\nconst writeMethods = ['put', 'add', 'delete', 'clear'];\nconst cachedMethods = new Map();\nfunction getMethod(target, prop) {\n    if (!(target instanceof IDBDatabase &&\n        !(prop in target) &&\n        typeof prop === 'string')) {\n        return;\n    }\n    if (cachedMethods.get(prop))\n        return cachedMethods.get(prop);\n    const targetFuncName = prop.replace(/FromIndex$/, '');\n    const useIndex = prop !== targetFuncName;\n    const isWrite = writeMethods.includes(targetFuncName);\n    if (\n    // Bail if the target doesn't exist on the target. Eg, getAll isn't in Edge.\n    !(targetFuncName in (useIndex ? IDBIndex : IDBObjectStore).prototype) ||\n        !(isWrite || readMethods.includes(targetFuncName))) {\n        return;\n    }\n    const method = async function (storeName, ...args) {\n        // isWrite ? 'readwrite' : undefined gzipps better, but fails in Edge :(\n        const tx = this.transaction(storeName, isWrite ? 'readwrite' : 'readonly');\n        let target = tx.store;\n        if (useIndex)\n            target = target.index(args.shift());\n        // Must reject if op rejects.\n        // If it's a write operation, must reject if tx.done rejects.\n        // Must reject with op rejection first.\n        // Must resolve with op value.\n        // Must handle both promises (no unhandled rejections)\n        return (await Promise.all([\n            target[targetFuncName](...args),\n            isWrite && tx.done,\n        ]))[0];\n    };\n    cachedMethods.set(prop, method);\n    return method;\n}\nreplaceTraps((oldTraps) => ({\n    ...oldTraps,\n    get: (target, prop, receiver) => getMethod(target, prop) || oldTraps.get(target, prop, receiver),\n    has: (target, prop) => !!getMethod(target, prop) || oldTraps.has(target, prop),\n}));\n\nconst advanceMethodProps = ['continue', 'continuePrimaryKey', 'advance'];\nconst methodMap = {};\nconst advanceResults = new WeakMap();\nconst ittrProxiedCursorToOriginalProxy = new WeakMap();\nconst cursorIteratorTraps = {\n    get(target, prop) {\n        if (!advanceMethodProps.includes(prop))\n            return target[prop];\n        let cachedFunc = methodMap[prop];\n        if (!cachedFunc) {\n            cachedFunc = methodMap[prop] = function (...args) {\n                advanceResults.set(this, ittrProxiedCursorToOriginalProxy.get(this)[prop](...args));\n            };\n        }\n        return cachedFunc;\n    },\n};\nasync function* iterate(...args) {\n    // tslint:disable-next-line:no-this-assignment\n    let cursor = this;\n    if (!(cursor instanceof IDBCursor)) {\n        cursor = await cursor.openCursor(...args);\n    }\n    if (!cursor)\n        return;\n    cursor = cursor;\n    const proxiedCursor = new Proxy(cursor, cursorIteratorTraps);\n    ittrProxiedCursorToOriginalProxy.set(proxiedCursor, cursor);\n    // Map this double-proxy back to the original, so other cursor methods work.\n    reverseTransformCache.set(proxiedCursor, unwrap(cursor));\n    while (cursor) {\n        yield proxiedCursor;\n        // If one of the advancing methods was not called, call continue().\n        cursor = await (advanceResults.get(proxiedCursor) || cursor.continue());\n        advanceResults.delete(proxiedCursor);\n    }\n}\nfunction isIteratorProp(target, prop) {\n    return ((prop === Symbol.asyncIterator &&\n        instanceOfAny(target, [IDBIndex, IDBObjectStore, IDBCursor])) ||\n        (prop === 'iterate' && instanceOfAny(target, [IDBIndex, IDBObjectStore])));\n}\nreplaceTraps((oldTraps) => ({\n    ...oldTraps,\n    get(target, prop, receiver) {\n        if (isIteratorProp(target, prop))\n            return iterate;\n        return oldTraps.get(target, prop, receiver);\n    },\n    has(target, prop) {\n        return isIteratorProp(target, prop) || oldTraps.has(target, prop);\n    },\n}));\n\nexport { deleteDB, openDB, unwrap, wrap };\n","import { openDB } from 'idb';\n\nconst DB_NAME = 'dicoding-story-db';\nconst STORE_NAME = 'stories';\nconst FAVORITES_STORE = 'favorites';\n\nasync function getDb() {\n  return openDB(DB_NAME, 1, {\n    upgrade(db) {\n      if (!db.objectStoreNames.contains(STORE_NAME)) {\n        db.createObjectStore(STORE_NAME, { keyPath: 'id' });\n      }\n      if (!db.objectStoreNames.contains(FAVORITES_STORE)) {\n        db.createObjectStore(FAVORITES_STORE, { keyPath: 'id' });\n      }\n    },\n  });\n}\n\n// Stories\nexport async function saveStories(stories) {\n  const db = await getDb();\n  const tx = db.transaction(STORE_NAME, 'readwrite');\n  for (const story of stories) {\n    await tx.store.put(story);\n  }\n  await tx.done;\n}\n\nexport async function getAllStories() {\n  const db = await getDb();\n  return db.getAll(STORE_NAME);\n}\n\nexport async function deleteStory(id) {\n  const db = await getDb();\n  return db.delete(STORE_NAME, id);\n}\n\n// Favorites\nexport async function addToFavorites(story) {\n  const db = await getDb();\n  await db.put(FAVORITES_STORE, story);\n}\n\nexport async function removeFromFavorites(id) {\n  const db = await getDb();\n  await db.delete(FAVORITES_STORE, id);\n}\n\nexport async function getFavorites() {\n  const db = await getDb();\n  return db.getAll(FAVORITES_STORE);\n}\n\nconst IdbHelper = {\n  saveStories,\n  getAllStories,\n  deleteStory,\n  addToFavorites,\n  removeFromFavorites,\n  getFavorites,\n};\n\nexport default IdbHelper;\n","import DicodingStoryApi from '../../data/api';\nimport { saveStories, getAllStories } from '../../idb';\n\nexport default class HomePresenter {\n  #view;\n  #page = 1;\n  #hasMoreData = true;\n  #isLoading = false;\n  #includeLocation = false;\n\n  constructor({ view }) {\n    this.#view = view;\n  }\n\n  async init() {\n    try {\n      this.#view.renderPage();\n      this.#setupEventListeners();\n      await this.#loadInitialStories();\n    } catch (error) {\n      console.error('Error in HomePresenter.init:', error);\n      this.#view.showError('Error initializing page. Please try refreshing.');\n    }\n  }\n\n  #setupEventListeners() {\n    this.#view.setLoadMoreCallback(() => this.#loadMoreStories());\n    this.#view.setLocationFilterCallback((isChecked) => {\n      this.#includeLocation = isChecked;\n      this.#page = 1;\n      this.#hasMoreData = true;\n      this.#loadInitialStories();\n    });\n  }\n\n  async #loadInitialStories() {\n    if (this.#isLoading) return;\n    this.#isLoading = true;\n    this.#page = 1;\n\n    try {\n      this.#view.clearStories();\n      this.#view.showLoading();\n\n      const token = localStorage.getItem('token');\n      if (!token) {\n        this.#view.showLoginRequired();\n        return;\n      }\n\n      const response = await DicodingStoryApi.getAllStories({\n        token,\n        page: this.#page,\n        location: this.#includeLocation ? 1 : 0,\n      });\n\n      if (response.error) {\n        this.#view.showError(response.message || 'Gagal memuat cerita');\n        return;\n      }\n\n      if (!response || typeof response !== 'object') {\n        this.#view.showError('Format respons server tidak valid');\n        return;\n      }\n\n      const stories = response.listStory || [];\n      const size = response.size || 10;\n\n      if (!Array.isArray(stories)) {\n        this.#view.showError('Format data cerita tidak valid');\n        return;\n      }\n\n      if (stories.length === 0) {\n        this.#view.showEmptyState();\n        this.#hasMoreData = false;\n      } else {\n        await saveStories(stories);\n        this.#view.renderStories(stories);\n        this.#hasMoreData = stories.length === size;\n        this.#view.updateLoadMoreButton(this.#hasMoreData);\n      }\n    } catch (error) {\n      // Try to load from cache if online fetch fails\n      const cachedStories = await getAllStories();\n      if (cachedStories && cachedStories.length > 0) {\n        this.#view.renderStories(cachedStories);\n        this.#view.showOfflineMessage();\n      } else {\n        this.#view.showError(error.message || 'Gagal memuat cerita');\n      }\n    } finally {\n      this.#isLoading = false;\n      this.#view.hideLoading();\n    }\n  }\n\n  async #loadMoreStories() {\n    if (this.#isLoading || !this.#hasMoreData) return;\n    this.#isLoading = true;\n    this.#page += 1;\n\n    try {\n      this.#view.showLoadingMore();\n\n      const token = localStorage.getItem('token');\n      if (!token) {\n        this.#view.showLoginRequired();\n        return;\n      }\n\n      const response = await DicodingStoryApi.getAllStories({\n        token,\n        page: this.#page,\n        location: this.#includeLocation ? 1 : 0,\n      });\n\n      if (response.error) {\n        this.#view.showError(response.message || 'Gagal memuat cerita tambahan');\n        return;\n      }\n\n      if (!response || typeof response !== 'object') {\n        this.#view.showError('Format respons server tidak valid');\n        return;\n      }\n\n      const stories = response.listStory || [];\n      const size = response.size || 10;\n\n      if (!Array.isArray(stories)) {\n        this.#view.showError('Format data cerita tidak valid');\n        return;\n      }\n\n      if (stories.length > 0) {\n        await saveStories(stories);\n        this.#view.appendStories(stories);\n        this.#hasMoreData = stories.length === size;\n      } else {\n        this.#hasMoreData = false;\n      }\n\n      this.#view.updateLoadMoreButton(this.#hasMoreData);\n    } catch (error) {\n      this.#view.showError(error.message || 'Gagal memuat cerita tambahan');\n    } finally {\n      this.#isLoading = false;\n      this.#view.hideLoadingMore();\n    }\n  }\n}\n","import '../../components/header';\nimport '../../components/card';\nimport '../../components/loader';\nimport '../../components/footer';\nimport '../../components/sidebar';\nimport { debounce } from '../../utils/index';\nimport HomePresenter from './home-presenter';\n\nexport default class HomePage {\n  constructor() {\n    this._presenter = new HomePresenter({ view: this });\n    this._debouncedScroll = debounce(this._handleScroll.bind(this), 200);\n  }\n\n  renderPage() {\n    this._setupInfiniteScroll();\n    this._setupOfflineListener();\n  }\n\n  async render() {\n    return `\n      <app-sidebar></app-sidebar>\n      <app-header></app-header>\n      <main id=\"main-content\" class=\"main-content\" tabindex=\"-1\">\n        <section class=\"container\">\n          <h1 class=\"page-title\">\n            <i class=\"fas fa-book-open\" aria-hidden=\"true\"></i>\n            Latest Stories\n          </h1>\n          <div class=\"filter-container mb-2\">\n            <label for=\"include-location\" class=\"filter-label\">\n              <input type=\"checkbox\" id=\"include-location\" name=\"include-location\">\n              <span class=\"ml-1\">Show stories with location only</span>\n            </label>\n          </div>\n          <div id=\"stories-list\" class=\"stories-list\"></div>\n          <div id=\"loading-more\" class=\"hidden\">\n            <div class=\"spinner\" style=\"width: 30px; height: 30px; margin: 0 auto;\"></div>\n          </div>\n          <button id=\"load-more\" class=\"load-more\" aria-label=\"Load more stories\">\n            <i class=\"fas fa-arrow-down\" aria-hidden=\"true\"></i>\n            Load More\n          </button>\n          <div id=\"empty-state\" class=\"empty-state hidden\">\n            <i class=\"fas fa-inbox fa-3x\"></i>\n            <p>No stories found. Be the first to share your experience!</p>\n          </div>\n        </section>\n      </main>\n      <app-footer></app-footer>\n      <app-loader></app-loader>\n    `;\n  }\n\n  async afterRender() {\n    this._presenter.init();\n  }\n\n  setLoadMoreCallback(callback) {\n    const loadMoreButton = document.querySelector('#load-more');\n    if (loadMoreButton) {\n      loadMoreButton.addEventListener('click', callback);\n    }\n  }\n\n  setLocationFilterCallback(callback) {\n    const locationFilter = document.querySelector('#include-location');\n    if (locationFilter) {\n      locationFilter.addEventListener('change', (event) => {\n        callback(event.target.checked);\n      });\n    }\n  }\n\n  _setupInfiniteScroll() {\n    window.addEventListener('scroll', this._debouncedScroll);\n  }\n\n  _handleScroll() {\n    const loadMoreButton = document.querySelector('#load-more');\n    if (\n      !loadMoreButton ||\n      loadMoreButton.style.display === 'none' ||\n      loadMoreButton.disabled\n    ) {\n      return;\n    }\n    const scrollY = window.scrollY;\n    const visible = document.documentElement.clientHeight;\n    const pageHeight = document.documentElement.scrollHeight;\n    const bottomOfPage = visible + scrollY >= pageHeight - 100;\n    if (bottomOfPage) {\n      loadMoreButton.click();\n    }\n  }\n\n  _setupOfflineListener() {\n    window.addEventListener('online', () => {\n      this._presenter.init();\n    });\n  }\n\n  showLoading() {\n    document.querySelector('app-loader')?.show('Loading stories...');\n  }\n\n  hideLoading() {\n    document.querySelector('app-loader')?.hide();\n  }\n\n  showLoadingMore() {\n    document.getElementById('loading-more')?.classList.remove('hidden');\n  }\n\n  hideLoadingMore() {\n    document.getElementById('loading-more')?.classList.add('hidden');\n  }\n\n  clearStories() {\n    const storiesList = document.getElementById('stories-list');\n    if (storiesList) storiesList.innerHTML = '';\n    document.getElementById('empty-state')?.classList.add('hidden');\n  }\n\n  renderStories(stories) {\n    const storiesList = document.getElementById('stories-list');\n    if (!storiesList) return;\n    if (!stories || !Array.isArray(stories)) {\n      console.error('Invalid stories data:', stories);\n      return;\n    }\n    const validStories = stories.filter((story) => story && typeof story === 'object');\n    validStories.forEach((story, index) => {\n      try {\n        const card = document.createElement('app-card');\n        card.story = story;\n        storiesList.appendChild(card);\n        // Animate card\n        if (window.matchMedia('(prefers-reduced-motion: no-preference)').matches) {\n          card.animate(\n            [\n              { opacity: 0, transform: 'translateY(20px)' },\n              { opacity: 1, transform: 'translateY(0)' },\n            ],\n            {\n              duration: 300,\n              easing: 'ease-out',\n              delay: index * 50,\n            }\n          );\n        }\n      } catch (error) {\n        console.error('Error rendering story card:', error, { story });\n      }\n    });\n  }\n\n  appendStories(stories) {\n    const storiesList = document.getElementById('stories-list');\n    if (!storiesList) return;\n    if (!stories || !Array.isArray(stories)) {\n      console.error('Invalid stories data:', stories);\n      return;\n    }\n    const validStories = stories.filter((story) => story && typeof story === 'object');\n    if (validStories.length === 0) {\n      console.warn('No valid stories to append');\n      return;\n    }\n    validStories.forEach((story, index) => {\n      try {\n        const card = document.createElement('app-card');\n        card.story = story;\n        storiesList.appendChild(card);\n        if (window.matchMedia('(prefers-reduced-motion: no-preference)').matches) {\n          card.animate(\n            [\n              { opacity: 0, transform: 'translateY(20px)' },\n              { opacity: 1, transform: 'translateY(0)' },\n            ],\n            {\n              duration: 300,\n              easing: 'ease-out',\n              delay: index * 50,\n            }\n          );\n        }\n      } catch (error) {\n        console.error('Error appending story card:', error, { story });\n      }\n    });\n  }\n\n  updateLoadMoreButton(hasMore) {\n    const loadMoreButton = document.getElementById('load-more');\n    if (!loadMoreButton) return;\n    if (hasMore) {\n      loadMoreButton.style.display = 'flex';\n      loadMoreButton.disabled = false;\n    } else {\n      loadMoreButton.style.display = 'none';\n      loadMoreButton.disabled = true;\n    }\n  }\n\n  showEmptyState() {\n    document.getElementById('empty-state')?.classList.remove('hidden');\n    const loadMoreButton = document.getElementById('load-more');\n    if (loadMoreButton) loadMoreButton.style.display = 'none';\n  }\n\n  showLoginRequired() {\n    Swal.fire({\n      icon: 'warning',\n      title: 'Login Required',\n      text: 'You need to login to view stories',\n      confirmButtonText: 'Login Now',\n      confirmButtonColor: '#4361ee',\n    }).then((result) => {\n      if (result.isConfirmed) {\n        window.location.hash = '#/login';\n      }\n    });\n  }\n\n  showOfflineMessage() {\n    window.showToast &&\n      window.showToast(\n        'Anda sedang offline. Menampilkan data tersimpan.',\n        'info'\n      );\n  }\n\n  showError(message) {\n    Swal.fire({\n      icon: 'error',\n      title: 'Error',\n      text: message || 'Failed to load stories',\n      confirmButtonColor: '#4361ee',\n    });\n  }\n}\n","import '../../components/header';\nimport '../../components/footer';\nimport '../../components/loader';\nimport '../../components/sidebar';\n\nexport default class AboutPage {\n  async render() {\n    return `\n      <app-sidebar></app-sidebar>\n      <app-header></app-header>\n      <main id=\"main-content\" class=\"main-content\" tabindex=\"-1\">\n        <section class=\"container\">\n          <h1 class=\"page-title\">\n            <i class=\"fas fa-info-circle\"></i>\n            About the App\n          </h1>\n          <div class=\"about-content\">\n            <div class=\"about-card\" id=\"about-app\">\n              <h2><i class=\"fas fa-book-open\"></i> Dicoding Story</h2>\n              <p>\n                Dicoding Story is a platform for sharing programming and technology \n                learning experiences. This app was created as a submission project \n                for Dicoding's \"Menjadi Front-End Web Developer Expert\" class.\n              </p>\n              <p class=\"mt-2\">\n                The application allows users to share their learning journey with others,\n                add location to their stories, and explore stories from other learners.\n              </p>\n            </div>\n            <div class=\"about-card\" id=\"about-features\">\n              <h2><i class=\"fas fa-feather-alt\"></i> Features</h2>\n              <ul class=\"feature-list\">\n                <li><i class=\"fas fa-check-circle\"></i> Share stories with images</li>\n                <li><i class=\"fas fa-check-circle\"></i> Add location to stories with interactive maps</li>\n                <li><i class=\"fas fa-check-circle\"></i> View stories from other users</li>\n                <li><i class=\"fas fa-check-circle\"></i> Responsive design for all devices</li>\n                <li><i class=\"fas fa-check-circle\"></i> Offline capability with cached data</li>\n                <li><i class=\"fas fa-check-circle\"></i> Push notifications for new features</li>\n              </ul>\n            </div>\n            <div class=\"about-card\" id=\"about-tech\">\n              <h2><i class=\"fas fa-code\"></i> Technology Stack</h2>\n              <div class=\"tech-stack\">\n                <div class=\"tech-item\"><i class=\"fab fa-html5\"></i><span>HTML5</span></div>\n                <div class=\"tech-item\"><i class=\"fab fa-css3-alt\"></i><span>CSS3</span></div>\n                <div class=\"tech-item\"><i class=\"fab fa-js\"></i><span>JavaScript</span></div>\n                <div class=\"tech-item\"><i class=\"fas fa-map-marked-alt\"></i><span>Leaflet.js</span></div>\n                <div class=\"tech-item\"><i class=\"fas fa-mobile-alt\"></i><span>PWA</span></div>\n                <div class=\"tech-item\"><i class=\"fas fa-server\"></i><span>REST API</span></div>\n              </div>\n            </div>\n            <div class=\"about-card\" id=\"about-developer\">\n              <h2><i class=\"fas fa-user-tie\"></i> About Developer</h2>\n              <p>\n                This application was developed by <strong>Naufal Arsyaputra Pradana</strong> \n                as part of the submission for Dicoding's Front-End Web Developer Expert class.\n              </p>\n              <div class=\"tech-stack mt-2\">\n                <div class=\"tech-item\">\n                  <a href=\"https://github.com/NaufalArsyaputraPradana/\" target=\"_blank\" rel=\"noopener noreferrer\">\n                    <i class=\"fab fa-github\"></i>\n                    <span>GitHub</span>\n                  </a>\n                </div>\n                <div class=\"tech-item\">\n                  <a href=\"https://www.linkedin.com/in/naufalarsyaputrapradana/\" target=\"_blank\" rel=\"noopener noreferrer\">\n                    <i class=\"fab fa-linkedin\"></i>\n                    <span>LinkedIn</span>\n                  </a>\n                </div>\n                <div class=\"tech-item\">\n                  <a href=\"https://www.instagram.com/arsya.pradana_/\" target=\"_blank\" rel=\"noopener noreferrer\">\n                    <i class=\"fab fa-instagram\"></i>\n                    <span>Instagram</span>\n                  </a>\n                </div>\n              </div>\n            </div>\n          </div>\n        </section>\n      </main>\n      <app-footer></app-footer>\n    `;\n  }\n\n  async afterRender() {\n    // Animate about cards\n    if (window.matchMedia('(prefers-reduced-motion: no-preference)').matches) {\n      const cards = [\n        document.getElementById('about-app'),\n        document.getElementById('about-features'),\n        document.getElementById('about-tech'),\n        document.getElementById('about-developer'),\n      ];\n      cards.forEach((card, index) => {\n        if (card) {\n          card.style.opacity = '0';\n          card.style.transform = 'translateY(20px)';\n          card.style.transition = 'opacity 0.3s, transform 0.3s';\n          setTimeout(() => {\n            card.style.opacity = '1';\n            card.style.transform = 'translateY(0)';\n          }, index * 100 + 300);\n        }\n      });\n    }\n  }\n}\n","import DicodingStoryApi from '../../../data/api';\nimport '../../../components/header';\nimport '../../../components/loader';\nimport '../../../components/footer';\nimport '../../../components/sidebar';\nimport { validateEmail, isOnline } from '../../../utils/index';\n\nexport default class LoginPage {\n  async render() {\n    return `\n      <app-sidebar></app-sidebar>\n      <app-header></app-header>\n      <main id=\"main-content\" class=\"main-content\" tabindex=\"-1\">\n        <section class=\"auth-container\">\n          <h1 class=\"auth-title\">\n            <i class=\"fas fa-sign-in-alt\"></i>\n            Login\n          </h1>\n          <form id=\"login-form\" class=\"auth-form\" novalidate>\n            <div class=\"auth-form-group\">\n              <label for=\"email\">Email</label>\n              <input \n                type=\"email\" \n                id=\"email\" \n                name=\"email\" \n                required\n                placeholder=\"Enter your email\"\n                aria-describedby=\"email-help\"\n                autocomplete=\"username\"\n              >\n              <small id=\"email-help\" class=\"text-muted\">Enter a valid email address</small>\n              <div class=\"error-message\" id=\"email-error\"></div>\n            </div>\n            <div class=\"auth-form-group\">\n              <label for=\"password\">Password</label>\n              <input \n                type=\"password\" \n                id=\"password\" \n                name=\"password\" \n                required \n                minlength=\"8\"\n                placeholder=\"Enter your password\"\n                aria-describedby=\"password-help\"\n                autocomplete=\"current-password\"\n              >\n              <small id=\"password-help\" class=\"text-muted\">Minimum 8 characters</small>\n              <div class=\"error-message\" id=\"password-error\"></div>\n            </div>\n            <button type=\"submit\" class=\"auth-submit-button\">\n              <i class=\"fas fa-sign-in-alt\"></i>\n              Login\n            </button>\n            <div class=\"flex items-center mt-2\">\n              <input type=\"checkbox\" id=\"remember-me\" name=\"remember-me\">\n              <label for=\"remember-me\" class=\"ml-2\">Remember me</label>\n            </div>\n          </form>\n          <div class=\"auth-link\">\n            Don't have an account? <a href=\"#/register\">Register here</a>\n          </div>\n          ${\n            !isOnline()\n              ? `\n            <div class=\"offline-notice mt-2\">\n              <i class=\"fas fa-wifi-slash\"></i> You are currently offline. \n              Login is not available without internet connection.\n            </div>\n          `\n              : ''\n          }\n        </section>\n      </main>\n      <app-footer></app-footer>\n      <app-loader></app-loader>\n    `;\n  }\n\n  async afterRender() {\n    this._setupForm();\n    this._setupInputValidation();\n    this._checkRememberedUser();\n  }\n\n  _setupForm() {\n    const form = document.querySelector('#login-form');\n    if (!form) return;\n\n    form.addEventListener('submit', async (event) => {\n      event.preventDefault();\n\n      if (!this._validateForm()) return;\n      if (!isOnline()) {\n        Swal.fire({\n          icon: 'error',\n          title: 'Offline Mode',\n          text: 'Login is not available without internet connection.',\n          confirmButtonColor: '#4361ee',\n        });\n        return;\n      }\n\n      const email = form.querySelector('#email').value.trim();\n      const password = form.querySelector('#password').value.trim();\n      const rememberMe = form.querySelector('#remember-me').checked;\n\n      const loader = document.querySelector('app-loader');\n      if (loader) loader.show('Authenticating...');\n\n      try {\n        const response = await DicodingStoryApi.login({ email, password });\n\n        localStorage.setItem('token', response.loginResult.token);\n        localStorage.setItem('user', JSON.stringify(response.loginResult.user));\n\n        if (rememberMe) {\n          localStorage.setItem('rememberedEmail', email);\n        } else {\n          localStorage.removeItem('rememberedEmail');\n        }\n\n        await Swal.fire({\n          icon: 'success',\n          title: 'Login successful!',\n          showConfirmButton: false,\n          timer: 1500,\n        });\n\n        window.location.hash = '#/';\n      } catch (error) {\n        console.error('Login failed:', error);\n        Swal.fire({\n          icon: 'error',\n          title: 'Login failed',\n          text: error.message || 'Invalid email or password',\n          confirmButtonColor: '#4361ee',\n        });\n      } finally {\n        if (loader) loader.hide();\n      }\n    });\n  }\n\n  _setupInputValidation() {\n    const emailInput = document.querySelector('#email');\n    const passwordInput = document.querySelector('#password');\n\n    if (emailInput) {\n      emailInput.addEventListener('input', () => {\n        this._validateEmail();\n      });\n    }\n\n    if (passwordInput) {\n      passwordInput.addEventListener('input', () => {\n        this._validatePassword();\n      });\n    }\n  }\n\n  _validateForm() {\n    const isEmailValid = this._validateEmail();\n    const isPasswordValid = this._validatePassword();\n    return isEmailValid && isPasswordValid;\n  }\n\n  _validateEmail() {\n    const emailInput = document.querySelector('#email');\n    const errorElement = document.querySelector('#email-error');\n\n    if (!emailInput || !errorElement) return false;\n\n    const email = emailInput.value.trim();\n\n    if (!email) {\n      errorElement.textContent = 'Email is required';\n      return false;\n    }\n\n    if (!validateEmail(email)) {\n      errorElement.textContent = 'Please enter a valid email address';\n      return false;\n    }\n\n    errorElement.textContent = '';\n    return true;\n  }\n\n  _validatePassword() {\n    const passwordInput = document.querySelector('#password');\n    const errorElement = document.querySelector('#password-error');\n\n    if (!passwordInput || !errorElement) return false;\n\n    const password = passwordInput.value.trim();\n\n    if (!password) {\n      errorElement.textContent = 'Password is required';\n      return false;\n    }\n\n    if (password.length < 8) {\n      errorElement.textContent = 'Password must be at least 8 characters';\n      return false;\n    }\n\n    errorElement.textContent = '';\n    return true;\n  }\n\n  _checkRememberedUser() {\n    const rememberedEmail = localStorage.getItem('rememberedEmail');\n    const emailInput = document.querySelector('#email');\n    const rememberCheckbox = document.querySelector('#remember-me');\n\n    if (rememberedEmail && emailInput) {\n      emailInput.value = rememberedEmail;\n      if (rememberCheckbox) {\n        rememberCheckbox.checked = true;\n      }\n      document.querySelector('#password').focus();\n    }\n  }\n}\n","import DicodingStoryApi from '../../../data/api';\nimport '../../../components/header';\nimport '../../../components/loader';\nimport '../../../components/footer';\nimport '../../../components/sidebar';\nimport { validateEmail, isOnline } from '../../../utils/index';\n\nexport default class RegisterPage {\n  async render() {\n    return `\n      <app-sidebar></app-sidebar>\n      <app-header></app-header>\n      <main id=\"main-content\" class=\"main-content\" tabindex=\"-1\">\n        <section class=\"auth-container\">\n          <h1 class=\"auth-title\">\n            <i class=\"fas fa-user-plus\"></i>\n            Register\n          </h1>\n          <form id=\"register-form\" class=\"auth-form\" novalidate>\n            <div class=\"auth-form-group\">\n              <label for=\"name\">Full Name</label>\n              <input \n                type=\"text\" \n                id=\"name\" \n                name=\"name\" \n                required\n                minlength=\"3\"\n                placeholder=\"Enter your full name\"\n                aria-describedby=\"name-help\"\n                autocomplete=\"name\"\n              >\n              <small id=\"name-help\" class=\"text-muted\">Minimum 3 characters</small>\n              <div class=\"error-message\" id=\"name-error\"></div>\n            </div>\n            <div class=\"auth-form-group\">\n              <label for=\"email\">Email</label>\n              <input \n                type=\"email\" \n                id=\"email\" \n                name=\"email\" \n                required\n                placeholder=\"Enter your email\"\n                aria-describedby=\"email-help\"\n                autocomplete=\"username\"\n              >\n              <small id=\"email-help\" class=\"text-muted\">Enter a valid email address</small>\n              <div class=\"error-message\" id=\"email-error\"></div>\n            </div>\n            <div class=\"auth-form-group\">\n              <label for=\"password\">Password</label>\n              <input \n                type=\"password\" \n                id=\"password\" \n                name=\"password\" \n                required \n                minlength=\"8\"\n                placeholder=\"Enter password (min 8 characters)\"\n                aria-describedby=\"password-help\"\n                autocomplete=\"new-password\"\n              >\n              <small id=\"password-help\" class=\"text-muted\">Minimum 8 characters</small>\n              <div class=\"error-message\" id=\"password-error\"></div>\n            </div>\n            <button type=\"submit\" class=\"auth-submit-button\">\n              <i class=\"fas fa-user-plus\"></i>\n              Register\n            </button>\n          </form>\n          <div class=\"auth-link\">\n            Already have an account? <a href=\"#/login\">Login here</a>\n          </div>\n          ${\n            !isOnline()\n              ? `\n            <div class=\"offline-notice mt-2\">\n              <i class=\"fas fa-wifi-slash\"></i> You are currently offline. \n              Registration is not available without internet connection.\n            </div>\n          `\n              : ''\n          }\n        </section>\n      </main>\n      <app-footer></app-footer>\n      <app-loader></app-loader>\n    `;\n  }\n\n  async afterRender() {\n    this._setupForm();\n    this._setupInputValidation();\n  }\n\n  _setupForm() {\n    const form = document.querySelector('#register-form');\n    if (!form) return;\n\n    form.addEventListener('submit', async (event) => {\n      event.preventDefault();\n\n      if (!this._validateForm()) return;\n      if (!isOnline()) {\n        Swal.fire({\n          icon: 'error',\n          title: 'Offline Mode',\n          text: 'Registration is not available without internet connection.',\n          confirmButtonColor: '#4361ee',\n        });\n        return;\n      }\n\n      const name = form.querySelector('#name').value.trim();\n      const email = form.querySelector('#email').value.trim();\n      const password = form.querySelector('#password').value.trim();\n\n      const loader = document.querySelector('app-loader');\n      if (loader) loader.show('Creating account...');\n\n      try {\n        await DicodingStoryApi.register({ name, email, password });\n\n        await Swal.fire({\n          icon: 'success',\n          title: 'Registration successful!',\n          text: 'Please login with your new account',\n          confirmButtonColor: '#4361ee',\n        });\n\n        window.location.hash = '#/login';\n        form.reset();\n      } catch (error) {\n        Swal.fire({\n          icon: 'error',\n          title: 'Registration failed',\n          text: error.message || 'Email may already be registered',\n          confirmButtonColor: '#4361ee',\n        });\n      } finally {\n        if (loader) loader.hide();\n      }\n    });\n  }\n\n  _setupInputValidation() {\n    const nameInput = document.querySelector('#name');\n    const emailInput = document.querySelector('#email');\n    const passwordInput = document.querySelector('#password');\n\n    if (nameInput) {\n      nameInput.addEventListener('input', () => {\n        this._validateName();\n      });\n    }\n\n    if (emailInput) {\n      emailInput.addEventListener('input', () => {\n        this._validateEmail();\n      });\n    }\n\n    if (passwordInput) {\n      passwordInput.addEventListener('input', () => {\n        this._validatePassword();\n      });\n    }\n  }\n\n  _validateForm() {\n    const isNameValid = this._validateName();\n    const isEmailValid = this._validateEmail();\n    const isPasswordValid = this._validatePassword();\n    return isNameValid && isEmailValid && isPasswordValid;\n  }\n\n  _validateName() {\n    const nameInput = document.querySelector('#name');\n    const errorElement = document.querySelector('#name-error');\n\n    if (!nameInput || !errorElement) return false;\n\n    const name = nameInput.value.trim();\n\n    if (!name) {\n      errorElement.textContent = 'Name is required';\n      return false;\n    }\n\n    if (name.length < 3) {\n      errorElement.textContent = 'Name must be at least 3 characters';\n      return false;\n    }\n\n    errorElement.textContent = '';\n    return true;\n  }\n\n  _validateEmail() {\n    const emailInput = document.querySelector('#email');\n    const errorElement = document.querySelector('#email-error');\n\n    if (!emailInput || !errorElement) return false;\n\n    const email = emailInput.value.trim();\n\n    if (!email) {\n      errorElement.textContent = 'Email is required';\n      return false;\n    }\n\n    if (!validateEmail(email)) {\n      errorElement.textContent = 'Please enter a valid email address';\n      return false;\n    }\n\n    errorElement.textContent = '';\n    return true;\n  }\n\n  _validatePassword() {\n    const passwordInput = document.querySelector('#password');\n    const errorElement = document.querySelector('#password-error');\n\n    if (!passwordInput || !errorElement) return false;\n\n    const password = passwordInput.value.trim();\n\n    if (!password) {\n      errorElement.textContent = 'Password is required';\n      return false;\n    }\n\n    if (password.length < 8) {\n      errorElement.textContent = 'Password must be at least 8 characters';\n      return false;\n    }\n\n    errorElement.textContent = '';\n    return true;\n  }\n}\n","import DicodingStoryApi from '../../data/api';\nimport { isOnline } from '../../utils/index';\n\nclass StoryDetailPresenter {\n  constructor({ view, id }) {\n    this._view = view;\n    this._id = id;\n    this._map = null;\n    this._story = null;\n    this._mapInitialized = false;\n  }\n\n  async init() {\n    this._view.renderPage();\n    await this._loadStoryDetail();\n    this._setupOnlineListener();\n    this._setupActions();\n  }\n\n  async _loadStoryDetail() {\n    try {\n      this._view.showLoading();\n      const token = localStorage.getItem('token');\n      if (!token) {\n        this._view.showLoginRequired();\n        return;\n      }\n      const cachedStory = this._getCachedStory();\n      try {\n        const response = await DicodingStoryApi.getStoryDetail({\n          token,\n          id: this._id,\n        });\n        if (response.error) throw new Error(response.message || 'Gagal memuat cerita');\n        this._story = response.story;\n        this._cacheStory(response.story);\n        this._view.renderStoryDetail(response.story);\n        this._view.hideOfflineMessage();\n        if (this._story.lat && this._story.lon) {\n          this._initMapWithDelay(300);\n        }\n      } catch (apiError) {\n        if (cachedStory) {\n          this._story = cachedStory;\n          this._view.renderStoryDetail(cachedStory);\n          this._view.showOfflineMessage();\n          if (cachedStory.lat && cachedStory.lon && !this._mapInitialized) {\n            this._initMapWithDelay(300);\n          }\n        } else {\n          this._view.showError(apiError.message);\n        }\n      }\n    } catch (error) {\n      const cachedStory = this._getCachedStory();\n      if (cachedStory) {\n        this._story = cachedStory;\n        this._view.renderStoryDetail(cachedStory);\n        this._view.showOfflineMessage();\n        if (cachedStory.lat && cachedStory.lon && !this._mapInitialized) {\n          this._initMapWithDelay(300);\n        }\n      } else {\n        this._view.showError('Terjadi kesalahan. Silakan coba lagi.');\n      }\n    } finally {\n      this._view.hideLoading();\n    }\n  }\n\n  _setupOnlineListener() {\n    window.addEventListener('online', () => {\n      if (!this._story) {\n        this._loadStoryDetail();\n      } else {\n        this._view.hideOfflineMessage();\n      }\n    });\n    window.addEventListener('offline', () => {\n      if (this._story) {\n        this._view.showOfflineMessage();\n      }\n    });\n  }\n\n  _initMapWithDelay(delay = 100) {\n    if (!window.L) {\n      console.error('Leaflet library not available');\n      return;\n    }\n    setTimeout(() => {\n      this._initMap();\n    }, delay);\n  }\n\n  _initMap() {\n    if (this._mapInitialized) return;\n    if (!this._story) return;\n    const lat = parseFloat(this._story.lat);\n    const lon = parseFloat(this._story.lon);\n    if (isNaN(lat) || isNaN(lon)) return;\n    const mapContainer = this._view.getMapContainer();\n    if (!mapContainer) return;\n    try {\n      this._map = L.map(mapContainer).setView([lat, lon], 13);\n      const baseMaps = this._createBaseMaps();\n      baseMaps['Street'].addTo(this._map);\n      L.control.layers(baseMaps, {}, { position: 'topright' }).addTo(this._map);\n      this._addStoryMarker();\n      this._addLocateControl();\n      this._updateMapSize();\n      this._mapInitialized = true;\n    } catch (error) {\n      this._view.showMapError();\n    }\n  }\n\n  _createBaseMaps() {\n    const baseMaps = {};\n    baseMaps['Street'] = L.tileLayer(\n      'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\n      {\n        attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\n        maxZoom: 19,\n      }\n    );\n    baseMaps['Satellite'] = L.tileLayer(\n      'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}',\n      {\n        attribution: 'Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community',\n        maxZoom: 19,\n      }\n    );\n    baseMaps['Dark'] = L.tileLayer(\n      'https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png',\n      {\n        attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors &copy; <a href=\"https://carto.com/attributions\">CARTO</a>',\n        maxZoom: 19,\n      }\n    );\n    baseMaps['Topographic'] = L.tileLayer(\n      'https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png',\n      {\n        attribution: 'Map data: &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors, <a href=\"http://viewfinderpanoramas.org\">SRTM</a> | Map style: &copy; <a href=\"https://opentopomap.org\">OpenTopoMap</a> (<a href=\"https://creativecommons.org/licenses/by-sa/3.0/\">CC-BY-SA</a>)',\n        maxZoom: 17,\n      }\n    );\n    return baseMaps;\n  }\n\n  _addStoryMarker() {\n    if (!this._map || !this._story) return;\n    const lat = parseFloat(this._story.lat);\n    const lon = parseFloat(this._story.lon);\n    if (isNaN(lat) || isNaN(lon)) return;\n    const name = this._story.name || 'Untitled Story';\n    const description = this._story.description || '';\n    const popup = `\n      <div class=\"custom-popup\">\n        <h3>${name}</h3>\n        <p>${description.substring(0, 100)}${description.length > 100 ? '...' : ''}</p>\n      </div>\n    `;\n    L.marker([lat, lon]).addTo(this._map).bindPopup(popup).openPopup();\n  }\n\n  _addLocateControl() {\n    if (!this._map) return;\n    L.control\n      .locate({\n        position: 'topright',\n        strings: { title: 'Show my location' },\n        locateOptions: { enableHighAccuracy: true },\n      })\n      .addTo(this._map);\n  }\n\n  _updateMapSize() {\n    if (!this._map) return;\n    setTimeout(() => {\n      this._map.invalidateSize();\n    }, 300);\n    window.addEventListener('resize', () => {\n      if (this._map) this._map.invalidateSize();\n    });\n  }\n\n  _cacheStory(story) {\n    try {\n      const cacheData = { ...story, cachedAt: new Date().toISOString() };\n      localStorage.setItem(`story_${story.id}`, JSON.stringify(cacheData));\n      const cachedStories = JSON.parse(localStorage.getItem('cachedStories') || '[]');\n      const updatedCache = cachedStories.map((item) => item.id === story.id ? cacheData : item);\n      if (!cachedStories.some((item) => item.id === story.id)) {\n        updatedCache.push(cacheData);\n      }\n      const limitedCache = updatedCache.slice(0, 50);\n      localStorage.setItem('cachedStories', JSON.stringify(limitedCache));\n    } catch (error) {\n      // silent\n    }\n  }\n\n  _getCachedStory() {\n    try {\n      const cachedStoryJson = localStorage.getItem(`story_${this._id}`);\n      if (cachedStoryJson) {\n        try {\n          const parsedStory = JSON.parse(cachedStoryJson);\n          if (!parsedStory || typeof parsedStory !== 'object') return null;\n          parsedStory.name = parsedStory.name || 'Unknown User';\n          parsedStory.description = parsedStory.description || '';\n          parsedStory.photoUrl = parsedStory.photoUrl || './images/placeholder.jpg';\n          parsedStory.createdAt = parsedStory.createdAt || new Date().toISOString();\n          return parsedStory;\n        } catch {\n          localStorage.removeItem(`story_${this._id}`);\n          return null;\n        }\n      }\n      const cachedStoriesJson = localStorage.getItem('cachedStories');\n      if (!cachedStoriesJson) return null;\n      try {\n        const cachedStories = JSON.parse(cachedStoriesJson);\n        if (!Array.isArray(cachedStories)) return null;\n        const foundStory = cachedStories.find((story) => story && story.id === this._id);\n        if (!foundStory) return null;\n        foundStory.name = foundStory.name || 'Unknown User';\n        foundStory.description = foundStory.description || '';\n        foundStory.photoUrl = foundStory.photoUrl || './images/placeholder.jpg';\n        foundStory.createdAt = foundStory.createdAt || new Date().toISOString();\n        return foundStory;\n      } catch {\n        return null;\n      }\n    } catch {\n      return null;\n    }\n  }\n\n  _setupActions() {\n    if (navigator.share) {\n      this._view.showShareButton();\n      this._view.setShareButtonCallback(() => this._shareStory());\n    }\n    this._view.setFavoriteButtonCallback((isFavorite) => {\n      this._toggleFavorite(isFavorite);\n    });\n  }\n\n  async _shareStory() {\n    if (!this._story) return;\n    try {\n      const shareData = {\n        title: `Cerita dari ${this._story.name}`,\n        text: this._story.description,\n        url: window.location.href,\n      };\n      await navigator.share(shareData);\n      window.showToast && window.showToast('Cerita berhasil dibagikan!', 'success');\n    } catch (error) {\n      if (error.name !== 'AbortError') {\n        window.showToast && window.showToast('Gagal membagikan cerita', 'error');\n      }\n    }\n  }\n\n  _toggleFavorite(isFavorite) {\n    if (!this._story) return;\n    try {\n      const favoritesJson = localStorage.getItem('favoriteStories');\n      let favorites = favoritesJson ? JSON.parse(favoritesJson) : [];\n      if (isFavorite) {\n        if (!favorites.includes(this._story.id)) {\n          favorites.push(this._story.id);\n          window.showToast && window.showToast('Ditambahkan ke favorit!', 'success');\n        }\n      } else {\n        favorites = favorites.filter((id) => id !== this._story.id);\n        window.showToast && window.showToast('Dihapus dari favorit', 'info');\n      }\n      localStorage.setItem('favoriteStories', JSON.stringify(favorites));\n    } catch (error) {\n      // silent\n    }\n  }\n\n  async saveCurrentStoryToOffline() {\n    if (this._story) {\n      await saveStories([this._story]);\n      window.showToast && window.showToast('Cerita disimpan untuk offline', 'success');\n    }\n  }\n}\n\nexport default StoryDetailPresenter;\n","import '../../components/header';\nimport '../../components/loader';\nimport '../../components/footer';\nimport '../../components/sidebar';\nimport { showFormattedDate } from '../../utils/index';\nimport StoryDetailPresenter from './story-detail-presenter';\nimport IdbHelper from '../../idb';\n\nexport default class StoryDetailPage {\n  constructor() {\n    const { id } = this._getUrlParams();\n    this._id = id;\n    this._presenter = new StoryDetailPresenter({\n      view: this,\n      id: this._id,\n    });\n    this._mapContainer = null;\n    this._favoriteCallback = null;\n    this._story = null;\n  }\n\n  renderPage() {\n    if (!this._id) {\n      this.showInvalidIdError();\n      return;\n    }\n  }\n\n  async render() {\n    return `\n      <app-sidebar></app-sidebar>\n      <app-header></app-header>\n      <main id=\"main-content\" class=\"main-content\" tabindex=\"-1\">\n        <section class=\"container\">\n          <div id=\"story-content\">\n            <div class=\"loading-placeholder\">\n              <div class=\"ph-item\">\n                <div class=\"ph-col-12\">\n                  <div class=\"ph-picture\"></div>\n                  <div class=\"ph-row\">\n                    <div class=\"ph-col-4\"></div>\n                    <div class=\"ph-col-8 empty\"></div>\n                    <div class=\"ph-col-6\"></div>\n                    <div class=\"ph-col-6 empty\"></div>\n                    <div class=\"ph-col-12\"></div>\n                    <div class=\"ph-col-12\"></div>\n                    <div class=\"ph-col-12\"></div>\n                    <div class=\"ph-col-8\"></div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div id=\"offline-notice\" class=\"offline-notice mt-2 hidden\">\n            <i class=\"fas fa-wifi-slash\"></i> You are currently offline. Some features may be limited.\n          </div>\n        </section>\n      </main>\n      <app-footer></app-footer>\n      <app-loader></app-loader>\n    `;\n  }\n\n  async afterRender() {\n    this._presenter.init();\n\n    // Save to favorites (for fallback, if presenter doesn't handle)\n    const saveBtn = document.getElementById('save-story-button');\n    if (saveBtn && this._story) {\n      saveBtn.addEventListener('click', async () => {\n        await IdbHelper.addToFavorites(this._story);\n        window.showToast &&\n          window.showToast('Cerita disimpan ke halaman Favorit!', 'success');\n      });\n    }\n  }\n\n  renderStoryDetail(story) {\n    this._story = story;\n    const storyContent = document.querySelector('#story-content');\n    if (!story || !storyContent) return;\n\n    const storyName = story.name || 'Unknown User';\n    const storyDescription = story.description || 'No description provided';\n    const storyPhoto = story.photoUrl || './images/placeholder.jpg';\n    const storyCreatedAt = story.createdAt || new Date().toISOString();\n\n    const formattedDate = showFormattedDate(storyCreatedAt, 'id-ID', {\n      weekday: 'long',\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit',\n    });\n\n    const userColor = this._getUserColor(storyName);\n    const storyTitleId = `story-title-${story.id}`;\n    const storyDescId = `story-desc-${story.id}`;\n    const isFavorite = this._isInFavorites(story.id);\n\n    storyContent.innerHTML = `\n      <article class=\"story-detail-item\" id=\"story-article\" aria-labelledby=\"${storyTitleId}\">\n        <div class=\"story-image-wrapper\">\n          <img \n            class=\"story-detail-image\" \n            src=\"${storyPhoto}\" \n            alt=\"Photo shared by ${storyName}\" \n            loading=\"lazy\"\n            onerror=\"this.src='./images/placeholder.jpg'\"\n          >\n          <div class=\"story-image-overlay\">\n            <div class=\"story-image-badge\" style=\"background-color: ${userColor}\">\n              <i class=\"fas fa-camera-retro\" aria-hidden=\"true\"></i>\n            </div>\n          </div>\n        </div>\n        <div class=\"story-detail-content\">\n          <div class=\"story-header\">\n            <div class=\"story-user\">\n              <div class=\"user-avatar\" aria-hidden=\"true\" style=\"background-color: ${userColor}\">\n                ${this._getInitials(storyName)}\n              </div>\n              <div>\n                <h1 class=\"story-name\" id=\"${storyTitleId}\">${storyName}</h1>\n                <time class=\"story-date\" datetime=\"${storyCreatedAt}\">\n                  <i class=\"far fa-calendar-alt\" aria-hidden=\"true\"></i> ${formattedDate}\n                </time>\n              </div>\n            </div>\n            <div class=\"story-actions-top\">\n              <button id=\"favorite-button\" class=\"icon-button ${isFavorite ? 'active' : ''}\" aria-label=\"${isFavorite ? 'Remove from favorites' : 'Add to favorites'}\">\n                <i class=\"fas fa-heart\" aria-hidden=\"true\"></i>\n              </button>\n              <button id=\"share-button\" class=\"icon-button hidden\" aria-label=\"Share this story\">\n                <i class=\"fas fa-share-alt\" aria-hidden=\"true\"></i>\n              </button>\n            </div>\n          </div>\n          <div class=\"story-body\">\n            <p class=\"story-description\" id=\"${storyDescId}\">${storyDescription}</p>\n          </div>\n          ${\n            story.lat && story.lon\n              ? `\n                <div class=\"story-location\">\n                  <h2 class=\"section-title\">\n                    <i class=\"fas fa-map-marker-alt\" aria-hidden=\"true\"></i>\n                    Location\n                  </h2>\n                  <div class=\"story-map-container\">\n                    <div class=\"story-map-large\" id=\"detail-map\" tabindex=\"0\" aria-label=\"Map showing the location of ${storyName}'s story\"></div>\n                  </div>\n                  <p class=\"map-instructions\">\n                    <i class=\"fas fa-info-circle\" aria-hidden=\"true\"></i>\n                    You can switch between different map styles using the layer control in the top right.\n                  </p>\n                </div>\n              `\n              : ''\n          }\n          <div class=\"story-actions mt-3\">\n            <a href=\"#/\" class=\"back-link\" aria-label=\"Back to stories list\">\n              <i class=\"fas fa-arrow-left\" aria-hidden=\"true\"></i>\n              Back to Stories\n            </a>\n            <button id=\"save-story-button\" class=\"btn btn-primary\">\n              <i class=\"fas fa-bookmark\"></i> Simpan ke Favorit\n            </button>\n            <a href=\"#/stories/add\" class=\"action-button\" aria-label=\"Share your own story\">\n              <i class=\"fas fa-plus-circle\" aria-hidden=\"true\"></i>\n              Share Your Story\n            </a>\n          </div>\n        </div>\n      </article>\n    `;\n\n    if (story.lat && story.lon) {\n      this._mapContainer = document.getElementById('detail-map');\n    }\n\n    this._setupFavoriteButton(isFavorite);\n  }\n\n  getMapContainer() {\n    return this._mapContainer;\n  }\n\n  showLoading() {\n    document.querySelector('app-loader')?.show('Loading story...');\n  }\n\n  hideLoading() {\n    document.querySelector('app-loader')?.hide();\n  }\n\n  showOfflineMessage() {\n    document.getElementById('offline-notice')?.classList.remove('hidden');\n  }\n\n  hideOfflineMessage() {\n    document.getElementById('offline-notice')?.classList.add('hidden');\n  }\n\n  showOfflineNoDataMessage() {\n    Swal.fire({\n      icon: 'warning',\n      title: 'Offline',\n      text: 'This story is not available offline. Please connect to the internet and try again.',\n      confirmButtonColor: '#4361ee',\n    }).then(() => {\n      window.location.hash = '#/';\n    });\n  }\n\n  showLoginRequired() {\n    Swal.fire({\n      icon: 'warning',\n      title: 'Login Required',\n      text: 'Please login to view story details',\n      confirmButtonText: 'Login Now',\n      confirmButtonColor: '#4361ee',\n    }).then(() => {\n      window.location.hash = '#/login';\n    });\n  }\n\n  showInvalidIdError() {\n    Swal.fire({\n      icon: 'error',\n      title: 'Invalid Story ID',\n      text: 'The story ID is missing or invalid',\n      confirmButtonColor: '#4361ee',\n    }).then(() => {\n      window.location.hash = '#/';\n    });\n  }\n\n  showError(message) {\n    Swal.fire({\n      icon: 'error',\n      title: 'Error',\n      text: message || 'Failed to load story',\n      confirmButtonColor: '#4361ee',\n    }).then(() => {\n      window.location.hash = '#/';\n    });\n  }\n\n  showTimeoutError() {\n    const offlineNotice = document.getElementById('offline-notice');\n    if (offlineNotice) {\n      offlineNotice.innerHTML = `\n        <i class=\"fas fa-exclamation-triangle\"></i> \n        Server response is slow. Showing cached data if available.\n      `;\n      offlineNotice.classList.remove('hidden');\n      offlineNotice.style.backgroundColor = '#f8961e';\n    }\n    Swal.fire({\n      icon: 'warning',\n      title: 'Connection Issue',\n      text: \"The server is taking too long to respond. We'll try to show cached data if available.\",\n      confirmButtonColor: '#4361ee',\n      showCancelButton: true,\n      cancelButtonText: 'Back to Home',\n      confirmButtonText: 'Continue with Cache',\n    }).then((result) => {\n      if (!result.isConfirmed) {\n        window.location.hash = '#/';\n      }\n    });\n  }\n\n  showMapError() {\n    const mapContainer = document.querySelector('.story-map-container');\n    if (mapContainer) {\n      mapContainer.innerHTML = `\n        <div class=\"map-error-container\">\n          <div class=\"map-error-message\">\n            <i class=\"fas fa-map-marked-alt\"></i>\n            <p>Failed to load map. Please try refreshing the page.</p>\n          </div>\n        </div>\n      `;\n    }\n  }\n\n  _getUrlParams() {\n    const hash = window.location.hash;\n    const match = hash.match(/#\\/stories\\/([^/]+)$/);\n    return { id: match ? match[1] : null };\n  }\n\n  _getInitials(name) {\n    if (!name || typeof name !== 'string') return 'U';\n    return name\n      .split(' ')\n      .map((part) => part.charAt(0))\n      .join('')\n      .toUpperCase()\n      .substring(0, 2);\n  }\n\n  _getUserColor(name) {\n    const colors = [\n      '#4361ee', '#3f37c9', '#4895ef', '#4cc9f0', '#f72585',\n      '#7209b7', '#3a0ca3', '#f8961e', '#fb5607', '#80b918',\n    ];\n    const hash = name.split('').reduce((acc, char) => char.charCodeAt(0) + ((acc << 5) - acc), 0);\n    return colors[Math.abs(hash) % colors.length];\n  }\n\n  _isInFavorites(storyId) {\n    try {\n      const favoritesJson = localStorage.getItem('favoriteStories');\n      if (!favoritesJson) return false;\n      const favorites = JSON.parse(favoritesJson);\n      return Array.isArray(favorites) && favorites.includes(storyId);\n    } catch (error) {\n      console.error('Error checking favorites:', error);\n      return false;\n    }\n  }\n\n  _setupFavoriteButton(initialState) {\n    const favoriteButton = document.getElementById('favorite-button');\n    if (!favoriteButton) return;\n    favoriteButton.addEventListener('click', () => {\n      const currentState = favoriteButton.classList.contains('active');\n      const newState = !currentState;\n      if (newState) {\n        favoriteButton.classList.add('active');\n        favoriteButton.setAttribute('aria-label', 'Remove from favorites');\n      } else {\n        favoriteButton.classList.remove('active');\n        favoriteButton.setAttribute('aria-label', 'Add to favorites');\n      }\n      if (this._favoriteCallback) {\n        this._favoriteCallback(newState);\n      }\n    });\n  }\n\n  setFavoriteButtonCallback(callback) {\n    this._favoriteCallback = callback;\n  }\n\n  showShareButton() {\n    document.getElementById('share-button')?.classList.remove('hidden');\n  }\n\n  setShareButtonCallback(callback) {\n    const shareButton = document.getElementById('share-button');\n    if (shareButton) {\n      shareButton.addEventListener('click', callback);\n    }\n  }\n\n  animateRemoval(callback) {\n    const article = document.getElementById('story-article');\n    if (!article) {\n      if (callback) callback();\n      return;\n    }\n    article.style.transition = 'all 0.5s ease-out';\n    article.style.opacity = '0';\n    article.style.transform = 'scale(0.9)';\n    setTimeout(() => {\n      if (callback) callback();\n    }, 500);\n  }\n\n  cancelRemovalAnimation() {\n    const article = document.getElementById('story-article');\n    if (!article) return;\n    article.style.opacity = '1';\n    article.style.transform = 'scale(1)';\n  }\n}\n","import DicodingStoryApi from '../../data/api';\nimport CONFIG from '../../config';\nimport { formatFileSize } from '../../utils/index';\n\nexport default class AddPresenter {\n  #view;\n  _photoFile = null;\n  _map = null;\n  _marker = null;\n  _cameraStream = null;\n  _mapInitialized = false;\n\n  constructor({ view }) {\n    this.#view = view;\n    window.addEventListener('hashchange', () => this.stopCamera());\n    window.addEventListener('beforeunload', () => this.stopCamera());\n  }\n\n  init() {\n    this._setupForm();\n    this._setupPhotoPreview();\n    this._setupCamera();\n    this._setupLocationCheckbox();\n    this._setupInputValidation();\n    this._setupAutoSaveDraft();\n    this._checkMediaPermissions();\n  }\n\n  // Drafts\n  loadRecentDrafts() {\n    try {\n      const recentsJson = localStorage.getItem('recentDrafts');\n      if (!recentsJson) {\n        this.#view.displayRecentDrafts([]);\n        return;\n      }\n      const recents = JSON.parse(recentsJson);\n      this.#view.displayRecentDrafts(recents);\n    } catch (error) {\n      console.error('Error loading recent drafts:', error);\n      this.#view.displayRecentDrafts([]);\n    }\n  }\n  useDraft(draftId) {\n    try {\n      const recentsJson = localStorage.getItem('recentDrafts');\n      if (!recentsJson) return;\n      const recents = JSON.parse(recentsJson);\n      const draft = recents.find((d) => d.id === draftId);\n      if (draft) {\n        let description = draft.fullDescription || draft.description;\n        this.#view.applyDraftToForm(description);\n      }\n    } catch (error) {\n      console.error('Error using draft:', error);\n    }\n  }\n  _setupAutoSaveDraft() {\n    let draftTimeout;\n    const descriptionInput = document.querySelector('#description');\n    if (descriptionInput) {\n      descriptionInput.addEventListener('input', () => {\n        clearTimeout(draftTimeout);\n        draftTimeout = setTimeout(() => {\n          this._saveDraft(descriptionInput.value);\n        }, 30000);\n      });\n    }\n  }\n  _saveDraft(text) {\n    if (!text || text.trim().length < 5) return;\n    try {\n      const draftsJson = localStorage.getItem('recentDrafts');\n      let drafts = draftsJson ? JSON.parse(draftsJson) : [];\n      const preview = text.substring(0, 50) + (text.length > 50 ? '...' : '');\n      const newDraft = {\n        id: Date.now().toString(),\n        description: preview,\n        fullDescription: text,\n        timestamp: new Date().toISOString(),\n      };\n      drafts.unshift(newDraft);\n      drafts = drafts.slice(0, 5);\n      localStorage.setItem('recentDrafts', JSON.stringify(drafts));\n      window.showToast && window.showToast('Draft saved automatically', 'info');\n    } catch (error) {\n      console.error('Error saving draft:', error);\n    }\n  }\n\n  // Camera\n  _checkMediaPermissions() {\n    if (navigator.permissions && navigator.permissions.query) {\n      navigator.permissions\n        .query({ name: 'camera' })\n        .then((permissionStatus) => {\n          const cameraButton = document.querySelector('#camera-button');\n          if (permissionStatus.state === 'denied' && cameraButton) {\n            cameraButton.classList.add('permission-denied');\n            cameraButton.title = 'Camera permission denied. Please update your browser settings.';\n          }\n          permissionStatus.onchange = () => {\n            if (cameraButton) {\n              if (permissionStatus.state === 'denied') {\n                cameraButton.classList.add('permission-denied');\n                cameraButton.title = 'Camera permission denied. Please update your browser settings.';\n              } else {\n                cameraButton.classList.remove('permission-denied');\n                cameraButton.title = '';\n              }\n            }\n          };\n        })\n        .catch((error) => {\n          console.log('Error checking camera permission:', error);\n        });\n    }\n  }\n  stopCamera() {\n    if (this._cameraStream) {\n      try {\n        this._cameraStream.getTracks().forEach((track) => track.stop());\n      } catch (error) {\n        console.error('Error stopping camera tracks:', error);\n      }\n      this._cameraStream = null;\n      if (this.#view) this.#view.resetCameraUI();\n    }\n  }\n  _setupCamera() {\n    this.#view.setOpenCameraCallback(async () => {\n      try {\n        if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {\n          throw new Error('Your browser does not support camera access');\n        }\n        this.stopCamera();\n        const stream = await navigator.mediaDevices.getUserMedia({\n          video: { facingMode: 'environment', width: { ideal: 1280 }, height: { ideal: 720 } },\n          audio: false,\n        });\n        this._cameraStream = stream;\n        this.#view.showCameraStream(stream);\n        window.addEventListener('beforeunload', () => this.stopCamera(), { once: true });\n      } catch (error) {\n        if (error.name === 'NotAllowedError') {\n          this.#view.showCameraError('Camera access denied. Please allow camera access in your browser settings.');\n        } else if (error.name === 'NotFoundError') {\n          this.#view.showCameraError('No camera found on your device or camera is in use by another application.');\n        } else if (error.name === 'NotReadableError') {\n          this.#view.showCameraError('Could not access camera. Your camera might be in use by another application.');\n        } else if (error.name === 'OverconstrainedError') {\n          try {\n            const fallbackStream = await navigator.mediaDevices.getUserMedia({ video: true, audio: false });\n            this._cameraStream = fallbackStream;\n            this.#view.showCameraStream(fallbackStream);\n          } catch {\n            this.#view.showCameraError('Could not access camera with requested settings. Please try a different device.');\n          }\n        } else {\n          this.#view.showCameraError('Could not access camera: ' + (error.message || 'Unknown error'));\n        }\n      }\n    });\n    this.#view.setTakePhotoCallback(() => {\n      if (!this._cameraStream) {\n        this.#view.showCameraError('Camera is not ready. Please try again.');\n        return;\n      }\n      try {\n        const dataUrl = this.#view.capturePhoto();\n        if (!dataUrl) {\n          this.#view.showCameraError('Failed to capture photo');\n          return;\n        }\n        this.#view.showCameraFlash();\n        const filename = 'camera-photo-' + new Date().getTime() + '.jpg';\n        const file = this._dataURLToFile(dataUrl, filename);\n        if (!file) {\n          this.#view.showCameraError('Failed to process captured photo');\n          return;\n        }\n        if (file.size > CONFIG.MAX_PHOTO_SIZE) {\n          this.#view.showPhotoError(`File too large. Maximum size is ${formatFileSize(CONFIG.MAX_PHOTO_SIZE)}`);\n          return;\n        }\n        this._photoFile = file;\n        this.#view.showPhotoPreview(file);\n        window.showToast && window.showToast('Photo captured successfully!', 'success');\n        setTimeout(() => this.stopCamera(), 500);\n      } catch (error) {\n        this.#view.showCameraError('Error capturing photo: ' + error.message);\n      }\n    });\n    this.#view.setCloseCameraCallback(() => this.stopCamera());\n  }\n  _dataURLToFile(dataUrl, filename) {\n    try {\n      if (!dataUrl || typeof dataUrl !== 'string' || !dataUrl.startsWith('data:image/')) return null;\n      const arr = dataUrl.split(',');\n      if (arr.length !== 2) return null;\n      const mimeMatch = arr[0].match(/:(.*?);/);\n      if (!mimeMatch || mimeMatch.length < 2) return null;\n      const mime = mimeMatch[1];\n      const bstr = atob(arr[1]);\n      let n = bstr.length;\n      const u8arr = new Uint8Array(n);\n      while (n--) u8arr[n] = bstr.charCodeAt(n);\n      return new File([u8arr], filename, { type: mime });\n    } catch (error) {\n      console.error('Error converting data URL to file:', error);\n      return null;\n    }\n  }\n  _setupPhotoPreview() {\n    this.#view.setPhotoInputCallback((file) => {\n      if (!file) return;\n      if (file.size > CONFIG.MAX_PHOTO_SIZE) {\n        this.#view.showPhotoError(`File too large. Maximum size is ${formatFileSize(CONFIG.MAX_PHOTO_SIZE)}`);\n        return;\n      }\n      if (!['image/jpeg', 'image/png', 'image/jpg'].includes(file.type)) {\n        this.#view.showPhotoError('Only JPEG and PNG images are allowed');\n        return;\n      }\n      this._photoFile = file;\n      this.#view.clearPhotoError();\n      this.#view.showPhotoPreview(file);\n    });\n  }\n\n  // Form\n  _setupForm() {\n    this.#view.setSubmitCallback(async (formData) => {\n      const token = localStorage.getItem('token');\n      if (!token) {\n        await this.#view.showLoginRequiredAlert();\n        window.location.hash = '#/login';\n        return;\n      }\n      if (!this._validateForm()) {\n        this.#view.showFormValidationError();\n        return;\n      }\n      if (!formData.has('description') || !formData.get('description').trim()) {\n        this.#view.showDescriptionError('Description is required');\n        this.#view.showFormValidationError();\n        return;\n      }\n      if (!formData.has('photo') || !formData.get('photo')) {\n        if (this._photoFile) {\n          formData.set('photo', this._photoFile);\n        } else {\n          this.#view.showPhotoError('Please select or take a photo');\n          this.#view.showFormValidationError();\n          return;\n        }\n      }\n      this.#view.showLoader('Saving your story...');\n      this.#view.showProgressBar();\n      try {\n        await DicodingStoryApi.addNewStory({\n          token,\n          data: formData,\n          onProgress: (progress) => this.#view.updateProgressBar(progress),\n        });\n        this.#view.updateProgressBar(100);\n        setTimeout(() => this.#view.hideProgressBar(), 500);\n        await this.#view.showSuccessAlert();\n        this.#view.showConfetti();\n        this._addToRecents(formData.get('description'));\n        setTimeout(() => {\n          window.location.hash = '#/';\n          this.#view.resetForm();\n          this.stopCamera();\n        }, 1000);\n      } catch (error) {\n        this.#view.hideProgressBar();\n        this.#view.showErrorAlert(error.message);\n      } finally {\n        this.#view.hideLoader();\n      }\n    });\n  }\n  _setupInputValidation() {\n    this.#view.setDescriptionInputCallback((value) => this._validateDescription(value));\n  }\n  _validateDescription(description) {\n    if (!description) {\n      this.#view.showDescriptionError('Please enter a description');\n      return false;\n    }\n    if (description.length < 10) {\n      this.#view.showDescriptionError('Description must be at least 10 characters');\n      return false;\n    }\n    const sensitiveWords = ['judi', 'poker', 'togel', 'seks', 'adult', 'xxx'];\n    const containsSensitiveContent = sensitiveWords.some((word) =>\n      description.toLowerCase().includes(word)\n    );\n    if (containsSensitiveContent) {\n      this.#view.showDescriptionError('Your story may contain inappropriate content. Please revise.');\n      return false;\n    }\n    this.#view.clearDescriptionError();\n    return true;\n  }\n  _validateForm() {\n    const isDescriptionValid = this._validateDescription(this.#view.getDescription());\n    const isPhotoValid = this._validatePhoto();\n    return isDescriptionValid && isPhotoValid;\n  }\n  _validatePhoto() {\n    if (!this._photoFile) {\n      const photoInput = document.querySelector('#photo');\n      if (photoInput && photoInput.files.length > 0) {\n        this._photoFile = photoInput.files[0];\n      } else {\n        const photoPreview = document.querySelector('#photo-preview img');\n        if (!photoPreview || photoPreview.classList.contains('hidden')) {\n          this.#view.showPhotoError('Please select or take a photo');\n          return false;\n        }\n      }\n    }\n    if (this._photoFile && this._photoFile.size > CONFIG.MAX_PHOTO_SIZE) {\n      this.#view.showPhotoError(`File too large. Maximum size is ${formatFileSize(CONFIG.MAX_PHOTO_SIZE)}`);\n      return false;\n    }\n    return true;\n  }\n\n  // Location/Map\n  _setupLocationCheckbox() {\n    this.#view.setLocationCheckboxCallback((isChecked) => {\n      if (isChecked) {\n        this.#view.showMapContainer();\n        if (!this._mapInitialized) {\n          setTimeout(() => this._initMap(), 300);\n        } else if (this._map) {\n          this._map.invalidateSize();\n        }\n      } else {\n        this.#view.hideMapContainer();\n      }\n    });\n  }\n  _initMap() {\n    if (!window.L) {\n      this.#view.showMapError('Map library not loaded. Please check your internet connection and reload the page.');\n      return;\n    }\n    try {\n      const mapElement = document.getElementById('map');\n      if (!mapElement) return;\n      this._map = L.map('map', {\n        zoomControl: true,\n        attributionControl: true,\n      }).setView(CONFIG.DEFAULT_MAP_CENTER, CONFIG.DEFAULT_MAP_ZOOM);\n      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n        attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\n        maxZoom: 19,\n      }).addTo(this._map);\n      setTimeout(() => this._map.invalidateSize(), 100);\n      this._mapInitialized = true;\n      if (window.L.Control && window.L.Control.Geocoder) {\n        const geocoder = L.Control.Geocoder.nominatim({\n          geocodingQueryParams: { countrycodes: 'id', limit: 5 },\n        });\n        const control = L.Control.geocoder({\n          defaultMarkGeocode: false,\n          geocoder: geocoder,\n          placeholder: 'Search for places...',\n          errorMessage: 'Nothing found.',\n          suggestMinLength: 3,\n          suggestTimeout: 250,\n          queryMinLength: 1,\n        }).addTo(this._map);\n        control.on('markgeocode', (e) => {\n          const { lat, lng } = e.geocode.center;\n          this._updateLocation(lat, lng);\n          this._map.setView([lat, lng], 15);\n        });\n      }\n      if (window.L.control && window.L.control.locate) {\n        L.control\n          .locate({\n            position: 'topright',\n            strings: { title: 'Temukan lokasi saya' },\n            locateOptions: { enableHighAccuracy: true, maxZoom: 15 },\n            flyTo: true,\n          })\n          .addTo(this._map);\n      }\n      this._map.on('click', (e) => this._updateLocation(e.latlng.lat, e.latlng.lng));\n      this.#view.setLocateMeCallback(() => {\n        if ('geolocation' in navigator) {\n          this.#view.showLoader('Finding your location...');\n          navigator.geolocation.getCurrentPosition(\n            (position) => {\n              this.#view.hideLoader();\n              const { latitude, longitude } = position.coords;\n              this._updateLocation(latitude, longitude);\n              this._map.setView([latitude, longitude], 15);\n              window.showToast && window.showToast('Location found!', 'success');\n            },\n            (error) => {\n              this.#view.hideLoader();\n              let errorMessage = 'Could not get your location.';\n              switch (error.code) {\n                case error.PERMISSION_DENIED:\n                  errorMessage = 'Location access denied. Please check your browser settings.'; break;\n                case error.POSITION_UNAVAILABLE:\n                  errorMessage = 'Location information is unavailable.'; break;\n                case error.TIMEOUT:\n                  errorMessage = 'Location request timed out.'; break;\n              }\n              this.#view.showMapError(errorMessage);\n            },\n            { enableHighAccuracy: true, timeout: 10000, maximumAge: 0 }\n          );\n        } else {\n          this.#view.showMapError('Geolocation is not supported by your browser');\n        }\n      });\n      this.#view.setSearchLocationCallback(() => {\n        const geocoderControl = document.querySelector('.leaflet-control-geocoder');\n        if (geocoderControl) {\n          try {\n            const searchButton = geocoderControl.querySelector('.leaflet-control-geocoder-icon');\n            const searchInput = geocoderControl.querySelector('input');\n            if (searchButton) searchButton.click();\n            if (searchInput) searchInput.focus();\n          } catch {\n            this._showLocationSearchPrompt();\n          }\n        } else {\n          this._showLocationSearchPrompt();\n        }\n      });\n    } catch (error) {\n      this.#view.showMapError('Failed to initialize map: ' + error.message);\n    }\n  }\n  _showLocationSearchPrompt() {\n    Swal.fire({\n      title: 'Search Location',\n      input: 'text',\n      inputPlaceholder: 'Enter a place or address',\n      showCancelButton: true,\n      confirmButtonColor: '#4361ee',\n      cancelButtonColor: '#6c757d',\n      confirmButtonText: 'Search',\n      showLoaderOnConfirm: true,\n      preConfirm: (query) => {\n        if (!query) {\n          Swal.showValidationMessage('Please enter a location');\n          return;\n        }\n        return fetch(\n          `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(query)}&limit=5`\n        )\n          .then((response) => {\n            if (!response.ok) throw new Error('Network response was not ok');\n            return response.json();\n          })\n          .catch((error) => {\n            Swal.showValidationMessage(`Search failed: ${error.message}`);\n          });\n      },\n      allowOutsideClick: () => !Swal.isLoading(),\n    }).then((result) => {\n      if (result.isConfirmed && result.value && result.value.length > 0) {\n        const locations = result.value;\n        if (locations.length === 1) {\n          const location = locations[0];\n          const lat = parseFloat(location.lat);\n          const lon = parseFloat(location.lon);\n          this._updateLocation(lat, lon);\n          if (this._map) this._map.setView([lat, lon], 15);\n        } else if (locations.length > 1) {\n          const options = locations.map((loc) => ({\n            text: loc.display_name,\n            value: loc.place_id,\n            lat: parseFloat(loc.lat),\n            lon: parseFloat(loc.lon),\n          }));\n          Swal.fire({\n            title: 'Select Location',\n            input: 'radio',\n            inputOptions: options.reduce((acc, opt) => {\n              acc[opt.value] = opt.text;\n              return acc;\n            }, {}),\n            showCancelButton: true,\n            confirmButtonColor: '#4361ee',\n            confirmButtonText: 'Select',\n          }).then((result) => {\n            if (result.isConfirmed) {\n              const selectedOption = options.find((opt) => opt.value.toString() === result.value);\n              if (selectedOption) {\n                this._updateLocation(selectedOption.lat, selectedOption.lon);\n                if (this._map) this._map.setView([selectedOption.lat, selectedOption.lon], 15);\n              }\n            }\n          });\n        } else {\n          Swal.fire({\n            icon: 'info',\n            title: 'No Results',\n            text: 'No locations found for your search.',\n          });\n        }\n      }\n    });\n  }\n  _updateLocation(lat, lng) {\n    this.#view.updateLocationCoordinates(lat, lng);\n    if (this._marker) {\n      this._marker.setLatLng([lat, lng]);\n    } else if (this._map) {\n      this._marker = L.marker([lat, lng], { draggable: true, autoPan: true }).addTo(this._map);\n      this._marker.on('dragend', (event) => {\n        const marker = event.target;\n        const position = marker.getLatLng();\n        this._updateLocation(position.lat, position.lng);\n      });\n    }\n    if (this._map) {\n      this._map.setView([lat, lng], this._map.getZoom() || 15);\n      const locationText = document.getElementById('location-text');\n      if (locationText) {\n        locationText.innerHTML = `\n          <span class=\"loading-dots\">Getting location name</span>\n          <br>Coordinates: ${lat.toFixed(6)}, ${lng.toFixed(6)}\n        `;\n      }\n      this._reverseGeocode(lat, lng);\n    }\n  }\n  _reverseGeocode(lat, lng) {\n    if (window.L && window.L.Control && window.L.Control.Geocoder) {\n      try {\n        const geocoder = L.Control.Geocoder.nominatim();\n        if (geocoder) {\n          geocoder.reverse({ lat, lng }, this._map.getZoom(), (results) => {\n            if (results && results.length > 0) {\n              const locationName = results[0].name;\n              const locationText = document.getElementById('location-text');\n              if (locationText && locationName) {\n                locationText.innerHTML = `\n                  <strong>${locationName}</strong>\n                  <br>Coordinates: ${lat.toFixed(6)}, ${lng.toFixed(6)}\n                `;\n              }\n            }\n          });\n          return;\n        }\n      } catch (error) {\n        console.warn('Leaflet reverse geocoding failed:', error);\n      }\n    }\n    try {\n      fetch(\n        `https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lng}&zoom=18&addressdetails=1`\n      )\n        .then((response) => response.json())\n        .then((data) => {\n          if (data && data.display_name) {\n            const locationText = document.getElementById('location-text');\n            if (locationText) {\n              locationText.innerHTML = `\n                <strong>${data.display_name}</strong>\n                <br>Coordinates: ${lat.toFixed(6)}, ${lng.toFixed(6)}\n              `;\n            }\n          }\n        })\n        .catch((error) => {\n          const locationText = document.getElementById('location-text');\n          if (locationText) {\n            locationText.textContent = `Coordinates: ${lat.toFixed(6)}, ${lng.toFixed(6)}`;\n          }\n        });\n    } catch (error) {\n      // fallback\n    }\n  }\n  _addToRecents(description) {\n    try {\n      const recentsJson = localStorage.getItem('recentDrafts');\n      let recents = recentsJson ? JSON.parse(recentsJson) : [];\n      const preview = description.substring(0, 50) + (description.length > 50 ? '...' : '');\n      recents.unshift({\n        description: preview,\n        timestamp: new Date().toISOString(),\n        id: Date.now().toString(),\n      });\n      recents = recents.slice(0, 5);\n      localStorage.setItem('recentDrafts', JSON.stringify(recents));\n    } catch (error) {\n      console.error('Error saving to recents:', error);\n    }\n  }\n}\n","import '../../components/header';\nimport '../../components/loader';\nimport '../../components/footer';\nimport '../../components/sidebar';\nimport AddPresenter from './add-presenter';\n\nexport default class AddStoryPage {\n  constructor() {\n    this._presenter = new AddPresenter({ view: this });\n  }\n\n  async render() {\n    return `\n      <app-sidebar></app-sidebar>\n      <app-header></app-header>\n      <main id=\"main-content\" class=\"main-content\" tabindex=\"-1\">\n        <section class=\"container\">\n          <div class=\"add-story-container\">\n            <h1 class=\"page-title\">Share Your Story</h1>\n            <div class=\"recent-drafts-container hidden\" id=\"recent-drafts\"></div>\n            <form id=\"add-story-form\" class=\"story-form\">\n              <div class=\"form-group\">\n                <label for=\"description\" class=\"form-label\">Story Description</label>\n                <textarea\n                  id=\"description\"\n                  class=\"form-control\"\n                  placeholder=\"Share your learning experience...\"\n                  rows=\"4\"\n                  required\n                  maxlength=\"280\"\n                  aria-describedby=\"description-error\"\n                ></textarea>\n                <small id=\"description-error\" class=\"error-text\"></small>\n                <div class=\"character-counter\">\n                  <span id=\"char-count\">0</span> / 280 characters\n                </div>\n              </div>\n              <div class=\"form-group\">\n                <label class=\"form-label\">Photo</label>\n                <div class=\"photo-upload-container\">\n                  <div class=\"photo-preview-container\">\n                    <div class=\"photo-preview\" id=\"photo-preview\">\n                      <i class=\"fas fa-image preview-placeholder\"></i>\n                      <img id=\"preview-image\" class=\"hidden\" alt=\"Preview of your photo\">\n                    </div>\n                  </div>\n                  <div class=\"photo-actions\">\n                    <div class=\"photo-upload\">\n                      <label for=\"photo\" class=\"custom-file-upload\">\n                        <i class=\"fas fa-upload\"></i> Select Photo\n                      </label>\n                      <input type=\"file\" id=\"photo\" name=\"photo\" accept=\"image/jpeg, image/png\" hidden>\n                    </div>\n                    <div class=\"or-divider\">or</div>\n                    <button type=\"button\" id=\"camera-button\" class=\"camera-button\">\n                      <i class=\"fas fa-camera\"></i> Take Photo\n                    </button>\n                  </div>\n                </div>\n                <small id=\"photo-error\" class=\"error-text\"></small>\n              </div>\n              <div class=\"camera-container hidden\" id=\"camera-container\">\n                <div class=\"camera-view-container\">\n                  <video id=\"camera-view\" autoplay playsinline></video>\n                  <canvas id=\"camera-canvas\" class=\"hidden\"></canvas>\n                </div>\n                <div class=\"camera-controls\">\n                  <button type=\"button\" id=\"take-photo\" class=\"camera-control-button\">\n                    <i class=\"fas fa-circle\"></i>\n                  </button>\n                  <button type=\"button\" id=\"close-camera\" class=\"camera-control-button\">\n                    <i class=\"fas fa-times\"></i>\n                  </button>\n                </div>\n                <small id=\"camera-error\" class=\"error-text\"></small>\n              </div>\n              <div class=\"form-group\">\n                <div class=\"custom-checkbox\">\n                  <input type=\"checkbox\" id=\"location-enabled\" name=\"location-enabled\">\n                  <label for=\"location-enabled\">\n                    <i class=\"fas fa-map-marker-alt\"></i> Include location\n                  </label>\n                </div>\n              </div>\n              <div id=\"map-container\" class=\"map-container hidden\">\n                <div id=\"map\" class=\"add-story-map\"></div>\n                <input type=\"hidden\" id=\"lat\" name=\"lat\">\n                <input type=\"hidden\" id=\"lon\" name=\"lon\">\n                <small id=\"map-error\" class=\"error-text\"></small>\n                <div class=\"location-info\" id=\"location-info\">\n                  <i class=\"fas fa-map-pin\"></i>\n                  <span id=\"location-text\">No location selected</span>\n                </div>\n              </div>\n              <div class=\"progress-container hidden\" id=\"progress-container\">\n                <div class=\"progress-bar\" id=\"progress-bar\" style=\"width: 0%\"></div>\n              </div>\n              <div class=\"form-actions\">\n                <a href=\"#/\" class=\"cancel-button\">Cancel</a>\n                <button type=\"submit\" class=\"submit-button\" id=\"submit-button\">\n                  <i class=\"fas fa-paper-plane\"></i> Share Story\n                </button>\n              </div>\n            </form>\n          </div>\n        </section>\n      </main>\n      <app-footer></app-footer>\n      <app-loader></app-loader>\n      <canvas id=\"confetti-canvas\" class=\"confetti-canvas\"></canvas>\n    `;\n  }\n\n  async afterRender() {\n    this._presenter.init();\n    this._presenter.loadRecentDrafts();\n    this._setupCharCounter();\n  }\n\n  _setupCharCounter() {\n    const textarea = document.getElementById('description');\n    const charCount = document.getElementById('char-count');\n    if (textarea && charCount) {\n      textarea.addEventListener('input', () => {\n        const count = textarea.value.length;\n        charCount.textContent = count;\n        if (count > 240 && count <= 270) {\n          charCount.classList.add('text-warning');\n          charCount.classList.remove('text-danger');\n        } else if (count > 270) {\n          charCount.classList.add('text-danger');\n          charCount.classList.remove('text-warning');\n        } else {\n          charCount.classList.remove('text-warning', 'text-danger');\n        }\n      });\n    }\n  }\n\n  displayRecentDrafts(drafts) {\n    const container = document.getElementById('recent-drafts');\n    if (!container) return;\n    if (!drafts || !Array.isArray(drafts) || drafts.length === 0) {\n      container.classList.add('hidden');\n      return;\n    }\n    container.classList.remove('hidden');\n    let html =\n      '<h2 class=\"recent-drafts-title\">Recent Drafts</h2><div class=\"recent-drafts-list\">';\n    drafts.forEach((draft) => {\n      const date = new Date(draft.timestamp);\n      const formattedDate = date.toLocaleDateString('id-ID', {\n        day: 'numeric',\n        month: 'short',\n      });\n      html += `\n        <div class=\"recent-draft-item\" data-id=\"${draft.id}\">\n          <div class=\"draft-content\">\n            <p class=\"draft-text\">${draft.description}</p>\n            <span class=\"draft-date\">${formattedDate}</span>\n          </div>\n          <button class=\"use-draft-btn\" data-id=\"${draft.id}\">\n            <i class=\"fas fa-arrow-right\"></i>\n          </button>\n        </div>\n      `;\n    });\n    html += '</div>';\n    container.innerHTML = html;\n    document.querySelectorAll('.use-draft-btn').forEach((btn) => {\n      btn.addEventListener('click', () => {\n        const draftId = btn.getAttribute('data-id');\n        this._presenter.useDraft(draftId);\n      });\n    });\n  }\n\n  applyDraftToForm(description) {\n    const textarea = document.getElementById('description');\n    if (textarea) {\n      textarea.value = description;\n      textarea.dispatchEvent(new Event('input'));\n      textarea.focus();\n      document.querySelector('.story-form').scrollIntoView({ behavior: 'smooth' });\n    }\n  }\n\n  // Camera methods\n  setOpenCameraCallback(callback) {\n    const openCameraButton = document.querySelector('#camera-button');\n    if (openCameraButton) openCameraButton.addEventListener('click', callback);\n  }\n  setTakePhotoCallback(callback) {\n    const takePhotoButton = document.querySelector('#take-photo');\n    if (takePhotoButton) takePhotoButton.addEventListener('click', callback);\n  }\n  showCameraStream(stream) {\n    const cameraContainer = document.querySelector('#camera-container');\n    const videoElement = document.querySelector('#camera-view');\n    if (!cameraContainer || !videoElement) return;\n    cameraContainer.classList.remove('hidden');\n    videoElement.srcObject = stream;\n    videoElement.onloadedmetadata = () => {\n      videoElement.play().catch((error) => console.error('Error playing video:', error));\n    };\n  }\n  capturePhoto() {\n    const videoElement = document.querySelector('#camera-view');\n    const canvas = document.querySelector('#camera-canvas');\n    if (!videoElement || !canvas) return null;\n    if (videoElement.videoWidth === 0 || videoElement.videoHeight === 0) return null;\n    canvas.width = videoElement.videoWidth;\n    canvas.height = videoElement.videoHeight;\n    const context = canvas.getContext('2d');\n    context.drawImage(videoElement, 0, 0, canvas.width, canvas.height);\n    return canvas.toDataURL('image/jpeg', 0.9);\n  }\n  showCameraFlash() {\n    const flash = document.createElement('div');\n    flash.className = 'camera-flash';\n    document.body.appendChild(flash);\n    setTimeout(() => {\n      flash.style.opacity = '0.8';\n      setTimeout(() => {\n        flash.style.opacity = '0';\n        setTimeout(() => {\n          document.body.removeChild(flash);\n        }, 300);\n      }, 100);\n    }, 10);\n  }\n  resetCameraUI() {\n    const cameraContainer = document.querySelector('#camera-container');\n    const videoElement = document.querySelector('#camera-view');\n    if (cameraContainer) cameraContainer.classList.add('hidden');\n    if (videoElement) videoElement.srcObject = null;\n  }\n  showCameraError(message) {\n    Swal.fire({\n      icon: 'error',\n      title: 'Camera Error',\n      text: message,\n      confirmButtonColor: '#4361ee',\n    });\n  }\n\n  // Photo preview methods\n  setPhotoInputCallback(callback) {\n    const photoInput = document.querySelector('#photo');\n    if (photoInput) {\n      photoInput.addEventListener('change', (event) => {\n        callback(event.target.files[0]);\n      });\n    }\n  }\n  showPhotoPreview(file) {\n    const photoPreview = document.querySelector('#photo-preview');\n    if (!photoPreview) return;\n    const reader = new FileReader();\n    reader.onload = (e) => {\n      photoPreview.innerHTML = `\n        <img \n          src=\"${e.target.result}\" \n          alt=\"Selected photo preview\" \n          style=\"max-width: 100%; border-radius: 8px; max-height: 300px;\"\n        >\n      `;\n    };\n    reader.readAsDataURL(file);\n  }\n  showPhotoError(message) {\n    const photoError = document.querySelector('#photo-error');\n    if (photoError) {\n      photoError.textContent = message;\n      photoError.style.display = 'block';\n    }\n  }\n  clearPhotoError() {\n    const photoError = document.querySelector('#photo-error');\n    if (photoError) {\n      photoError.textContent = '';\n      photoError.style.display = 'none';\n    }\n  }\n\n  // Location methods\n  setLocationCheckboxCallback(callback) {\n    const locationCheckbox = document.querySelector('#location-enabled');\n    if (locationCheckbox) {\n      locationCheckbox.addEventListener('change', () => {\n        callback(locationCheckbox.checked);\n      });\n    }\n  }\n  showMapContainer() {\n    const mapContainer = document.querySelector('#map-container');\n    if (mapContainer) {\n      mapContainer.classList.remove('hidden');\n      setTimeout(() => {\n        if (window.L && window.L.map) {\n          const map = window.L.map._instances?.[0];\n          if (map) map.invalidateSize();\n        }\n      }, 100);\n    }\n  }\n  hideMapContainer() {\n    const mapContainer = document.querySelector('#map-container');\n    if (mapContainer) mapContainer.classList.add('hidden');\n  }\n  setLocateMeCallback(callback) {\n    const locateMeButton = document.querySelector('#locate-me');\n    if (locateMeButton) locateMeButton.addEventListener('click', callback);\n  }\n  setSearchLocationCallback(callback) {\n    const searchLocationButton = document.querySelector('#search-location');\n    if (searchLocationButton) searchLocationButton.addEventListener('click', callback);\n  }\n  updateLocationCoordinates(lat, lng) {\n    const latInput = document.querySelector('#lat');\n    const lonInput = document.querySelector('#lon');\n    const locationText = document.querySelector('#location-text');\n    if (latInput && lonInput) {\n      latInput.value = lat;\n      lonInput.value = lng;\n    }\n    if (locationText) {\n      locationText.textContent = `Coordinates: ${lat.toFixed(6)}, ${lng.toFixed(6)}`;\n    }\n  }\n  showMapError(message) {\n    Swal.fire({\n      icon: 'error',\n      title: 'Map Error',\n      text: message,\n      confirmButtonColor: '#4361ee',\n    });\n  }\n\n  // Form methods\n  setSubmitCallback(callback) {\n    const form = document.querySelector('#add-story-form');\n    if (!form) return;\n    form.addEventListener('submit', async (event) => {\n      event.preventDefault();\n      const description = this.getDescription();\n      const photoInput = document.querySelector('#photo');\n      const photoFile = photoInput.files[0];\n      const useLocation = document.querySelector('#location-enabled').checked;\n      const lat = document.querySelector('#lat').value;\n      const lon = document.querySelector('#lon').value;\n      const formData = new FormData();\n      formData.append('description', description);\n      if (photoFile) formData.append('photo', photoFile);\n      if (useLocation && lat && lon) {\n        formData.append('lat', lat);\n        formData.append('lon', lon);\n      }\n      callback(formData);\n    });\n  }\n  getDescription() {\n    const descriptionInput = document.querySelector('#description');\n    return descriptionInput ? descriptionInput.value.trim() : '';\n  }\n  setDescriptionInputCallback(callback) {\n    const descriptionInput = document.querySelector('#description');\n    if (descriptionInput) {\n      descriptionInput.addEventListener('input', () => {\n        callback(descriptionInput.value.trim());\n      });\n    }\n  }\n  showDescriptionError(message) {\n    const descriptionError = document.querySelector('#description-error');\n    if (descriptionError) {\n      descriptionError.textContent = message;\n      descriptionError.style.display = 'block';\n      const descriptionInput = document.querySelector('#description');\n      if (descriptionInput) {\n        descriptionInput.classList.add('error');\n        descriptionInput.setAttribute('aria-invalid', 'true');\n      }\n    }\n  }\n  clearDescriptionError() {\n    const descriptionError = document.querySelector('#description-error');\n    if (descriptionError) {\n      descriptionError.textContent = '';\n      descriptionError.style.display = 'none';\n      const descriptionInput = document.querySelector('#description');\n      if (descriptionInput) {\n        descriptionInput.classList.remove('error');\n        descriptionInput.setAttribute('aria-invalid', 'false');\n      }\n    }\n  }\n\n  // UI helper methods\n  showLoader(message = 'Loading...') {\n    document.querySelector('app-loader')?.show(message);\n  }\n  hideLoader() {\n    document.querySelector('app-loader')?.hide();\n  }\n  disableSubmitButton() {\n    const submitButton = document.querySelector('#submit-button');\n    if (submitButton) submitButton.disabled = true;\n  }\n  resetForm() {\n    const form = document.querySelector('#add-story-form');\n    const photoPreview = document.querySelector('#photo-preview');\n    const mapContainer = document.querySelector('#map-container');\n    const locationCheckbox = document.querySelector('#location-enabled');\n    if (form) form.reset();\n    if (photoPreview) {\n      photoPreview.innerHTML = `<i class=\"fas fa-image preview-placeholder\"></i>\n      <img id=\"preview-image\" class=\"hidden\" alt=\"Preview of your photo\">`;\n    }\n    if (mapContainer) mapContainer.classList.add('hidden');\n    if (locationCheckbox) locationCheckbox.checked = false;\n    const charCount = document.getElementById('char-count');\n    if (charCount) {\n      charCount.textContent = '0';\n      charCount.classList.remove('text-warning', 'text-danger');\n    }\n  }\n\n  // Alerts\n  async showLoginRequiredAlert() {\n    return Swal.fire({\n      icon: 'warning',\n      title: 'Login Required',\n      text: 'You need to login first',\n      confirmButtonText: 'OK',\n      confirmButtonColor: '#4361ee',\n    });\n  }\n  async showOfflineAlert() {\n    return Swal.fire({\n      icon: 'error',\n      title: 'Offline Mode',\n      text: 'Adding stories is not available without internet connection.',\n      confirmButtonColor: '#4361ee',\n    });\n  }\n  async showSuccessAlert() {\n    return Swal.fire({\n      icon: 'success',\n      title: 'Story added successfully!',\n      showConfirmButton: false,\n      timer: 1500,\n    });\n  }\n  async showErrorAlert(message) {\n    return Swal.fire({\n      icon: 'error',\n      title: 'Error',\n      text: message || 'Failed to add story',\n      confirmButtonColor: '#4361ee',\n    });\n  }\n  showProgressBar() {\n    document.getElementById('progress-container')?.classList.remove('hidden');\n  }\n  hideProgressBar() {\n    document.getElementById('progress-container')?.classList.add('hidden');\n  }\n  updateProgressBar(percent) {\n    const progressBar = document.getElementById('progress-bar');\n    if (progressBar) progressBar.style.width = `${percent}%`;\n  }\n  showFormValidationError() {\n    Swal.fire({\n      icon: 'warning',\n      title: 'Form Validation Error',\n      text: 'Please fix the errors in the form before submitting.',\n      confirmButtonColor: '#4361ee',\n    });\n  }\n  showConfetti() {\n    const canvas = document.getElementById('confetti-canvas');\n    if (!canvas) return;\n    canvas.classList.add('active');\n    const confettiSettings = {\n      target: canvas,\n      max: 150,\n      size: 1.5,\n      animate: true,\n      props: ['circle', 'square', 'triangle', 'line'],\n      colors: [\n        [165, 104, 246],\n        [230, 61, 135],\n        [0, 199, 228],\n        [253, 214, 126],\n      ],\n      clock: 25,\n      rotate: true,\n      start_from_edge: true,\n      respawn: false,\n    };\n    const confetti = window.confetti.create(canvas, confettiSettings);\n    confetti({\n      particleCount: 150,\n      spread: 160,\n    });\n    setTimeout(() => {\n      canvas.classList.remove('active');\n    }, 3000);\n  }\n  setCloseCameraCallback(callback) {\n    const closeButton = document.querySelector('#close-camera');\n    if (closeButton) closeButton.addEventListener('click', callback);\n  }\n}\n","import '../components/sidebar';\nimport '../components/header';\nimport '../components/footer';\n\nexport default class NotFoundPage {\n  async render() {\n    return `\n      <app-sidebar></app-sidebar>\n      <app-header></app-header>\n      <main id=\"main-content\" class=\"main-content\" tabindex=\"-1\">\n        <section class=\"container not-found\">\n          <h1 class=\"page-title\">404 - Halaman Tidak Ditemukan</h1>\n          <p>Maaf, halaman yang Anda cari tidak tersedia.</p>\n          <a href=\"#/\" class=\"btn btn-primary\">\n            <i class=\"fas fa-home\"></i>\n            Kembali ke Beranda\n          </a>\n        </section>\n      </main>\n      <app-footer></app-footer>\n    `;\n  }\n\n  async afterRender() {\n    // No additional logic needed\n  }\n}\n","/**\n * Utility for parsing and extracting route information from the current URL hash.\n */\n\nfunction extractPathnameSegments(path) {\n  // Remove query parameters if any\n  const cleanPath = path.split('?')[0];\n  const splitUrl = cleanPath.split('/').filter(Boolean);\n\n  return {\n    resource: splitUrl[0] || null,\n    id: splitUrl[1] && splitUrl[1] !== 'add' ? splitUrl[1] : null,\n    isAddPage: splitUrl[1] === 'add',\n  };\n}\n\nexport function getActivePathname() {\n  return location.hash.replace('#', '') || '/';\n}\n\nexport function getActiveRoute() {\n  const { resource, id, isAddPage } = extractPathnameSegments(getActivePathname());\n  let route = '#/';\n  if (resource) route = `#/${resource}`;\n  if (isAddPage) route += '/add';\n  if (id) route += '/:id';\n  return route;\n}\n\nexport function parseActivePathname() {\n  return extractPathnameSegments(getActivePathname());\n}\n\nexport function getQueryParams() {\n  const query = location.hash.split('?')[1];\n  if (!query) return {};\n  return query.split('&').reduce((params, param) => {\n    const [key, value] = param.split('=');\n    params[key] = decodeURIComponent(value);\n    return params;\n  }, {});\n}\n","import { getActiveRoute } from '../routes/url-parser';\nimport CONFIG from '../config';\n\nconst ACCESS_TOKEN_KEY = CONFIG.ACCESS_TOKEN_KEY;\nconst unauthenticatedRoutesOnly = ['/login', '/register'];\n\nexport function getAccessToken() {\n  try {\n    const accessToken = localStorage.getItem(ACCESS_TOKEN_KEY);\n    if (!accessToken || accessToken === 'null' || accessToken === 'undefined') return null;\n    return accessToken;\n  } catch (error) {\n    console.error('getAccessToken: error:', error);\n    return null;\n  }\n}\n\nexport function putAccessToken(token) {\n  try {\n    localStorage.setItem(ACCESS_TOKEN_KEY, token);\n    return true;\n  } catch (error) {\n    console.error('putAccessToken: error:', error);\n    return false;\n  }\n}\n\nexport function removeAccessToken() {\n  try {\n    localStorage.removeItem(ACCESS_TOKEN_KEY);\n    return true;\n  } catch (error) {\n    console.error('removeAccessToken: error:', error);\n    return false;\n  }\n}\n\nexport function checkUnauthenticatedRouteOnly(page) {\n  const url = getActiveRoute();\n  const isLogin = !!getAccessToken();\n  if (unauthenticatedRoutesOnly.includes(url) && isLogin) {\n    location.hash = '/';\n    return null;\n  }\n  return page;\n}\n\nexport function checkAuthenticatedRoute(page) {\n  const isLogin = !!getAccessToken();\n  if (!isLogin) {\n    location.hash = '/login';\n    return null;\n  }\n  return page;\n}\n\nexport function getLogout() {\n  removeAccessToken();\n  localStorage.removeItem('user');\n}\n","import IdbHelper from '../../idb';\nimport { getAccessToken } from '../../utils/auth.js';\n\nexport default class SavedPage {\n  constructor() {\n    this._title = 'Cerita Favorit - DicoStory';\n  }\n\n  async render() {\n    document.title = this._title;\n    return `\n      <app-sidebar></app-sidebar>\n      <app-header></app-header>\n      <main id=\"main-content\" class=\"main-content\" tabindex=\"-1\">\n        <section class=\"favorites-page page-transition\">\n          <div class=\"coordinator-layout\">\n            <div class=\"coordinator-header\">\n              <div>\n                <h2 class=\"coordinator-title\">Cerita Favorit</h2>\n                <p>Kumpulan cerita yang Anda tandai sebagai favorit</p>\n              </div>\n              <a href=\"#/\" class=\"btn btn-secondary\">\n                <i class=\"fas fa-arrow-left\"></i> Kembali ke Beranda\n              </a>\n            </div>\n            <div id=\"favorites-container\" class=\"coordinator-grid\">\n              <div class=\"loader\" id=\"favorites-loader\"></div>\n            </div>\n            <div id=\"error-container\" class=\"error-container hidden\"></div>\n          </div>\n        </section>\n      </main>\n      <app-footer></app-footer>\n    `;\n  }\n\n  async afterRender() {\n    if (!getAccessToken()) {\n      window.location.href = '#/login';\n      return;\n    }\n    this.showLoading();\n    try {\n      const favorites = await IdbHelper.getFavorites();\n      this.renderFavorites(favorites);\n    } catch (error) {\n      console.error('Error loading favorites:', error);\n      this.showError('Gagal memuat cerita favorit: ' + error.message);\n    }\n  }\n\n  showLoading() {\n    document.getElementById('favorites-loader')?.classList.remove('hidden');\n    document.getElementById('error-container')?.classList.add('hidden');\n  }\n\n  hideLoading() {\n    document.getElementById('favorites-loader')?.classList.add('hidden');\n  }\n\n  async renderFavorites(favorites) {\n    this.hideLoading();\n    const favoritesContainer = document.getElementById('favorites-container');\n    if (!favoritesContainer) return;\n\n    if (!favorites || favorites.length === 0) {\n      favoritesContainer.innerHTML = `\n        <div class=\"empty-state\">\n          <p>Belum ada cerita favorit.</p>\n          <a href=\"#/\" class=\"btn btn-primary\">Jelajahi Cerita</a>\n        </div>\n      `;\n      return;\n    }\n\n    favoritesContainer.innerHTML = '';\n    favorites.forEach((story) => {\n      const initial = (story.name?.charAt(0) || 'U').toUpperCase();\n      const storyItemElement = document.createElement('article');\n      storyItemElement.classList.add('story-card');\n      storyItemElement.innerHTML = `\n        <div class=\"story-image-container\">\n          <img\n            src=\"${story.photoUrl || './images/placeholder.jpg'}\"\n            alt=\"Cerita dari ${story.name}\"\n            class=\"story-image\"\n            loading=\"lazy\"\n            onerror=\"this.src='./images/placeholder.jpg';\"\n          />\n        </div>\n        <div class=\"story-content\">\n          <div class=\"user-info\">\n            <div class=\"user-avatar\">${initial}</div>\n            <span class=\"user-name\">${story.name}</span>\n          </div>\n          <h3 class=\"story-title\">${story.name}</h3>\n          <p class=\"story-description\">${this._truncateText(story.description, 100)}</p>\n          <div class=\"story-meta\">\n            <div class=\"story-info\">\n              <i class=\"fas fa-calendar-alt\"></i>\n              <span>${this._formatDate(story.createdAt)}</span>\n            </div>\n            ${\n              story.lat && story.lon\n                ? `<div class=\"story-info\">\n                <i class=\"fas fa-map-marker-alt\"></i>\n                <span>Lokasi tersedia</span>\n              </div>`\n                : ''\n            }\n          </div>\n          <div class=\"story-actions\">\n            <button class=\"remove-favorite-btn\" data-id=\"${story.id}\">\n              <i class=\"fas fa-trash\"></i> Hapus\n            </button>\n            <a href=\"#/stories/${story.id}\" class=\"view-details-btn\" data-id=\"${story.id}\">\n              Detail\n            </a>\n          </div>\n        </div>\n      `;\n      favoritesContainer.appendChild(storyItemElement);\n\n      // Remove favorite event\n      const removeBtn = storyItemElement.querySelector('.remove-favorite-btn');\n      removeBtn.addEventListener('click', async (event) => {\n        event.preventDefault();\n        await IdbHelper.removeFromFavorites(story.id);\n        storyItemElement.remove();\n        const remainingFavorites = await IdbHelper.getFavorites();\n        if (remainingFavorites.length === 0) this.renderFavorites([]);\n        window.showToast?.('Cerita dihapus dari Favorit', 'info');\n      });\n    });\n  }\n\n  showError(message) {\n    this.hideLoading();\n    const errorContainer = document.getElementById('error-container');\n    if (!errorContainer) return;\n    errorContainer.classList.remove('hidden');\n    errorContainer.innerHTML = `\n      <div class=\"error-content\">\n        <i class=\"fas fa-exclamation-triangle fa-3x\"></i>\n        <h3>Gagal memuat cerita favorit</h3>\n        <p>${message}</p>\n        <button id=\"retry-button\" class=\"btn\">Coba Lagi</button>\n      </div>\n    `;\n    document.getElementById('retry-button')?.addEventListener('click', async () => {\n      this.showLoading();\n      try {\n        const favorites = await IdbHelper.getFavorites();\n        this.renderFavorites(favorites);\n      } catch (error) {\n        this.showError('Gagal memuat cerita favorit: ' + error.message);\n      }\n    });\n  }\n\n  _truncateText(text, maxLength) {\n    if (!text) return '';\n    if (text.length <= maxLength) return text;\n    return text.substr(0, maxLength) + '...';\n  }\n\n  _formatDate(dateString) {\n    if (!dateString) return '-';\n    const options = {\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit',\n    };\n    return new Date(dateString).toLocaleDateString('id-ID', options);\n  }\n}\n","import HomePage from '../pages/home/home-page';\nimport AboutPage from '../pages/about/about-page';\nimport LoginPage from '../pages/auth/login/login-page';\nimport RegisterPage from '../pages/auth/register/register-page';\nimport StoryDetailPage from '../pages/story-detail/story-detail-page';\nimport AddStoryPage from '../pages/add/add-page';\nimport NotFoundPage from '../pages/not-found-page';\nimport SavedStoriesPage from '../pages/saved/saved-page';\n\nconst routes = {\n  '#/': HomePage,\n  '#/about': AboutPage,\n  '#/login': LoginPage,\n  '#/register': RegisterPage,\n  '#/stories/:id': StoryDetailPage,\n  '#/stories/add': AddStoryPage,\n  '#/saved': SavedStoriesPage,\n  '#/404': NotFoundPage,\n};\n\nexport default routes;\n","import routes from '../routes/routes';\nimport { getActiveRoute, parseActivePathname } from '../routes/url-parser';\n\nclass App {\n  #content = null;\n  #activePresenter = null;\n  #previousRoute = null;\n\n  constructor({ content }) {\n    this.#content = content;\n\n    // Sidebar logout event\n    document.addEventListener('user-logout', () => {\n      localStorage.removeItem('token');\n      localStorage.removeItem('user');\n      window.showToast?.('Logout berhasil', 'success');\n      window.location.hash = '#/login';\n    });\n  }\n\n  async renderPage() {\n    const url = getActiveRoute();\n    const { resource, id, isAddPage } = parseActivePathname();\n\n    this.#cleanupPreviousPage();\n\n    // Special handling for Add Story page\n    if (isAddPage) {\n      await this.#renderWithTransition(\n        async () => {\n          const page = new routes['#/stories/add']();\n          this.#content.innerHTML = await page.render();\n          await page.afterRender();\n          if (page._presenter) this.#activePresenter = page._presenter;\n          this.#previousRoute = url;\n          this.#updateSidebar();\n        },\n        { direction: 'right' }\n      );\n      return;\n    }\n\n    // Other pages\n    const PageClass = routes[url] || routes['#/404'];\n    await this.#renderWithTransition(\n      async () => {\n        const page = new PageClass();\n        this.#content.innerHTML = await page.render();\n        await page.afterRender();\n        if (page._presenter) this.#activePresenter = page._presenter;\n        this.#previousRoute = url;\n        this.#updateSidebar();\n      },\n      { direction: 'left' }\n    );\n  }\n\n  async #renderWithTransition(renderFn, { direction = 'left' } = {}) {\n    this.#showLoading();\n    try {\n      await document.startViewTransition(async () => {\n        await renderFn();\n        // Animate main content\n        if (window.matchMedia('(prefers-reduced-motion: no-preference)').matches) {\n          const mainContent = document.getElementById('main-content');\n          if (mainContent) {\n            mainContent.animate(\n              direction === 'right'\n                ? [\n                    { transform: 'translateX(100%)', opacity: 0 },\n                    { transform: 'translateX(0)', opacity: 1 },\n                  ]\n                : [\n                    { transform: 'translateX(-50px)', opacity: 0 },\n                    { transform: 'translateX(0)', opacity: 1 },\n                  ],\n              { duration: 300, easing: 'ease-out' }\n            );\n          }\n        }\n      }).finished;\n    } catch (error) {\n      console.error('Error rendering page:', error);\n      this.#showErrorPage();\n    } finally {\n      this.#hideLoading();\n    }\n  }\n\n  #cleanupPreviousPage() {\n    // Stop camera if leaving Add Story page\n    if (this.#previousRoute === '#/stories/add' && this.#activePresenter?.stopCamera) {\n      this.#activePresenter.stopCamera();\n    }\n    this.#activePresenter = null;\n  }\n\n  #setDocumentTitle(resource, id) {\n    const titles = {\n      stories: id ? 'Story Details' : 'Add Story',\n      login: 'Login',\n      register: 'Register',\n      about: 'About',\n      default: 'Home',\n    };\n    document.title = `Dicoding Story | ${titles[resource] || titles.default}`;\n  }\n\n  #showLoading() {\n    document.querySelector('app-loader')?.show();\n  }\n\n  #hideLoading() {\n    document.querySelector('app-loader')?.hide();\n  }\n\n  #showErrorPage() {\n    this.#content.innerHTML = `\n      <app-sidebar></app-sidebar>\n      <section class=\"container\">\n        <h1 class=\"page-title\">Error</h1>\n        <p>Gagal memuat halaman. Silakan coba lagi.</p>\n        <div class=\"flex gap-2 mt-3\">\n          <a href=\"#/\" class=\"back-link\">\n            <i class=\"fas fa-home\"></i>\n            Kembali ke Beranda\n          </a>\n          <button onclick=\"window.location.reload()\" class=\"back-link\" style=\"background-color: var(--danger)\">\n            <i class=\"fas fa-sync-alt\"></i>\n            Muat Ulang\n          </button>\n        </div>\n      </section>\n    `;\n  }\n\n  #updateSidebar() {\n    try {\n      const token = localStorage.getItem('token');\n      const userData = localStorage.getItem('user');\n      if (token && userData && userData !== 'undefined') {\n        try {\n          window.dispatchEvent(\n            new CustomEvent('user-login-state-changed', {\n              detail: { isLoggedIn: true, userData: JSON.parse(userData) },\n            })\n          );\n        } catch {\n          localStorage.removeItem('user');\n          const defaultUserData = { name: 'User', email: '' };\n          localStorage.setItem('user', JSON.stringify(defaultUserData));\n          window.dispatchEvent(\n            new CustomEvent('user-login-state-changed', {\n              detail: { isLoggedIn: true, userData: defaultUserData },\n            })\n          );\n        }\n      } else {\n        window.dispatchEvent(\n          new CustomEvent('user-login-state-changed', {\n            detail: { isLoggedIn: false, userData: null },\n          })\n        );\n      }\n    } catch (error) {\n      console.error('Error updating sidebar:', error);\n    }\n  }\n}\n\nexport default App;\n","import CONFIG from '../config';\n\nexport function isNotificationAvailable() {\n  return 'Notification' in window;\n}\n\nexport function isNotificationGranted() {\n  return Notification.permission === 'granted';\n}\n\nexport async function requestNotificationPermission() {\n  if (!isNotificationAvailable()) {\n    console.error('Notification API unsupported.');\n    return false;\n  }\n  if (isNotificationGranted()) return true;\n  const status = await Notification.requestPermission();\n  if (status === 'denied') {\n    alert('Izin notifikasi ditolak.');\n    return false;\n  }\n  if (status === 'default') {\n    alert('Izin notifikasi ditutup atau diabaikan.');\n    return false;\n  }\n  return true;\n}\n\nexport async function getPushSubscription() {\n  const registration = await navigator.serviceWorker.ready;\n  return await registration.pushManager.getSubscription();\n}\n\nexport async function isCurrentPushSubscriptionAvailable() {\n  return !!(await getPushSubscription());\n}\n\nexport function urlBase64ToUint8Array(base64String) {\n  const padding = '='.repeat((4 - (base64String.length % 4)) % 4);\n  const base64 = (base64String + padding).replace(/-/g, '+').replace(/_/g, '/');\n  const rawData = window.atob(base64);\n  return Uint8Array.from([...rawData].map((char) => char.charCodeAt(0)));\n}\n\nexport function generateSubscribeOptions() {\n  return {\n    userVisibleOnly: true,\n    applicationServerKey: urlBase64ToUint8Array(CONFIG.VAPID_PUBLIC_KEY),\n  };\n}\n\nexport async function subscribeUserToPush() {\n  try {\n    const registration = await navigator.serviceWorker.ready;\n    const permission = await Notification.requestPermission();\n    if (permission !== 'granted') {\n      console.log('Push notification permission denied');\n      return;\n    }\n    const token = localStorage.getItem('token');\n    if (!token) {\n      console.warn('User not logged in, cannot subscribe to push notifications');\n      return;\n    }\n    const applicationServerKey = urlBase64ToUint8Array(CONFIG.VAPID_PUBLIC_KEY);\n    const subscription = await registration.pushManager.subscribe({\n      userVisibleOnly: true,\n      applicationServerKey,\n    });\n    const { endpoint, keys } = subscription.toJSON();\n    const cleanSubscription = { endpoint, keys };\n\n    await fetch(`${CONFIG.BASE_URL}/notifications/subscribe`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        Authorization: `Bearer ${token}`,\n      },\n      body: JSON.stringify(cleanSubscription),\n    });\n    console.log('User subscribed to push notifications');\n  } catch (error) {\n    console.error('Failed to subscribe user:', error);\n  }\n}\n","import '../styles/styles.css';\nimport App from './pages/app';\nimport CONFIG from './config';\nimport { subscribeUserToPush } from './utils/notification-helper';\n\n// Create and show splash screen\nfunction showSplashScreen() {\n  const splashScreen = document.createElement('div');\n  splashScreen.className = 'splash-screen';\n\n  const logo = document.createElement('img');\n  logo.src = '/images/logo.png';\n  logo.alt = 'Dicoding Story Logo';\n  logo.className = 'splash-logo';\n\n  const title = document.createElement('div');\n  title.className = 'splash-title';\n  title.textContent = 'Dicoding Story';\n\n  const dotsContainer = document.createElement('div');\n  dotsContainer.className = 'splash-dots';\n\n  for (let i = 0; i < 3; i++) {\n    const dot = document.createElement('div');\n    dot.className = 'splash-dot';\n    dotsContainer.appendChild(dot);\n  }\n\n  splashScreen.appendChild(logo);\n  splashScreen.appendChild(title);\n  splashScreen.appendChild(dotsContainer);\n\n  document.body.appendChild(splashScreen);\n\n  return splashScreen;\n}\n\nfunction hideSplashScreen(splashScreen) {\n  splashScreen.style.opacity = '0';\n\n  setTimeout(() => {\n    splashScreen.style.visibility = 'hidden';\n    document.body.removeChild(splashScreen);\n  }, 600);\n}\n\n// Register Service Worker for PWA\nif ('serviceWorker' in navigator) {\n  // Handle Add to Home Screen prompt\n  window.addEventListener('beforeinstallprompt', (e) => {\n    e.preventDefault();\n    let deferredPrompt = e;\n    const installBtn = document.createElement('button');\n    installBtn.id = 'install-button';\n    installBtn.textContent = 'Install App';\n    installBtn.className = 'install-button';\n    document.body.appendChild(installBtn);\n    installBtn.addEventListener('click', async () => {\n      installBtn.style.display = 'none';\n      deferredPrompt.prompt();\n      const { outcome } = await deferredPrompt.userChoice;\n      console.log(`User response to the install prompt: ${outcome}`);\n      deferredPrompt = null;\n    });\n  });\n\n  window.addEventListener('load', () => {\n    // Register service worker in all environments (including development)\n    navigator.serviceWorker\n      .register(CONFIG.SERVICE_WORKER_PATH)\n      .then((registration) => {\n        console.log(\n          'ServiceWorker registration successful with scope: ',\n          registration.scope\n        );\n        window.showToast && window.showToast('Aplikasi siap digunakan secara offline', 'success');\n        // Subscribe to push notifications\n        subscribeUserToPush(registration);\n      })\n      .catch((err) => {\n        console.error('ServiceWorker registration failed: ', err);\n        window.showToast && window.showToast('Gagal mendaftarkan service worker', 'error');\n      });\n  });\n}\n\n// Feature detection for View Transition API\nconst supportsViewTransitions = () => {\n  return (\n    'startViewTransition' in document &&\n    !window.matchMedia('(prefers-reduced-motion: reduce)').matches\n  );\n};\n\n// Polyfill for View Transition API\nif (!supportsViewTransitions()) {\n  document.startViewTransition = (callback) => {\n    try {\n      const updateCallbackDone = Promise.resolve(callback());\n\n      return {\n        ready: Promise.resolve(),\n        updateCallbackDone,\n        finished: updateCallbackDone,\n      };\n    } catch (error) {\n      console.error('Error in startViewTransition callback:', error);\n      return {\n        ready: Promise.reject(error),\n        updateCallbackDone: Promise.reject(error),\n        finished: Promise.reject(error),\n      };\n    }\n  };\n}\n\n// Initialize theme from localStorage\nfunction initTheme() {\n  const savedTheme = localStorage.getItem('theme');\n  if (savedTheme) {\n    document.documentElement.setAttribute('data-theme', savedTheme);\n  } else if (\n    window.matchMedia &&\n    window.matchMedia('(prefers-color-scheme: dark)').matches\n  ) {\n    // If no saved preference, use system preference\n    document.documentElement.setAttribute('data-theme', 'dark');\n    localStorage.setItem('theme', 'dark');\n  }\n}\n\n// Call theme initialization immediately (before DOM is fully loaded)\ninitTheme();\n\n// Initialize the app\nasync function initializeApp() {\n  // Show splash screen first\n  const splashScreen = showSplashScreen();\n\n  // Delay app initialization to show splash screen\n  setTimeout(async () => {\n    const appElement = document.querySelector('#app');\n    if (!appElement) {\n      console.error('App element not found');\n      hideSplashScreen(splashScreen);\n      return;\n    }\n\n    const app = new App({\n      content: appElement,\n    });\n\n    try {\n      await app.renderPage();\n      // Hide splash screen after initial render is complete\n      hideSplashScreen(splashScreen);\n\n      // Setup scroll handler for header\n      setupHeaderScrollEffect();\n\n      // Setup theme mode toggle\n      setupThemeModeToggle();\n\n      // Setup animations for elements when they enter viewport\n      setupScrollAnimations();\n    } catch (error) {\n      console.error('Error loading initial page:', error);\n      hideSplashScreen(splashScreen);\n\n      appElement.innerHTML = `\n        <section class=\"container\">\n          <h1 class=\"page-title\">Error</h1>\n          <p>Gagal memuat halaman. Silakan coba lagi.</p>\n          <a href=\"#/\" class=\"back-link\">\n            <i class=\"fas fa-home\"></i>\n            Kembali ke Beranda\n          </a>\n        </section>\n      `;\n\n      window.showToast && window.showToast('Gagal memuat halaman, silakan coba lagi', 'error');\n    }\n\n    window.addEventListener('hashchange', async () => {\n      try {\n        // Show loading spinner for page transitions\n        const loadingSpinner = document.createElement('div');\n        loadingSpinner.className = 'loading-spinner';\n        loadingSpinner.innerHTML = `\n          <div class=\"spinner-container\">\n            <div class=\"spinner-pulse\"></div>\n            <div class=\"spinner\"></div>\n          </div>\n          <div class=\"spinner-text\">Loading...</div>\n        `;\n        document.body.appendChild(loadingSpinner);\n\n        // Render the new page\n        await app.renderPage();\n\n        // Setup animations again after page change\n        setupScrollAnimations();\n\n        // Remove loading spinner\n        document.body.removeChild(loadingSpinner);\n      } catch (error) {\n        console.error('Error loading page:', error);\n        window.showToast && window.showToast('Gagal memuat halaman', 'error');\n      }\n    });\n\n    // Skip to content implementation\n    const skipLinkHandler = () => {\n      const skipLink = document.querySelector('.skip-link');\n      if (skipLink) {\n        skipLink.addEventListener('click', function (event) {\n          event.preventDefault(); // Prevent default behavior that would refresh the page\n\n          const mainContent = document.querySelector('#main-content');\n          if (mainContent) {\n            skipLink.blur(); // Remove focus from the skip link\n            mainContent.focus(); // Set focus to the main content\n            mainContent.scrollIntoView({ behavior: 'smooth' }); // Scroll to main content\n          }\n        });\n      }\n    };\n\n    // Initialize skip link handler on page load\n    skipLinkHandler();\n\n    // Re-initialize skip link handler after each page change\n    window.addEventListener('hashchange', () => {\n      // Short delay to ensure DOM is updated after route change\n      setTimeout(skipLinkHandler, 100);\n    });\n\n    // Check for PWA install prompt\n    let deferredPrompt;\n    const installContainer = document.createElement('div');\n    installContainer.id = 'install-container';\n    installContainer.classList.add('install-prompt');\n    installContainer.innerHTML = `\n      <div class=\"install-content\">\n        <img src=\"/images/logo.png\" alt=\"App icon\" width=\"48\" height=\"48\">\n        <div class=\"install-text\">\n          <h3>Install Dicoding Story</h3>\n          <p>Install aplikasi ini untuk pengalaman offline yang lebih baik!</p>\n        </div>\n        <div class=\"install-actions\">\n          <button id=\"install-button\" class=\"primary-button\">Install</button>\n          <button id=\"dismiss-button\" class=\"secondary-button\">Nanti</button>\n        </div>\n      </div>\n    `;\n    document.body.appendChild(installContainer);\n\n    window.addEventListener('beforeinstallprompt', (e) => {\n      // Prevent Chrome 76+ from automatically showing the prompt\n      e.preventDefault();\n      // Stash the event so it can be triggered later\n      deferredPrompt = e;\n      // Show the install prompt after a delay\n      setTimeout(() => {\n        installContainer.classList.add('show');\n      }, 3000);\n\n      document\n        .getElementById('install-button')\n        .addEventListener('click', () => {\n          installContainer.classList.remove('show');\n          // Show the prompt\n          deferredPrompt.prompt();\n          // Wait for the user to respond to the prompt\n          deferredPrompt.userChoice.then((choiceResult) => {\n            if (choiceResult.outcome === 'accepted') {\n              console.log('User accepted the install prompt');\n              window.showToast && window.showToast('Aplikasi sedang diinstall!', 'success');\n            } else {\n              console.log('User dismissed the install prompt');\n            }\n            // Clear the saved prompt since it can't be used again\n            deferredPrompt = null;\n          });\n        });\n\n      document\n        .getElementById('dismiss-button')\n        .addEventListener('click', () => {\n          installContainer.classList.remove('show');\n        });\n    });\n\n    // Show welcome toast\n    window.showToast &&\n      setTimeout(() => {\n        window.showToast('Selamat datang di Dicoding Story!', 'info');\n      }, 1000);\n  }, 1800); // Give more time to show the splash screen\n}\n\nfunction setupHeaderScrollEffect() {\n  const header = document.querySelector('header');\n  if (!header) return;\n\n  const scrollHandler = () => {\n    if (window.scrollY > 30) {\n      header.classList.add('scrolled');\n    } else {\n      header.classList.remove('scrolled');\n    }\n  };\n\n  // Initial check\n  scrollHandler();\n\n  // Add scroll event listener\n  window.addEventListener('scroll', scrollHandler);\n}\n\nfunction setupThemeModeToggle() {\n  // Check if we have a theme preference stored\n  const savedTheme = localStorage.getItem('theme');\n\n  // Apply saved theme if it exists\n  if (savedTheme) {\n    document.documentElement.setAttribute('data-theme', savedTheme);\n  }\n\n  // Add theme toggle button to nav if it doesn't exist yet\n  const navList = document.querySelector('.nav-list');\n  if (navList) {\n    // Check if theme toggle already exists\n    if (!document.getElementById('theme-toggle-item')) {\n      const themeToggleItem = document.createElement('li');\n      themeToggleItem.id = 'theme-toggle-item';\n\n      const currentTheme =\n        savedTheme ||\n        (window.matchMedia('(prefers-color-scheme: dark)').matches\n          ? 'dark'\n          : 'light');\n\n      themeToggleItem.innerHTML = `\n        <button id=\"theme-toggle\" aria-label=\"Toggle dark/light mode\">\n          <i class=\"fas ${currentTheme === 'dark' ? 'fa-sun' : 'fa-moon'}\" aria-hidden=\"true\"></i>\n          <span>${currentTheme === 'dark' ? 'Light Mode' : 'Dark Mode'}</span>\n        </button>\n      `;\n\n      // Add after the second item\n      const secondItem = navList.children[1];\n      if (secondItem) {\n        navList.insertBefore(themeToggleItem, secondItem.nextSibling);\n      } else {\n        navList.appendChild(themeToggleItem);\n      }\n\n      // Add event listener\n      const themeToggle = document.getElementById('theme-toggle');\n      if (themeToggle) {\n        themeToggle.addEventListener('click', toggleTheme);\n      }\n    }\n  }\n}\n\nfunction toggleTheme() {\n  const currentTheme =\n    document.documentElement.getAttribute('data-theme') ||\n    (window.matchMedia('(prefers-color-scheme: dark)').matches\n      ? 'dark'\n      : 'light');\n\n  const newTheme = currentTheme === 'dark' ? 'light' : 'dark';\n\n  // Update the document attribute\n  document.documentElement.setAttribute('data-theme', newTheme);\n\n  // Save to localStorage\n  localStorage.setItem('theme', newTheme);\n\n  // Update button icon and text\n  const themeToggle = document.getElementById('theme-toggle');\n  if (themeToggle) {\n    const icon = themeToggle.querySelector('i');\n    const text = themeToggle.querySelector('span');\n\n    if (icon) {\n      icon.className = `fas ${newTheme === 'dark' ? 'fa-sun' : 'fa-moon'}`;\n    }\n\n    if (text) {\n      text.textContent = newTheme === 'dark' ? 'Light Mode' : 'Dark Mode';\n    }\n  }\n\n  // Show toast notification\n  window.showToast &&\n    window.showToast(\n      `Switched to ${newTheme === 'dark' ? 'dark' : 'light'} mode`,\n      'info'\n    );\n}\n\nfunction setupScrollAnimations() {\n  // Set up animations for elements that enter the viewport\n  const animateOnScroll = () => {\n    const elements = document.querySelectorAll(\n      '.story-item, .page-title, .story-form, .auth-container'\n    );\n\n    elements.forEach((element) => {\n      // Check if element is in viewport\n      const rect = element.getBoundingClientRect();\n      const isInViewport =\n        rect.top <=\n          (window.innerHeight || document.documentElement.clientHeight) *\n            0.85 && rect.bottom >= 0;\n\n      if (isInViewport) {\n        element.classList.add('visible');\n\n        // Add the proper animation class based on element type\n        if (element.classList.contains('story-item')) {\n          element.classList.add('animate__animated', 'animate__fadeInUp');\n          // Stagger the animations slightly\n          const index = Array.from(element.parentNode.children).indexOf(\n            element\n          );\n          element.style.animationDelay = `${index * 0.1}s`;\n        } else if (element.classList.contains('page-title')) {\n          element.classList.add('animate__animated', 'animate__fadeInDown');\n        } else {\n          element.classList.add('animate__animated', 'animate__fadeIn');\n        }\n      }\n    });\n  };\n\n  // Run once on page load\n  setTimeout(animateOnScroll, 100);\n\n  // Add scroll event listener with debounce\n  let scrollTimeout;\n  window.addEventListener('scroll', () => {\n    clearTimeout(scrollTimeout);\n    scrollTimeout = setTimeout(animateOnScroll, 20);\n  });\n}\n\ndocument.addEventListener('DOMContentLoaded', initializeApp);\n"],"names":["message","source","lineno","colno","error","_a","type","toastContainer","toast","icon","textSpan","connectionStatus","connectionMessage","updateConnectionStatus","CONFIG","DicodingStoryApi","url","options","retryAttempt","controller","signal","mergedOptions","timeout","response","errorData","errorMessage","resolve","reject","xhr","key","event","percentComplete","name","email","password","result","token","page","size","location","id","data","onProgress","subscription","_b","endpoint","_c","AppHeader","isLoggedIn","user","userData","getInitials","drawerButton","navigationDrawer","e","isOpen","firstNavItem","userMenu","userInfo","dropdown","isExpanded","firstItem","logoutButton","notificationToggle","notificationStatus","statusIndicator","hasSubscription","originalText","permission","registration","existingSubscription","keys","part","showFormattedDate","date","locale","defaultOptions","truncateText","text","maxLength","debounce","func","wait","immediate","args","context","later","callNow","formatFileSize","bytes","sizes","i","validateEmail","isOnline","AppCard","story","formattedDate","titleId","descId","userColor","getUserColor","favoritesJson","isSaved","favorites","saveBtn","lat","lon","storyId","storyName","storyDescription","mapElement","map","customIcon","observer","entries","entry","colors","hash","acc","char","AppLoader","oldValue","newValue","messageElement","AppFooter","currentYear","yearElement","AppSidebar","toggleButton","userInitials","overlay","closeButton","link","savedLink","sidebar","route","currentRoute","instanceOfAny","object","constructors","c","idbProxyableTypes","cursorAdvanceMethods","getIdbProxyableTypes","getCursorAdvanceMethods","transactionDoneMap","transformCache","reverseTransformCache","promisifyRequest","request","promise","unlisten","success","wrap","cacheDonePromiseForTransaction","tx","done","complete","idbProxyTraps","target","prop","receiver","value","replaceTraps","callback","wrapFunction","unwrap","transformCachableValue","openDB","version","blocked","upgrade","blocking","terminated","openPromise","db","readMethods","writeMethods","cachedMethods","getMethod","targetFuncName","useIndex","isWrite","method","storeName","oldTraps","advanceMethodProps","methodMap","advanceResults","ittrProxiedCursorToOriginalProxy","cursorIteratorTraps","cachedFunc","iterate","cursor","proxiedCursor","isIteratorProp","DB_NAME","STORE_NAME","FAVORITES_STORE","getDb","saveStories","stories","getAllStories","deleteStory","addToFavorites","removeFromFavorites","getFavorites","IdbHelper","HomePresenter","view","__privateAdd","_HomePresenter_instances","_view","_page","_hasMoreData","_isLoading","_includeLocation","__privateSet","__privateGet","__privateMethod","setupEventListeners_fn","loadInitialStories_fn","loadMoreStories_fn","isChecked","cachedStories","HomePage","loadMoreButton","locationFilter","scrollY","visible","pageHeight","storiesList","index","card","validStories","hasMore","AboutPage","LoginPage","form","rememberMe","loader","emailInput","passwordInput","isEmailValid","isPasswordValid","errorElement","rememberedEmail","rememberCheckbox","RegisterPage","nameInput","isNameValid","StoryDetailPresenter","cachedStory","apiError","delay","mapContainer","baseMaps","description","popup","cacheData","updatedCache","item","limitedCache","cachedStoryJson","parsedStory","cachedStoriesJson","foundStory","isFavorite","shareData","StoryDetailPage","storyContent","storyPhoto","storyCreatedAt","storyTitleId","storyDescId","offlineNotice","match","initialState","favoriteButton","newState","shareButton","article","AddPresenter","__publicField","recentsJson","recents","draftId","draft","d","draftTimeout","descriptionInput","draftsJson","drafts","preview","newDraft","permissionStatus","cameraButton","track","stream","fallbackStream","dataUrl","filename","file","arr","mimeMatch","mime","bstr","n","u8arr","formData","progress","word","isDescriptionValid","isPhotoValid","photoInput","photoPreview","geocoder","lng","position","latitude","longitude","geocoderControl","searchButton","searchInput","query","locations","loc","opt","selectedOption","locationText","results","locationName","AddStoryPage","textarea","charCount","count","container","html","btn","openCameraButton","takePhotoButton","cameraContainer","videoElement","canvas","flash","reader","photoError","locationCheckbox","locateMeButton","searchLocationButton","latInput","lonInput","photoFile","useLocation","descriptionError","submitButton","percent","progressBar","confettiSettings","NotFoundPage","extractPathnameSegments","path","splitUrl","getActivePathname","getActiveRoute","resource","isAddPage","parseActivePathname","ACCESS_TOKEN_KEY","getAccessToken","accessToken","SavedPage","favoritesContainer","initial","storyItemElement","errorContainer","dateString","routes","SavedStoriesPage","App","content","_App_instances","_content","_activePresenter","_previousRoute","cleanupPreviousPage_fn","renderWithTransition_fn","updateSidebar_fn","PageClass","renderFn","direction","showLoading_fn","mainContent","showErrorPage_fn","hideLoading_fn","setDocumentTitle_fn","titles","defaultUserData","urlBase64ToUint8Array","base64String","padding","base64","rawData","subscribeUserToPush","applicationServerKey","cleanSubscription","showSplashScreen","splashScreen","logo","title","dotsContainer","dot","hideSplashScreen","deferredPrompt","installBtn","outcome","err","supportsViewTransitions","updateCallbackDone","initTheme","savedTheme","initializeApp","appElement","app","setupHeaderScrollEffect","setupThemeModeToggle","setupScrollAnimations","loadingSpinner","skipLinkHandler","skipLink","installContainer","choiceResult","header","scrollHandler","navList","themeToggleItem","currentTheme","secondItem","themeToggle","toggleTheme","newTheme","animateOnScroll","element","rect","scrollTimeout"],"mappings":"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","x_google_ignoreList":[10]}